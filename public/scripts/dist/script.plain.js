/******/ (() => { // webpackBootstrap
/******/ 	var __webpack_modules__ = ({

/***/ 6809:
/***/ (() => {

window.changelog = [
    {
        version: '1.1.13',
        date_time: '2022-05-09 09AM',
        changes: 'galaxy button fix, phalanx info in galaxy view'
    },
    {
        version: '1.1.12',
        date_time: '2022-05-08 11PM',
        changes: 'improved galaxy view (less buttons)'
    },
    {
        version: '1.1.11',
        date_time: '2022-05-08 01AM',
        changes: 'bugfixes'
    },
    {
        version: '1.1.10',
        date_time: '2022-05-07 08PM',
        changes: 'temp fix for IP'
    },
    {
        version: '1.1.9',
        date_time: '2022-05-06 09PM',
        changes: 'adjustments for new ruleset'
    },
    {
        version: '1.1.8',
        date_time: '2022-05-01 06PM',
        changes: 'fixed moon/planet differentiation'
    },
    {
        version: '1.1.7',
        date_time: '2022-05-01 05PM',
        changes: 'added different expo presets'
    },
    {
        version: '1.1.6',
        date_time: '2022-05-01 05PM',
        changes: 'automatically delete non-existent planets'
    },
    {
        version: '1.1.5',
        date_time: '2022-05-01 04PM',
        changes: 'fixed spy report times'
    },
    {
        version: '1.1.4',
        date_time: '2022-05-01 04PM',
        changes: 'show own ships in extra column (battle sim)'
    },
    {
        version: '1.1.3',
        date_time: '2022-05-01 04PM',
        changes: 'added link to combat simulator'
    },
    {
        version: '1.1.2',
        date_time: '2022-05-01 04PM',
        changes: 'added arrival time for phalanx'
    },
    {
        version: '1.1.1',
        date_time: '2022-03-31 07AM',
        changes: 'added live score'
    },
    {
        version: '1.1.0',
        date_time: '2022-03-23 11AM',
        changes: 'added presets for fleet'
    },
    {
        version: '1.0.53',
        date_time: '2022-03-15 11PM',
        changes: 'enable hub functions for wing members'
    },
    {
        version: '1.0.52',
        date_time: '2022-03-15 11PM',
        changes: 'bugfix for transports (calculated twice) in resource overview'
    },
    {
        version: '1.0.51',
        date_time: '2022-03-12 06AM',
        changes: 'changed hub planet overview to show local building score &amp; made all columns sortable'
    },
    {
        version: '1.0.50',
        date_time: '2022-03-08 12AM',
        changes: 'added function to anonymize battle reports'
    },
    {
        version: '1.0.49',
        date_time: '2022-02-28 01AM',
        changes: 'bugfix for resource overview'
    },
    {
        version: '1.0.48',
        date_time: '2022-02-26 01AM',
        changes: 'performance'
    },
    {
        version: '1.0.47',
        date_time: '2022-02-25 02PM',
        changes: 'debugging output'
    },
    {
        version: '1.0.46',
        date_time: '2022-02-25 01PM',
        changes: 'added resources in flights to overview'
    },
    {
        version: '1.0.45',
        date_time: '2022-02-23 01PM',
        changes: 'added pagination for hostile spy reports'
    },
    {
        version: '1.0.44',
        date_time: '2022-02-20 06PM',
        changes: 'added production sum in tooltip'
    },
    {
        version: '1.0.43',
        date_time: '2022-02-20 03PM',
        changes: 'added an option to limit spy report history'
    },
    {
        version: '1.0.42',
        date_time: '2022-02-20 02PM',
        changes: 'added reporter to spy reports'
    },
    {
        version: '1.0.41',
        date_time: '2022-02-20 08AM',
        changes: 'added settings for individual friend- and enemy highlighting'
    },
    {
        version: '1.0.40',
        date_time: '2022-02-20 08AM',
        changes: 'split settings into tabs'
    },
    {
        version: '1.0.39',
        date_time: '2022-02-20 06AM',
        changes: 'added spy history headline with linked coordinates'
    },
    {
        version: '1.0.38',
        date_time: '2022-02-20 06AM',
        changes: 'link coords in player card to galaxy view'
    },
    {
        version: '1.0.37',
        date_time: '2022-02-16 01AM',
        changes: 'added expo buttons for KT'
    },
    {
        version: '1.0.36',
        date_time: '2022-02-16 01AM',
        changes: 'bugfix for own planets not shown in overview'
    },
    {
        version: '1.0.35',
        date_time: '2022-02-15 11PM',
        changes: 'added relative / absolute score development chart'
    },
    {
        version: '1.0.34',
        date_time: '2022-02-15 01PM',
        changes: 'added relative score growth chart'
    },
    {
        version: '1.0.33',
        date_time: '2022-02-14 06PM',
        changes: 'bugfixes for fleets'
    },
    {
        version: '1.0.32',
        date_time: '2022-02-14 08AM',
        changes: 'refactored planet overview'
    },
    {
        version: '1.0.31',
        date_time: '2022-02-13 09AM',
        changes: 'added mouseover for notifications/timers'
    },
    {
        version: '1.0.30',
        date_time: '2022-02-13 01AM',
        changes: 'added expo fleet calculator (thanks to Hyman!)'
    },
    {
        version: '1.0.29',
        date_time: '2022-02-12 10PM',
        changes: 'useless firework feature for Wile E. Coyote'
    },
    {
        version: '1.0.28',
        date_time: '2022-02-11 10AM',
        changes: 'added transfer matrix to hub'
    },
    {
        version: '1.0.27',
        date_time: '2022-02-10 2PM',
        changes: 'formatting/styling for AKS'
    },
    {
        version: '1.0.26',
        date_time: '2022-02-07 03AM',
        changes: 'added hostile spying overview'
    },
    {
        version: '1.0.25',
        date_time: '2022-02-07 12PM',
        changes: 'toggle overview column sorting (ASC/DESC); optimized fleet overview; bugfix for used slot count'
    },
    {
        version: '1.0.24',
        date_time: '2022-02-07 11PM',
        changes: 'added spy report overview for galaxy view'
    },
    {
        version: '1.0.23',
        date_time: '2022-02-07 11PM',
        changes: 'added loading indicator for hub pages'
    },
    {
        version: '1.0.22',
        date_time: '2022-02-07 11PM',
        changes: 'added second sort item above coordinates in overview (sort by system)'
    },
    {
        version: '1.0.21',
        date_time: '2022-02-07 03PM',
        changes: 'changed defense score to planet\'s defense score (player\'s defense score in mouseover)'
    },
    {
        version: '1.0.20',
        date_time: '2022-02-07 06AM',
        changes: 'added alliance filter for hub\'s research page'
    },
    {
        version: '1.0.19',
        date_time: '2022-02-06 05PM',
        changes: 'added galaxy update check page'
    },
    {
        version: '1.0.18',
        date_time: '2022-02-06 03PM',
        changes: 'added link to rename/delete planet (overview)'
    },
    {
        version: '1.0.17',
        date_time: '2022-02-05 08AM',
        changes: 'added hub page for raids & expos'
    },
    {
        version: '1.0.16',
        date_time: '2022-02-04 08PM',
        changes: 'show fleet slot usage & expedition stats'
    },
    {
        version: '1.0.15',
        date_time: '2022-02-04 01PM',
        changes: 'show score differenz and details at flight overview'
    },
    {
        version: '1.0.14',
        date_time: '2022-02-04 09AM',
        changes: 'added fleet tracking and overview enhancement (show ship/res diffs)'
    },
    {
        version: '1.0.13',
        date_time: '2022-02-02 10PM',
        changes: 'added the black hole event for expeditions (for Sky/Mama) <3'
    },
    {
        version: '1.0.12',
        date_time: '2022-02-01 11PM',
        changes: 'made coordinates/player name/score in hub -> planets sortable'
    },
    {
        version: '1.0.11',
        date_time: '2022-02-01 11PM',
        changes: 'mark planet\'s production red, when storage limits are exceeded'
    },
    {
        version: '1.0.10',
        date_time: '2022-02-01 11PM',
        changes: 'added "observe" function for research (visible at overview)'
    },
    {
        version: '1.0.9',
        date_time: '2022-02-01 11PM',
        changes: 'added "observe" function for buildings (visible at overview)'
    },
    {
        version: '1.0.8',
        date_time: '2022-02-01 11AM',
        changes: 'added last attack/spy to galaxy view'
    },
    {
        version: '1.0.7',
        date_time: '2022-02-01 04AM',
        changes: 'added chart for alliance page (score development per member)'
    },
    {
        version: '1.0.6',
        date_time: '2022-02-01 03AM',
        changes: 'added own score as a reference to player score charts'
    },
    {
        version: '1.0.5',
        date_time: '2022-02-01 03AM',
        changes: 'changed button styles at buildings/research page when not affordable'
    },
    {
        version: '1.0.4',
        date_time: '2022-02-01 2AM',
        changes: 'added changelog page'
    },
    {
        version: '1.0.3',
        date_time: '2022-02-01 01AM',
        changes: 'added resources to overview (visit resource page at planets to update)'
    },
    {
        version: '1.0.2',
        date_time: '2022-02-01 01AM',
        changes: 'added "show_galaxy" setting'
    },
    {
        version: '1.0.1',
        date_time: '2022-01-31 06PM',
        changes: 'security bypasses / bugfix'
    },
    {
        version: '1.0.0',
        date_time: '2022-01-31 05PM',
        changes: 'stable release with auto updater'
    },
];


/***/ }),

/***/ 7328:
/***/ (() => {

window.Menu = function() {
    this.init = function() {
        let html = '';
        html += '<li><a style="color: #ee4d2e !important; font-size: 11px">pr0game Hub v' + version + '</a></li>';
        html += '<li><a href="#hub.planets"><i class="fa fa-globe-asia"></i> Planeten</a></li>';
        html += '<li><a href="#hub.research"><i class="fa fa-flask"></i> Forschung</a></li>';
        html += '<li><a href="#hub.fleet"><i class="fa fa-fighter-jet"></i> Flotte</a></li>';
        html += '<li><a href="#hub.score"><i class="fa fa-trophy"></i> Punkte</a></li>';
        html += '<li><a href="#hub.expos"><i class="fa fa-skull-crossbones"></i> Raids &amp; Expo</a></li>';
        html += '<li><a href="#hub.galaxy"><i class="fa fa-sync"></i> Gala-Aktualität</a></li>';
        html += '<li><a href="#hub.hostile-spying"><i class="fa fa-eye"></i> Fremdspionage</a></li>';
        html += '<li><a href="#hub.changelog"><i class="fa fa-history"></i> Changelog</a></li>';

        $('ul#menu').prepend(html);

        let content;
        $('.res_max').each(function(key, obj) {
            content = $(obj).html();
            $(obj).html(content.replace('.000', 'K'));
        });
    };
};


/***/ }),

/***/ 3989:
/***/ (() => {

top.Colors = function () {
    this.list = {
        black: [22, 22, 24],
        white: [242, 245, 244],
        red: [238, 77, 46],
        gray: [136, 136, 136],
        pink: [255, 0, 130],
        green: [92, 184, 92],
        blue: [0, 143, 255],
        yellow: [247, 197, 22],
        cyan: [0, 255, 255]
    };

    this.getRgb = function (color) {
        return 'rgb(' + color[0] + ', ' + color[1] + ', ' + color[2] + ')';
    }

    this.black = function () {
        return this.getRgb(this.list.black);
    }

    this.white = function () {
        return this.getRgb(this.list.white);
    }

    this.red = function () {
        return this.getRgb(this.list.red);
    }

    this.gray = function () {
        return this.getRgb(this.list.gray);
    }

    this.pink = function () {
        return this.getRgb(this.list.pink);
    }

    this.green = function () {
        return this.getRgb(this.list.green);
    }

    this.blue = function () {
        return this.getRgb(this.list.blue);
    }

    this.yellow = function () {
        return this.getRgb(this.list.yellow);
    }

    this.cyan = function () {
        return this.getRgb(this.list.cyan);
    }
};


/***/ }),

/***/ 6170:
/***/ (() => {

window.parsePageAlliance = function () {
    var allianceId = window.location.href.match(/[\?\&]id=([(0-9]+)/i)[1] || 0;
    var tbl = $($('content table')[0]);
    tbl.append('<tr><th colspan="2">Planeten</th></tr>');
    getJSON('alliances/' + allianceId + '/planets', function (response) {
        if (response.status === 200) {
            $.each(JSON.parse(response.responseText), function (key, obj) {
                tbl.append('<tr><td style="text-align: left">' + obj.coordinates + '</td><td style="text-align: left">' + obj.name + '</td></tr>');
            });
        }
    });

    displayAllianceChart(allianceId);
}


/***/ }),

/***/ 5550:
/***/ (() => {

window.PageBuildings = function () {
    const $this = this;
    this.data = [];

    this.convertHtml = function () {
        $('content').addClass('buildings');

        $('.infos, .infoso').each(function (key, obj) {
            $(obj).addClass('building');
            $($(obj).find('div:nth-child(2)')).addClass('building-left');
            $($(obj).find('div:nth-child(3)')).addClass('building-right');

            $this.disableButtons($($(obj).find('div:nth-child(3)')));
            $this.changeBuildTimeStyle($($(obj).find('div:nth-child(3)')));
        });

        $('content').html($('content').html().replace(/\(Stufe ([0-9]+)\)/g, '<br><span class="highlight">Stufe $1</span><br>'));
    };

    this.init = function () {
        const buildings = [];
        let info;
        let level;

        this.convertHtml();

        $('.buildn').each(function (key, obj) {
            info = $(obj).html().match(/\.info\(([0-9]+)\)\"\>([^<]+)\<\/a\>/);
            level = $(obj).html().match(/Stufe ([0-9]+)/);

            buildings.push({
                building_id: getInt(info[1]),
                level: level ? getInt(level[1]) : 0
            });
        });

        postJSON('planets/buildings', {
            coordinates: ownId,
            buildings
        }, function (response) {
            $this.data = JSON.parse(response.responseText);

            $('.buildn').each(function (key, obj) {
                info = $(obj).html().match(/\.info\(([0-9]+)\)\"\>([^<]+)\<\/a\>/);
                $(obj).append('Max Stufe: ' + $this.data[info[1]].max_level);

                if ($this.data[info[1]].max_level > 0) {
                    $(obj).append('<div class="player_names">' + $this.data[info[1]].player_names.replace(/,/g, ', ') + '</div>');
                }
            });
        });
    };

    this.disableButtons = function (cell) {
        if ($(cell).find('.text-red').length > 0) {
            $($(cell).find('.build_submit')).addClass('text-gray');
            $(cell).parent().addClass('fade-' + ($(cell).find('.build_submit').length === 0 ? '25' : '75'));

            let buildingRight = $($(cell).parent().find('.building-right'));
            let ressList = $(buildingRight.find('> span:first-child')).html();
            let coords = ownId;
            let resourceId = $($(cell).parent().find('.buildn > a')).attr('onclick').match(/\(([0-9]+)\)/)[1];

            let metal = $this.getCost('Metall', ressList);
            let crystal = $this.getCost('Kristall', ressList);
            let deuterium = $this.getCost('Deuterium', ressList);
            let level = $this.getCost('Stufe', $(cell).html());

            // show notification button
            if (new PlanetResourceNotification().hasNotification(coords, resourceId)) {
                const timestamp = new PlanetResourceNotification().getFinishTime(coords);
                buildingRight.append('<br><button onclick="(new PlanetResourceNotification().removeNotification(\'' + coords + '\'))" style="color: ' + getRgb(cRed) + '"><i class="fa fa-bell-slash"></i> baubar in <span class="notification-timer" data-timestamp="' + timestamp + '">' + formatTimeDiff(timestamp) + '</span></button>');
            } else {
                buildingRight.append('<br><button onclick="(new PlanetResourceNotification().addNotification(\'' + coords + '\', \'' + resourceId + '\',' + metal + ',' + crystal + ',' + deuterium + ',' + level + '))" style="color: ' + getRgb(cGreen) + '"><i class="fa fa-bell"></i> benachrichtigen, wenn baubar</button>');
            }
        }

        window.setInterval(function () {
            $('.notification-timer').each(function () {
                $(this).text(formatTimeDiff($(this).attr('data-timestamp')));
            });
        }, 1000);
    }

    this.changeBuildTimeStyle = function (cell) {
        $(cell).html($(cell).html().replace(/(.*)Bauzeit\:(.*)/, '$1<span class="text-gray">Bauzeit: $2</span>'));
    }

    this.getCost = function (label, html) {
        let tmp;

        switch (label) {
            case 'Metall':
                tmp = html.match(/\<a (.*)\>(Metall)\<\/a\>(.*)\<b(.*)\<span(.*)\>([.0-9]+)\<\//);
                break;

            case 'Kristall':
                tmp = html.match(/\<a (.*)\>(Kristall)\<\/a\>(.*)\<b(.*)\<span(.*)\>([.0-9]+)\<\//);
                break;

            case 'Deuterium':
                tmp = html.match(/\<a (.*)\>(Deuterium)\<\/a\>(.*)\<b(.*)\<span(.*)\>([.0-9]+)\<\//);
                break;

            case 'Stufe':
                if(!html) {
                    return 1;
                }

                tmp = html.match(/(Stufe) ([.0-9]+)/);
                return tmp ? getInt(tmp[2]) : 0;
        }

        return tmp ? getInt(tmp[6]) : 0;
    }
};


/***/ }),

/***/ 1914:
/***/ (() => {

window.PageDefense = function () {
    const $this = this;
    this.data = [];

    this.init = function () {
        const buildings = [];
        let info;
        let level;

        $('.buildn').each(function (key, obj) {
            info = $(obj).html().match(/\.info\(([0-9]+)\)\"\>([^<]+)\<\/a\>/);
            level = $('#val_' + info[1]).html().match(/([.0-9]+)/);

            buildings.push({
                building_id: getInt(info[1]),
                level: level ? getInt(level[1]) : 0
            });
        });

        postJSON('planets/buildings', {
            coordinates: ownId,
            buildings
        }, function (response) {
            $this.data = JSON.parse(response.responseText);
        });
    };
};


/***/ }),

/***/ 3551:
/***/ (() => {

window.PageFleet = function () {
    var $this = this;
    this.data = [];
    this.maxPoints = 6000;
    this.maxRessPoints = 6000;
    this.maxFleetPoints = 3000;
    this.fleet = [];
    this.cargoOptions = [];

    this.init = function () {
        this.parseShips();
        this.showExpoButton();
        this.bindEnterKey();
        this.showCargoOptions();
    };

    this.parseShips = function () {
        const $this = this;
        let info;
        let globalFleet = [];

        $('.table519 tr').each(function (key, obj) {
            info = $(obj).html().replace(/\n/, '').match(/id\=\"ship([0-9]+)\_value\"\>([\.0-9]+)\</);

            if (info) {
                $this.fleet.push({
                    ship_id: getInt(info[1]),
                    amount: getInt(info[2])
                });

                globalFleet.push({
                    ship_id: getInt(info[1]),
                    amount: getInt(info[2])
                });
            }
        });

        let fleetInfo;
        let startPlanet;
        let ships;
        $('content > table:first-child > tbody > tr').each(function (key, obj) {
            if ($(obj).find('td').length > 1) {
                fleetInfo = $(obj).find('td:nth-child(3)').html();
                startPlanet = $(obj).find('td:nth-child(4)').html().match(/\[([0-9]+)\:([0-9]+)\:([0-9]+)\]/);

                ships = fleetInfo.match(/\'\>([^<]+)\:\<\/td\>\<td class\=\'transparent\'\>([\.0-9]+)\</g);

                if (ships && startPlanet[1] == ownGalaxy && startPlanet[2] == ownSystem && startPlanet[3] == ownPlanet) {
                    $.each(ships, function (sKey, sObj) {
                        info = sObj.match(/\'\>([^<]+)\:\<\/td\>\<td class\=\'transparent\'\>([\.0-9]+)\</);

                        if (info) {
                            globalFleet.push({
                                ship_id: info[1],
                                amount: getInt(info[2])
                            });
                        }
                    });
                }
            }
        });

        postJSON('planets/fleet', {
            coordinates: ownId,
            fleet: globalFleet
        }, function (response) {
            $this.data = JSON.parse(response.responseText);

            let html = '<br><table class="table 519" style="max-width: 519px !important"><tr><th style="text-align: left">Schiffstyp</th><th style="text-align: right">Anzahl (planetübergreifend)</th><th style="text-align: right">Punkte</th><th style="text-align: right">Ben. Recs</th></tr>';
            $.each($this.data, function (key, obj) {
                html += '<tr>';
                html += '<td style="text-align: left">' + obj.name + '</td>';
                html += '<td style="text-align: right">' + numberFormat(obj.sum) + '</td>';
                html += '<td style="text-align: right">' + numberFormat(obj.score) + '</td>';
                html += '<td style="text-align: right">' + numberFormat(obj.recs) + '</td>';
                html += '</tr>';
            });

            $('content').append(html + '</table><p style="max-width: 519px !important; margin: 10px auto"><i>Diese Anzahl der stationierten und in der Luft befindlichen Schiffe (Aktiver Planet = Startplanet) wird aktualisiert, sobald die entsprechende Flottenseite des Planeten geöffnet wird.<br><br>Nach Kampf mit Verlust, werden die verlorenen Schiffe also erst nach Aufruf der Flottenansicht am Startplaneten aktualisiert. Nach Schiffsbau v.v.<br><br>Nach erfolgreicher Stationierung müssen somit die Flottenseiten von Start- und Zielplanet zur Aktualisierung geöffnet werden.</i></p>');
        });
    };

    this.showExpoButton = function () {
        $('.table519').each(function (key, obj) {
            if ($(obj).html().search(/Neuer Auftrag:/) !== -1) {
                $(obj).find('tr th').append('<span style="margin-left: 20px">Expo:</span> <a class="text-red" href="javascript:void(0)" onclick="pageFleet.setExpoFleet()">Ress</a> ');
                $(obj).find('tr th').append('<a class="text-red" href="javascript:void(0)" onclick="pageFleet.setExpoFleet(true)">Schiffe</a> // ');
                $(obj).find('tr th').append('<a class="text-red" href="javascript:void(0)" onclick="pageFleet.setExpoFleet(false, true, 206)">Xer</a> ');
                $(obj).find('tr th').append('<a class="text-red" href="javascript:void(0)" onclick="pageFleet.setExpoFleet(false, true, 215)">SX</a> ');
                $(obj).find('tr th').append('<a class="text-red" href="javascript:void(0)" onclick="pageFleet.setExpoFleet(false, true, 213)">Zer</a> ');
                $(obj).find('tr th').append('<a class="text-red" href="javascript:void(0)" onclick="pageFleet.setExpoFleet(false, true, 211)">Bomber</a> ');
            }
        });
    }

    this.setExpoFleet = function (forFleetOnly = false, largeTransporters = true, battleShipId = 207) {
        const notices = [];
        this.maxPoints = forFleetOnly ? this.maxFleetPoints : this.maxRessPoints;
        let pointsLeft = $this.maxPoints;
        let ship;
        const localFleet = JSON.parse(JSON.stringify(this.fleet));

        // set 1 spy drone
        ship = this.getShip(210);
        if (!ship || ship.amount === 0) {
            notices.push('Es ist keine Spionagesonde vorhanden!');
        } else {
            localFleet[ship.offset].used = (localFleet[ship.offset].used || 0) + 1;
            localFleet[ship.offset].amount--;
            pointsLeft = $this.subExpoPoints(pointsLeft, 210, 1);
        }

        // set 1 of the best ship
        const possibleBattleShipIds = [battleShipId, 206, 215, 211, 205, 204];

        let foundBestShip = false;
        $.each(possibleBattleShipIds, function (key, possibleShipId) {
            if (!foundBestShip) {
                ship = $this.getShip(possibleShipId);

                if (ship) {
                    pointsLeft = $this.subExpoPoints(pointsLeft, ship.ship_id, 1);
                    foundBestShip = true;

                    localFleet[ship.offset].used = (localFleet[ship.offset].used || 0) + 1;
                    localFleet[ship.offset].amount--;
                }
            }
        });

        // fill with transports and trash ships
        const fillers = largeTransporters ? [203, 202, 204, 205, 206, 207, 215, 211] : [202, 203, 204, 205, 206, 207, 215, 211];
        let pointsPerShip;
        let amount;
        $.each(fillers, function (key, possibleShipId) {
            ship = $this.getShip(possibleShipId);

            if (ship) {
                pointsPerShip = $this.getPointsPerShip(ship.ship_id);
                amount = Math.floor(pointsLeft / pointsPerShip);

                if (amount > localFleet[ship.offset].amount) {
                    amount = localFleet[ship.offset].amount;
                }

                pointsLeft = $this.subExpoPoints(pointsLeft, ship.ship_id, amount);

                localFleet[ship.offset].used = (localFleet[ship.offset].used || 0) + amount;
                localFleet[ship.offset].amount -= amount;
            }
        });

        // fill remaining points with spy drones
        ship = this.getShip(210);
        if (ship) {
            pointsPerShip = $this.getPointsPerShip(ship.ship_id);
            amount = Math.floor(pointsLeft / pointsPerShip);

            if (amount > localFleet[ship.offset].amount) {
                amount = localFleet[ship.offset].amount;
            }

            pointsLeft = $this.subExpoPoints(pointsLeft, ship.ship_id, amount);

            localFleet[ship.offset].used = (localFleet[ship.offset].used || 0) + amount;
            localFleet[ship.offset].amount -= amount;
        }

        // set input values
        let input;
        $.each(localFleet, function (key, obj) {
            input = $('#ship' + obj.ship_id + '_input');
            input.val(obj.used || 0);
            input.parent().css('text-align', 'left');
        });

        this.updatePoints();
    };

    this.updatePoints = function () {
        let points = 0;
        let shipPoints;
        let shipId;
        let textStyle;

        $('.table519').each(function (key, obj) {
            if ($(obj).html().search(/Neuer Auftrag:/) !== -1) {
                $($(obj).find('input')).each(function (key, field) {
                    if (field.outerHTML.search(/name\=/) !== -1) {
                        shipId = $(field).attr('name').replace(/ship/, '');
                        shipPoints = $this.getPointsPerShip(shipId) * getInt($(field).val());
                        points += shipPoints;

                        $(field).change(function () {
                            pageFleet.updatePoints();
                        });

                        $($(field).parent().parent().find('.helper')).remove();
                        $(field).parent().parent().append('<td class="helper text-right" style="margin-left: 10px; width: 200px">' + numberFormat(shipPoints) + ' Expo-Punkte</td>');
                    }
                });

                textStyle = $this.maxPoints !== points ? 'text-blue' : 'text-green';
                textStyle = $this.maxPoints > points ? 'text-red' : textStyle;
                $('.helper-headline').remove();
                $('.table519 tr:nth-child(2)').append('<td class="helper-headline text-right"><span class="' + textStyle + '">' + numberFormat(points) + '</span> / ' + numberFormat($this.maxPoints) + ' Expo-Punkte</td>');
            }
        });
    };

    this.getShip = function (offset) {
        for (i = 0; i < this.fleet.length; i++) {
            if (offset === this.fleet[i].ship_id) {
                this.fleet[i].offset = i;
                return this.fleet[i];
            }
        }

        return null;
    }

    this.getPointsPerShip = function (shipId) {
        const pointsMatrix = {
            202: 4,
            203: 12,
            204: 4,
            205: 10,
            206: 27,
            207: 60,
            208: 30,
            209: 16,
            210: 1,
            211: 75,
            213: 110,
            214: 9000,
            215: 70
        };

        return pointsMatrix[shipId] * 5;
    };

    this.subExpoPoints = function (pointsLeft, shipId, amount) {
        return pointsLeft - (this.getPointsPerShip(shipId) || 0) * (amount || 0);
    };

    this.bindEnterKey = function () {
        $(window).keyup(function (e) {
            if ($('content form').length === 1 && $('*:focus').length === 0) {
                if (e.key === 'Enter') {
                    $('content .table519 form').submit();
                }
            }
        });
    }

    this.showCargoOptions = function () {
        let html = '';
        const planetResourceNotification = new PlanetResourceNotification();
        const metal = getInt(getValue(ownCoords[0] + '_metal'));
        const crystal = getInt(getValue(ownCoords[0] + '_crystal'));
        const deuterium = getInt(getValue(ownCoords[0] + '_deuterium'));
        const ktAvailable = getInt($('#ship202_value').html());
        const gtAvailable = getInt($('#ship203_value').html());

        this.cargoOptions = []
        this.cargoOptions.push({
            title: 'Ressourcen auf dem Planeten',
            metal,
            crystal,
            deuterium,
            setMetal: metal,
            setCrystal: crystal,
            setDeuterium: deuterium,
            coords: null
        });

        $.each(planetResourceNotification.getNotifications(), function (key, obj) {
            $this.cargoOptions.push({
                title: obj.coords + ' (' + obj.resource + ' Stufe ' + obj.level + ')',
                metal: getInt(obj.metal),
                crystal: getInt(obj.crystal),
                deuterium: getInt(obj.deuterium),
                setMetal: getInt(getInt(obj.metal) <= getInt(metal) ? obj.metal : metal),
                setCrystal: getInt(getInt(obj.crystal) <= getInt(crystal) ? obj.crystal : crystal),
                setDeuterium: getInt(getInt(obj.deuterium) <= getInt(deuterium) ? obj.deuterium : deuterium),
                coords: obj.coords
            });
        });

        html += '<br>';
        html += '<div id="customContentContainer">';
        html += '<table width="100%">'
        html += '<thead>';
        html += '<tr><th colspan="5">Cargo Options</th></tr>';
        html += '<tr>';
        html += '<th class="text-left">Preset</th>';
        html += '<th class="text-right">Metall</th>';
        html += '<th class="text-right">Kristall</th>';
        html += '<th class="text-right">Deuterium</th>';
        html += '<th class="text-right">ben. KT/GT</th>';
        html += '<th class="text-left">Optionen</th>';
        html += '</tr>';
        html += '</thead>';
        html += '<tbody>';

        $.each(this.cargoOptions, function (key, obj) {
            obj.sum = getInt(obj.setMetal) + getInt(obj.setCrystal) + getInt(obj.setDeuterium);
            obj.ktNeeded = Math.ceil((obj.sum + 1000) / 5000);
            obj.gtNeeded = Math.ceil((obj.sum + 1000) / 25000);

            html += '<tr>';
            html += '<td class="text-left">' + obj.title + '</td>'
            html += '<td class="text-right" style="color: ' + getRgb(obj.metal <= metal ? cGreen : cRed) + '">' + numberFormat(obj.metal) + '</td>'
            html += '<td class="text-right" style="color: ' + getRgb(obj.crystal <= crystal ? cGreen : cRed) + '">' + numberFormat(obj.crystal) + '</td>'
            html += '<td class="text-right" style="color: ' + getRgb(obj.deuterium <= deuterium ? cGreen : cRed) + '">' + numberFormat(obj.deuterium) + '</td>'
            html += '<td class="text-right"><span style="color: ' + getRgb(ktAvailable >= obj.ktNeeded ? cGreen : cRed) + '">' + numberFormat(obj.ktNeeded) + '</span> / <span style="color: ' + getRgb(gtAvailable >= obj.gtNeeded ? cGreen : cRed) + '">' + numberFormat(obj.gtNeeded) + '</span></td>'
            html += '<td class="text-left">';
            html += '<a href="javascript:void(0)" onclick="pageFleet.setCargoFleet(' + obj.setMetal + ', ' + obj.setCrystal + ', ' + obj.setDeuterium + ', 202, \'' + ownCoords[0] + '\', \'' + obj.coords + '\')" class="tooltip" style="font-weight: bold; color: ' + getRgb(ktAvailable === 0 ? cRed : (ktAvailable >= obj.ktNeeded ? cGreen : cYellow)) + '" data-tooltip-content="<b style=\'color:' + getRgb(cRed) + '\'>KT</b>s priorisieren: Erst die benötigten KT auswählen;<br>Falls nicht ausreichend vorhanden mit GTs auffüllen.<br>(+1.000 Ress für Treibstoff einkalkuliert).<br><span style=\'color: ' + getRgb(cGreen) + '\';>Genug KT vorhanden</span> / <span style=\'color: ' + getRgb(cYellow) + '\';>Mit GT-Auffüllung möglich</span> / <span style=\'color: ' + getRgb(cRed) + '\';>Keine KT vorhanden</span>"><i class="fa fa-truck-pickup"></i></a> / ';
            html += '<a href="javascript:void(0)" onclick="pageFleet.setCargoFleet(' + obj.setMetal + ', ' + obj.setCrystal + ', ' + obj.setDeuterium + ', 203, \'' + ownCoords[0] + '\', \'' + obj.coords + '\')" class="tooltip" style="font-weight: bold; color: ' + getRgb(gtAvailable === 0 ? cRed : (gtAvailable >= obj.gtNeeded ? cGreen : cYellow)) + '" data-tooltip-content="<b style=\'color:' + getRgb(cRed) + '\'>GT</b>s priorisieren: Erst die benötigten GT auswählen;<br>Falls nicht ausreichend vorhanden mit KTs auffüllen.<br>(+1.000 Ress für Treibstoff einkalkuliert).<br><span style=\'color: ' + getRgb(cGreen) + '\';>Genug GT vorhanden</span> / <span style=\'color: ' + getRgb(cYellow) + '\';>Mit KT-Auffüllung möglich</span> / <span style=\'color: ' + getRgb(cRed) + '\';>Keine GT vorhanden</span>"><i class="fa fa-truck"></i></a>';
            html += '</td>'
            html += '</tr>';
        });

        html += '</tbody>';
        html += '</table>';
        html += '</div><br>';

        $('content > br').replaceWith(html);
    };

    this.setCargoFleet = function (metal, crystal, deuterium, preset, departure, destination) {
        const ktAvailable = getInt($('#ship202_value').html());
        const gtAvailable = getInt($('#ship203_value').html());
        let sum = metal + crystal + deuterium + 1000;
        let sumKt = 0;
        let sumGt = 0;
        let asd;

        switch (preset) {
            case 202:
                asd = Math.ceil(sum / 5000);
                sumKt = asd > ktAvailable ? ktAvailable : asd;
                sum -= sumKt * 5000;

                if (sum > 0) {
                    asd = Math.ceil(sum / 25000);
                    sumGt = asd > gtAvailable ? gtAvailable : asd;
                }
                break;

            case 203:
                asd = Math.ceil(sum / 25000);
                sumGt = asd > gtAvailable ? gtAvailable : asd;
                sum -= sumGt * 25000;

                if (sum > 0) {
                    asd = Math.ceil(sum / 5000);
                    sumKt = asd > ktAvailable ? ktAvailable : asd;
                }
                break;
        }

        setValue(departure + '_fleet_metal', metal);
        setValue(departure + '_fleet_crystal', crystal);
        setValue(departure + '_fleet_deuterium', deuterium);
        setValue(departure + '_fleet_destination', destination);

        $('#ship202_input').val(sumKt);
        $('#ship203_input').val(sumGt);
    }
};


/***/ }),

/***/ 8164:
/***/ (() => {

window.PageGalaxy = function () {
    const $this = this;

    this.init = function () {
        this.enhanceList();
    }

    this.enhanceList = function () {
        const systemCoords = $('content > table tr:first-child th').html()?.match(/System ([0-9]+)\:([0-9]+)/);
        const headerRow = $($('content > table tr')[1]);
        headerRow.append('<th class="text-right"><i class="fa fa-crosshairs"></i></th>');
        headerRow.append('<th class="text-right"><i class="fa fa-user-secret"></i></th>');
        headerRow.append('<th class="text-right">MET</th>');
        headerRow.append('<th class="text-right">CRY</th>');
        headerRow.append('<th class="text-right">DEU</th>');

        getJSON('galaxy/' + systemCoords[1] + '/' + systemCoords[2], function (response) {
            if (response.status === 200) {
                const json = JSON.parse(response.responseText);
                const payload = [];
                let firstCell, planet, updateRequired = false;
                let tooltipCell, tooltipSrc, playerId, coords, planetId, moonId, parent, parentParent;

                if (json.phalanx.length > 0) {
                    $('form').append('<div id="phalanxInfo" style="background: ' + getRgb(cBlack) + '; color: white; padding: 15px"><b>In Mondreichweite von:</b></div>')

                    $.each(json.phalanx, function (key, obj) {
                        $('#phalanxInfo').append('<div style="color: ' + getRgb(obj.isFriendly ? cGreen : cRed) + '">' + obj.name + ' (' + obj.alliance + ') ' + obj.range + ' (' + obj.coordinates + ')</div>');
                    });
                }

                // loop planets rows
                $('content > table tr').each(function (key, obj) {
                    firstCell = $($($(obj).find('td')[0]).find('a'))
                    tooltipCell = $($(obj).find('td:nth-child(2) a.tooltip_sticky'));

                    // parse data
                    if (tooltipCell) {
                        parent = tooltipCell.parent();
                        parentParent = parent.parent();
                        tooltipSrc = tooltipCell.attr('data-tooltip-content');
                        playerId = parentParent.find('td:nth-child(6) a').attr('data-tooltip-content')?.match(/Dialog\.Playercard\(([0-9]+)\)/);
                        playerId = playerId ? parseInt(playerId[1]) : null;
                        coords = tooltipSrc?.match(/([0-9]+)\:([0-9]+)\:([0-9]+)/, tooltipSrc);
                        planetId = tooltipSrc?.match(/doit\(6\,([0-9]+)/, tooltipSrc);
                        planetId = planetId ? parseInt(planetId[1]) : null;
                        moonId = parentParent.find('td:nth-child(4)').html()?.match(/javascript\:doit\(([0-9]+)\,([0-9]+)\)/);
                        moonId = moonId ? moonId[2] : null;

                        if (coords && planetId) {
                            payload.push({
                                coordinates: coords[0],
                                planet_id: planetId,
                                player_id: playerId,
                                moon_id: moonId
                            });

                            if (json['planets'][key - 1].external_id !== parseInt(planetId)) {
                                console.log('planet id', key - 1);
                                updateRequired = true;
                            }

                            if (json['planets'][key - 1].moon_id != moonId) {
                                console.log('new moon', key - 1);
                                updateRequired = true;
                            }
                        } else {
                            if (json['planets'][key - 1] && json['planets'][key - 1].external_id !== null) {
                                if ($($(obj).find('.galaxy-username')).html() !== json['ownName']) {
                                    console.log('planet destroyed', key - 1);
                                    updateRequired = true;
                                }
                            }
                        }
                    }

                    if (firstCell.length === 0) {
                        firstCell = $($(obj).find('td')[0]);
                    }

                    planet = parseInt(firstCell.html());

                    if (!isNaN(planet) && json['planets'][planet]) {
                        $(obj).append('<td class="text-right" style="white-space: nowrap;">' + (json['planets'][planet].last_battle_report || '') + '</td>');
                        $(obj).append('<td class="text-right" style="white-space: nowrap;" onclick="showSpyReportHistory(' + json['planets'][planet].galaxy + ', ' + json['planets'][planet].system + ', ' + json['planets'][planet].planet + ')">' + (json['planets'][planet].last_spy_report || '') + '</td>');
                        $(obj).append('<td class="text-right" style="white-space: nowrap;">' + (json['planets'][planet].last_spy_metal || '') + '</td>');
                        $(obj).append('<td class="text-right" style="white-space: nowrap;">' + (json['planets'][planet].last_spy_crystal || '') + '</td>');
                        $(obj).append('<td class="text-right" style="white-space: nowrap;">' + (json['planets'][planet].last_spy_deuterium || '') + '</td>');
                    }
                });

                // queue update if necessary
                if (updateRequired) {
                    postJSON('planets/new', {
                        planets: payload,
                        galaxy: parseInt($('input[name=galaxy]').val()),
                        system: parseInt($('input[name=system]').val())
                    }, function (response) {
                    });
                }
            }
        });
    };
};


/***/ }),

/***/ 1497:
/***/ (() => {

window.PageHangar = function() {
    this.init = function() {
        this.convertHtml();
    };

    this.convertHtml = function() {
        $('content').addClass('hangar');

        $('.infos, .infoso').each(function(key, obj) {
            $(obj).addClass('hangar');
            $($(obj).find('div:nth-child(2)')).addClass('building-left');
            $($(obj).find('div:nth-child(3)')).addClass('building-right');
        });

        $('content').html($('content').html().replace(/Maximal baubare Einheiten:(.*)\<br\>/g, 'Maximal baubare Einheiten: $1'));
        $('content').html($('content').html().replace(/\(Stufe ([0-9]+)\)/g, '<br><span class="highlight">Stufe $1</span><br>'));
    };
};


/***/ }),

/***/ 691:
/***/ (() => {

window.PageHub = function () {
    const $this = this;
    this.container = $('content');
    this.init = function () {

    };

    this.loadPage = function (alias) {
        switch (alias) {
            case 'galaxyview':
                this.clearPage();
                this.loadGalaxyView();
                break;

            case 'planets':
                this.clearPage();
                this.loadPagePlanets();
                break;

            case 'research':
                this.clearPage();
                this.loadPageResearch();
                break;

            case 'fleet':
                this.clearPage();
                this.loadPageFleet();
                break;

            case 'score':
                this.clearPage();
                this.loadPageScore();
                break;

            case 'expos':
                this.clearPage();
                this.loadPageExpos();
                break;

            case 'galaxy':
                this.clearPage();
                this.loadPageGalaxy();
                break;

            case 'hostile-spying':
                this.clearPage();
                this.loadPageHostileSpying();
                break;

            case 'changelog':
                this.clearPage();
                this.loadPageChangelog();
                break;

            case 'alliance-power':
                this.clearPage();
                this.loadPageAlliancePower();
                break;

            default:
                alert('unknown page ' + alias);
        }
    };

    this.loadGalaxyView = function() {

    };

    this.clearPage = function () {
        this.container.html('<i class="fa fa-spin fa-spinner"></i> Daten werden geladen.');
        this.container.addClass('hub');
    };

    this.sortData = function (a, b) {
        let property = getValue('hub_planets_orderBy') || 'coordinates';
        const invertSort = getValue('hub_planets_orderDirection') !== 'DESC' ? 1 : -1;

        const offsets = property.split('.');
        if (offsets.length === 2) {
            a = a[offsets[0]];
            b = b[offsets[0]];
            property = offsets[1];
        }

        let aVal = a[property] || '';
        let bVal = b[property] || '';

        if (property !== 'alliance_name' && property !== 'name') {
            aVal = getInt(aVal);
            bVal = getInt(bVal);
        } else {
            aVal = aVal.toLowerCase();
            bVal = bVal.toLowerCase();
        }

        return ((aVal < bVal) ? -1 : (aVal > bVal) ? 1 : 0) * invertSort;
    };

    this.loadPagePlanets = function () {
        getJSON('hub/planets', function (response) {
            if (response.status !== 200) {
                $this.container.html('<p style="color: ' + getRgb(cRed) + ';">Da Wing-Member häufiger die Allianz verlassen, sind Flotteninformationen etc. nur für die Main Allianz einsehbar.</p>');
            }

            let data = JSON.parse(response.responseText);
            const fn = $this.sortData;

            // sort player list
            data = data.sort(fn);

            let html = '';

            html += '<div class="infos text-left">';
            html += '<p style="padding-left: 10px"><i class="fa fa-info-circle"></i> <i>Halte die Maus über die Buchstaben, um die Gebäudenamen zu sehen.</i></p>';
            html += '<table class="table519">';
            html += '<tr>';
            html += '<th class="sortable" colspan="3" data-sort="coordinates" data-direction="ASC">Koordinaten</th>';
            html += '<th class="sortable" style="text-align: left;" data-sort="name" data-direction="ASC">Spieler</th>';
            html += '<th class="sortable" style="text-align: left;" data-sort="score_building" data-direction="DESC">Punkte</th>';
            html += '<th class="sortable" style="text-align: right; color: ' + getRgb(cGreen) + '" data-sort="metal_mine" data-direction="DESC" title="Metallmine">M</th>';
            html += '<th class="sortable" style="text-align: right; color: ' + getRgb(cGreen) + '" data-sort="crystal_mine" data-direction="DESC" title="Kristallmine">K</th>';
            html += '<th class="sortable" style="text-align: right; color: ' + getRgb(cGreen) + '" data-sort="deuterium_mine" data-direction="DESC" title="Deuteriumsynthetisierer">D</th>';
            html += '<th class="sortable" style="text-align: right; color: ' + getRgb(cGreen) + '" data-sort="solar_plant" data-direction="DESC" title="Solarkraftwerk">S</th>';
            html += '<th class="sortable" style="text-align: right; color: ' + getRgb(cPink) + '" data-sort="techno_dome" data-direction="DESC" title="Technodom">T</th>';
            html += '<th class="sortable" style="text-align: right; color: ' + getRgb(cGreen) + '" data-sort="fusion_plant" data-direction="DESC" title="Fusionskraftwerk">F</th>';
            html += '<th class="sortable" style="text-align: right; color: ' + getRgb(cBlue) + '" data-sort="robot_factory" data-direction="DESC" title="Roboterfabrik">R</th>';
            html += '<th class="sortable" style="text-align: right; color: ' + getRgb(cBlue) + '" data-sort="nano_factory" data-direction="DESC" title="Nanofabrik">N</th>';
            html += '<th class="sortable" style="text-align: right; color: ' + getRgb(cRed) + '" data-sort="hangar" data-direction="DESC" title="Raumschiffwerft">R</th>';
            html += '<th class="sortable" style="text-align: right; color: ' + getRgb(cGreen) + '" data-sort="metal_storage" data-direction="DESC" title="Metallspeicher">M</th>';
            html += '<th class="sortable" style="text-align: right; color: ' + getRgb(cGreen) + '" data-sort="crystal_storage" data-direction="DESC" title="Kristallspeicher">K</th>';
            html += '<th class="sortable" style="text-align: right; color: ' + getRgb(cGreen) + '" data-sort="deuterium_storage" data-direction="DESC" title="Deuteriumtank">D</th>';
            html += '<th class="sortable" style="text-align: right; color: ' + getRgb(cPink) + '" data-sort="laboratory" data-direction="DESC" title="Forschungslabor">F</th>';
            html += '<th class="sortable" style="text-align: right; color: ' + getRgb(cBlue) + '" data-sort="terra_former" data-direction="DESC" title="Terraformer">T</th>';
            html += '<th class="sortable" style="text-align: right; color: ' + getRgb(cRed) + '" data-sort="alliance_depot" data-direction="DESC" title="Allianzdepot">A</th>';
            html += '<th class="sortable" style="text-align: right; color: ' + getRgb(cYellow) + '" data-sort="base" data-direction="DESC" title="Mondbasis">M</th>';
            html += '<th class="sortable" style="text-align: right; color: ' + getRgb(cYellow) + '" data-sort="phalanx" data-direction="DESC" title="Phalanx">P</th>';
            html += '<th class="sortable" style="text-align: right; color: ' + getRgb(cYellow) + '" data-sort="portal" data-direction="DESC" title="Sprungtor">S</th>';
            html += '<th class="sortable" style="text-align: right; color: ' + getRgb(cRed) + '" data-sort="missile_silo" data-direction="DESC" title="Raketensilo">R</th>';
            html += '</tr>';

            $.each(data, function (key, obj) {
                html += '<tr>';
                html += '<td style="text-align: right; width: 35px">' + obj.galaxy + '</td>';
                html += '<td style="text-align: right; width: 35px">' + obj.system + '</td>';
                html += '<td style="text-align: right; width: 35px">' + obj.planet + '</td>';
                html += '<td style="text-align: left;">' + obj.name + '</td>';
                html += '<td style="text-align: right; color: ' + getColorAlt(cGreen, parseInt(obj.score_building || 0) / getMaxValue(data, 'score_building'), cRed) + '">' + numberFormat(obj.score_building || '') + '</td>';
                html += '<td style="text-align: right; color: ' + getColorAlt(cGreen, parseInt(obj.metal_mine || 0) / getMaxValue(data, 'metal_mine'), cRed) + '">' + (obj.metal_mine || '') + '</td>';
                html += '<td style="text-align: right; color: ' + getColorAlt(cGreen, parseInt(obj.crystal_mine || 0) / getMaxValue(data, 'crystal_mine'), cRed) + '">' + (obj.crystal_mine || '') + '</td>';
                html += '<td style="text-align: right; color: ' + getColorAlt(cGreen, parseInt(obj.deuterium_mine || 0) / getMaxValue(data, 'deuterium_mine'), cRed) + '">' + (obj.deuterium_mine || '') + '</td>';
                html += '<td style="text-align: right; color: ' + getColorAlt(cGreen, parseInt(obj.solar_plant || 0) / getMaxValue(data, 'solar_plant'), cRed) + '">' + (obj.solar_plant || '') + '</td>';
                html += '<td style="text-align: right; color: ' + getColorAlt(cGreen, parseInt(obj.techno_dome || 0) / getMaxValue(data, 'techno_dome'), cRed) + '">' + (obj.techno_dome || '') + '</td>';
                html += '<td style="text-align: right; color: ' + getColorAlt(cGreen, parseInt(obj.fusion_plant || 0) / getMaxValue(data, 'fusion_plant'), cRed) + '">' + (obj.fusion_plant || '') + '</td>';
                html += '<td style="text-align: right; color: ' + getColorAlt(cGreen, parseInt(obj.robot_factory || 0) / getMaxValue(data, 'robot_factory'), cRed) + '">' + (obj.robot_factory || '') + '</td>';
                html += '<td style="text-align: right; color: ' + getColorAlt(cGreen, parseInt(obj.nano_factory || 0) / getMaxValue(data, 'nano_factory'), cRed) + '">' + (obj.nano_factory || '') + '</td>';
                html += '<td style="text-align: right; color: ' + getColorAlt(cGreen, parseInt(obj.hangar || 0) / getMaxValue(data, 'hangar'), cRed) + '">' + (obj.hangar || '') + '</td>';
                html += '<td style="text-align: right; color: ' + getColorAlt(cGreen, parseInt(obj.metal_storage || 0) / getMaxValue(data, 'metal_storage'), cRed) + '">' + (obj.metal_storage || '') + '</td>';
                html += '<td style="text-align: right; color: ' + getColorAlt(cGreen, parseInt(obj.crystal_storage || 0) / getMaxValue(data, 'crystal_storage'), cRed) + '">' + (obj.crystal_storage || '') + '</td>';
                html += '<td style="text-align: right; color: ' + getColorAlt(cGreen, parseInt(obj.deuterium_storage || 0) / getMaxValue(data, 'deuterium_storage'), cRed) + '">' + (obj.deuterium_storage || '') + '</td>';
                html += '<td style="text-align: right; color: ' + getColorAlt(cGreen, parseInt(obj.laboratory || 0) / getMaxValue(data, 'laboratory'), cRed) + '">' + (obj.laboratory || '') + '</td>';
                html += '<td style="text-align: right; color: ' + getColorAlt(cGreen, parseInt(obj.terra_former || 0) / getMaxValue(data, 'terra_former'), cRed) + '">' + (obj.terra_former || '') + '</td>';
                html += '<td style="text-align: right; color: ' + getColorAlt(cGreen, parseInt(obj.alliance_depot || 0) / getMaxValue(data, 'alliance_depot'), cRed) + '">' + (obj.alliance_depot || '') + '</td>';
                html += '<td style="text-align: right; color: ' + getColorAlt(cGreen, parseInt(obj.base || 0) / getMaxValue(data, 'base'), cRed) + '">' + (obj.base || '') + '</td>';
                html += '<td style="text-align: right; color: ' + getColorAlt(cGreen, parseInt(obj.phalanx || 0) / getMaxValue(data, 'phalanx'), cRed) + '">' + (obj.phalanx || '') + '</td>';
                html += '<td style="text-align: right; color: ' + getColorAlt(cGreen, parseInt(obj.portal || 0) / getMaxValue(data, 'portal'), cRed) + '">' + (obj.portal || '') + '</td>';
                html += '<td style="text-align: right; color: ' + getColorAlt(cGreen, parseInt(obj.missile_silo || 0) / getMaxValue(data, 'missile_silo'), cRed) + '">' + (obj.missile_silo || '') + '</td>';
                html += '</tr>';
            });

            html += '</table>';
            html += '</div>';

            $this.container.html(html);
            $('th.sortable').click(function () {
                if ($(this).attr('data-sort')) {
                    setValue('hub_planets_orderDirection', $(this).attr('data-direction'));
                    setValue('hub_planets_orderBy', $(this).attr('data-sort'));
                    $this.loadPagePlanets();
                }
            });

            $('th.sortable').each(function (key, obj) {
                $(obj).css('cursor', 'pointer');

                if ($(obj).attr('data-sort') == (getValue('hub_planets_orderBy') || 'coordinates') && $(obj).attr('data-direction') == (getValue('hub_planets_orderDirection') || 'ASC')) {
                    $(obj).prepend($(obj).attr('data-direction') === 'ASC' ? '<i class="fa fa-caret-up"></i> ' : '<i class="fa fa-caret-down"></i> ');
                    $(obj).css('white-space', 'nowrap');
                }
            });
        });
    };

    this.loadPageResearch = function () {
        getJSON('hub/research', function (response) {
            let data = JSON.parse(response.responseText);
            const allianceId = getValue('filter_alliance_id') || '';

            let html = '';
            html += '<div class="infos text-left">';
            html += '<select style="margin-left: 10px" id="allianceIdSelect" onchange="setValue(\'filter_alliance_id\', this.value); pageHub.loadPageResearch()">';
            html += '<option value="">Alle</option>';
            html += '<option value="12"' + (allianceId === '12' ? ' selected' : '') + '>FELIDAE FERNICHTER</option>';
            html += '<option value="95"' + (allianceId === '95' ? ' selected' : '') + '>FELIDAE FERNICHTER WING</option>';
            html += '</select>';
            html += '<p style="padding-left: 10px"><i class="fa fa-info-circle"></i> <i>Halte die Maus über die Buchstaben, um die Technologienamen zu sehen.</i></p>';
            html += '<table class="table519">';
            html += '<tr>';
            html += '<td></td>';
            html += '<td></td>';
            html += '<td colspan="2"></td>';
            html += '<td colspan="3">Flottenwert</td>';
            html += '<td colspan="2">Technik</td>';
            html += '<td colspan="3">Triebwerk</td>';
            html += '<td colspan="3">Bewaffnung</td>';
            html += '<td colspan="2"></td>';
            html += '<td colspan="3">Produktion</td>';
            html += '<td></td>';
            html += '</tr>';
            html += '<tr>';
            html += '<th style="text-align: left;">Spieler</th>';
            html += '<th style="text-align: right;">Punkte</th>';
            html += '<th style="text-align: right;" title="Spionagetechnik">Spionagetechnik</th>';
            html += '<th style="text-align: right;" title="Computertechnik">Computertechnik</th>';
            html += '<th style="text-align: right;" title="Waffentechnik">Waffentechnik</th>';
            html += '<th style="text-align: right;" title="Schildtechnik">Schildtechnik</th>';
            html += '<th style="text-align: right;" title="Raumschiffpanzerung">Raumschiffpanzerung</th>';
            html += '<th style="text-align: right;" title="Energietechnik">Energietechnik-</th>';
            html += '<th style="text-align: right;" title="Hyperraumtechnik">Hyperraumtechnik</th>';
            html += '<th style="text-align: right;" title="Verbrennungstriebwerk">Verbrennungstriebwerk</th>';
            html += '<th style="text-align: right;" title="Impulstriebwerk">Impulstriebwerk</th>';
            html += '<th style="text-align: right;" title="Hyperraumantrieb">Hyperraumantrieb</th>';
            html += '<th style="text-align: right;" title="Lasertechnik">Lasertechnik</th>';
            html += '<th style="text-align: right;" title="Ionentechnik">Ionentechnik</th>';
            html += '<th style="text-align: right;" title="Plasmatechnik">Plasmatechnik</th>';
            html += '<th style="text-align: right;" title="Intergalaktisches Forschungsnetzwerk">Intergalaktisches Forschungsnetzwerk</th>';
            html += '<th style="text-align: right;" title="Astrophysik">Astrophysik</th>';
            html += '<th style="text-align: right;" title="Produktionsmaximierung Metall">Produktionsmaximierung Metall</th>';
            html += '<th style="text-align: right;" title="Produktionsmaximierung Kristall">Produktionsmaximierung Kristall</th>';
            html += '<th style="text-align: right;" title="Produktionsmaximierung Deuterium">Produktionsmaximierung Deuterium</th>';
            html += '<th style="text-align: right;" title="Gravitonforschung">Gravitonforschung</th>';
            html += '</tr>';

            $.each(data, function (key, obj) {
                if (allianceId === '' || parseInt(allianceId) === obj.alliance_id) {
                    html += '<tr>';
                    html += '<td style="text-align: left;">' + obj.name + '</td>';
                    html += '<td style="text-align: right; color: ' + getColorAlt(cGreen, parseInt(obj.score_science || 0) / getMaxValue(data, 'score_science'), cRed) + '">' + obj.score_science + '</td>';
                    html += '<td style="text-align: right; color: ' + getColorAlt(cGreen, parseInt(obj.spy_tech || 0) / getMaxValue(data, 'spy_tech'), cRed) + '">' + (obj.spy_tech || '') + '</td>';
                    html += '<td style="text-align: right; color: ' + getColorAlt(cGreen, parseInt(obj.computer_tech || 0) / getMaxValue(data, 'computer_tech'), cRed) + '">' + (obj.computer_tech || '') + '</td>';
                    html += '<td style="background: rgba(255, 255, 255, 0.05) !important; text-align: right; color: ' + getColorAlt(cGreen, parseInt(obj.military_tech || 0) / getMaxValue(data, 'military_tech'), cRed) + '">' + (obj.military_tech || '') + '</td>';
                    html += '<td style="background: rgba(255, 255, 255, 0.05) !important; text-align: right; color: ' + getColorAlt(cGreen, parseInt(obj.defense_tech || 0) / getMaxValue(data, 'defense_tech'), cRed) + '">' + (obj.defense_tech || '') + '</td>';
                    html += '<td style="background: rgba(255, 255, 255, 0.05) !important; text-align: right; color: ' + getColorAlt(cGreen, parseInt(obj.shield_tech || 0) / getMaxValue(data, 'shield_tech'), cRed) + '">' + (obj.shield_tech || '') + '</td>';
                    html += '<td style="text-align: right; color: ' + getColorAlt(cGreen, parseInt(obj.energy_tech || 0) / getMaxValue(data, 'energy_tech'), cRed) + '">' + (obj.energy_tech || '') + '</td>';
                    html += '<td style="text-align: right; color: ' + getColorAlt(cGreen, parseInt(obj.hyperspace_tech || 0) / getMaxValue(data, 'hyperspace_tech'), cRed) + '">' + (obj.hyperspace_tech || '') + '</td>';
                    html += '<td style="text-align: right; color: ' + getColorAlt(cGreen, parseInt(obj.combustion_tech || 0) / getMaxValue(data, 'combustion_tech'), cRed) + '">' + (obj.combustion_tech || '') + '</td>';
                    html += '<td style="background: rgba(255, 255, 255, 0.05) !important; text-align: right; color: ' + getColorAlt(cGreen, parseInt(obj.impulse_motor_tech || 0) / getMaxValue(data, 'impulse_motor_tech'), cRed) + '">' + (obj.impulse_motor_tech || '') + '</td>';
                    html += '<td style="background: rgba(255, 255, 255, 0.05) !important; text-align: right; color: ' + getColorAlt(cGreen, parseInt(obj.hyperspace_motor_tech || 0) / getMaxValue(data, 'hyperspace_motor_tech'), cRed) + '">' + (obj.hyperspace_motor_tech || '') + '</td>';
                    html += '<td style="text-align: right; color: ' + getColorAlt(cGreen, parseInt(obj.laser_tech || 0) / getMaxValue(data, 'laser_tech'), cRed) + '">' + (obj.laser_tech || '') + '</td>';
                    html += '<td style="text-align: right; color: ' + getColorAlt(cGreen, parseInt(obj.ion_tech || 0) / getMaxValue(data, 'ion_tech'), cRed) + '">' + (obj.ion_tech || '') + '</td>';
                    html += '<td style="text-align: right; color: ' + getColorAlt(cGreen, parseInt(obj.buster_tech || 0) / getMaxValue(data, 'buster_tech'), cRed) + '">' + (obj.buster_tech || '') + '</td>';
                    html += '<td style="background: rgba(255, 255, 255, 0.05) !important; text-align: right; color: ' + getColorAlt(cGreen, parseInt(obj.intergalactic_tech || 0) / getMaxValue(data, 'intergalactic_tech'), cRed) + '">' + (obj.intergalactic_tech || '') + '</td>';
                    html += '<td style="background: rgba(255, 255, 255, 0.05) !important; text-align: right; color: ' + getColorAlt(cGreen, parseInt(obj.expedition_tech || 0) / getMaxValue(data, 'expedition_tech'), cRed) + '">' + (obj.expedition_tech || '') + '</td>';
                    html += '<td style="background: rgba(255, 255, 255, 0.05) !important; text-align: right; color: ' + getColorAlt(cGreen, parseInt(obj.metal_proc_tech || 0) / getMaxValue(data, 'metal_proc_tech'), cRed) + '">' + (obj.metal_proc_tech || '') + '</td>';
                    html += '<td style="text-align: right; color: ' + getColorAlt(cGreen, parseInt(obj.crystal_proc_tech || 0) / getMaxValue(data, 'crystal_proc_tech'), cRed) + '">' + (obj.crystal_proc_tech || '') + '</td>';
                    html += '<td style="text-align: right; color: ' + getColorAlt(cGreen, parseInt(obj.deuterium_proc_tech || 0) / getMaxValue(data, 'deuterium_proc_tech'), cRed) + '">' + (obj.deuterium_proc_tech || '') + '</td>';
                    html += '<td style="text-align: right; color: ' + getColorAlt(cGreen, parseInt(obj.graviton_tech || 0) / getMaxValue(data, 'graviton_tech'), cRed) + '">' + (obj.graviton_tech || '') + '</td>';
                    html += '</tr>';
                }
            });

            html += '</table>';
            html += '</div>';

            $this.container.html(html);

            getJSON('hub/transfer-matrix', function (response) {
                data = JSON.parse(response.responseText);

                html = '';
                html += '<div class="infos text-left">';
                html += '<p style="margin-left: 10px"><b>Flotten-Transfers</b><br>Zeig an, ob der Sender (links) dem Empfänger (rechts) Schiffe schicken darf.</p>';
                html += '<table class="table519">';
                html += '<tr>';
                html += '<th class="text-left">Send. / Empf.</th>';

                $.each(data, function (key, obj) {
                    if (allianceId === '' || parseInt(allianceId) === obj.alliance_id) {
                        html += '<th class="text-center" style="width: 75px"><div style="width: 75px; overflow: hidden; text-overflow: ellipsis">' + obj.name + '</div></th>';
                    }
                });

                html += '</tr>';
                $.each(data, function (key, sender) {
                    if (allianceId === '' || parseInt(allianceId) === sender.alliance_id) {
                        html += '<tr>';
                        html += '<td style="text-align: left;">' + sender.name + '</td>';
                        $.each(data, function (key, receiver) {
                            if (allianceId === '' || parseInt(allianceId) === receiver.alliance_id) {
                                if (sender.transfer_possible[receiver.id] === null) {
                                    html += '<td class="text-center" style="color: ' + getRgb(cGray) + '">---</td>';
                                } else {
                                    html += '<td class="text-center text-' + (sender.transfer_possible[receiver.id] ? 'green' : 'red') + '">' + (sender.transfer_possible[receiver.id] ? 'Ja' : 'Nein') + '</td>';
                                }
                            }
                        });
                        html += '</tr>';
                    }
                });

                html += '</table>';
                html += '</div>';

                $this.container.append(html);
            });
        });
    };

    this.loadPageFleet = function () {
        getJSON('hub/fleet', function (response) {
            const data = JSON.parse(response.responseText);
            let html = '';

            html += '<div class="infos text-left">';
            html += '<p style="padding-left: 10px"><i class="fa fa-info-circle"></i> <i>Halte die Maus über die Buchstaben, um die Schiffsnamen zu sehen.</i></p>';
            html += '<table class="borderless">';
            html += '<tr>';
            html += '<th style="text-align: left;">Spieler</th>';
            html += '<th style="text-align: right">Punkte</th>';
            html += '<th style="text-align: right; color: ' + getRgb(cGreen) + '" title="Kleiner Transporter">KT</th>';
            html += '<th style="text-align: right; color: ' + getRgb(cGreen) + '" title="Großer Transporter">GT</th>';
            html += '<th style="text-align: right; color: ' + getRgb(cGreen) + '" title="Kolonieschiff">KS</th>';
            html += '<th style="text-align: right; color: ' + getRgb(cGreen) + '" title="Recycler">Rec</th>';
            html += '<th style="text-align: right; color: ' + getRgb(cGreen) + '" title="Spionagesonden">Spy</th>';
            html += '<th style="text-align: right; color: ' + getRgb(cGreen) + '" title="Solar Satellit">Sat</th>';

            html += '<th style="text-align: right; color: ' + getRgb(cRed) + '" title="Leichter Jäger">LJ</th>';
            html += '<th style="text-align: right; color: ' + getRgb(cRed) + '" title="Schwerer Jäger">SJ</th>';
            html += '<th style="text-align: right; color: ' + getRgb(cRed) + '" title="Kreuzer">Xer</th>';
            html += '<th style="text-align: right; color: ' + getRgb(cRed) + '" title="Schlachtschiff">SS</th>';
            html += '<th style="text-align: right; color: ' + getRgb(cRed) + '" title="Bomber">B</th>';
            html += '<th style="text-align: right; color: ' + getRgb(cRed) + '" title="Zerstörer">Z</th>';
            html += '<th style="text-align: right; color: ' + getRgb(cRed) + '" title="Todesstern">DS</th>';
            html += '<th style="text-align: right; color: ' + getRgb(cRed) + '" title="Schlachtkreuzer">SXer</th>';
            html += '</tr>';

            let style;
            $.each(data, function (key, obj) {
                style = obj.name === 'Gesamt' ? 'font-weight: bold; padding-top: 5px; border-top: 1px solid ' + getRgb(cRed) + '; color: ' + getRgb(cRed) : '';
                html += '<tr>';
                html += '<td style="text-align: left; ' + style + '">' + obj.name + '</td>';
                html += '<td style="text-align: right; ' + style + '">' + (obj.score_military || '') + '</td>';
                html += '<td style="text-align: right; ' + style + '">' + (obj.small_transporters || '') + '</td>';
                html += '<td style="text-align: right; ' + style + '">' + (obj.large_transporters || '') + '</td>';
                html += '<td style="text-align: right; ' + style + '">' + (obj.coloy_ships || '') + '</td>';
                html += '<td style="text-align: right; ' + style + '">' + (obj.recyclers || '') + '</td>';
                html += '<td style="text-align: right; ' + style + '">' + (obj.spy_drones || '') + '</td>';
                html += '<td style="text-align: right; ' + style + '">' + (obj.solar_satellites || '') + '</td>';

                html += '<td style="text-align: right; ' + style + '">' + (obj.light_hunters || '') + '</td>';
                html += '<td style="text-align: right; ' + style + '">' + (obj.heavy_hunters || '') + '</td>';
                html += '<td style="text-align: right; ' + style + '">' + (obj.cruisers || '') + '</td>';
                html += '<td style="text-align: right; ' + style + '">' + (obj.battleships || '') + '</td>';
                html += '<td style="text-align: right; ' + style + '">' + (obj.bombers || '') + '</td>';
                html += '<td style="text-align: right; ' + style + '">' + (obj.destroyers || '') + '</td>';
                html += '<td style="text-align: right; ' + style + '">' + (obj.death_stars || '') + '</td>';
                html += '<td style="text-align: right; ' + style + '">' + (obj.battle_cruisers || '') + '</td>';
                html += '</tr>';
            });

            html += '</table>';
            html += '</div>';

            $this.container.html(html);
        });
    };

    this.loadPageScore = function () {
        $('head').append('<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>');
        getJSON('hub/scores', function (response) {
            response = JSON.parse(response.responseText);
            $this.container.html('<div class="infos text-left"><p style="padding-left: 10px"><i class="fa fa-info-circle"></i> <i>Relative Punkteänderung in % pro Kalenderwoche</i></p><canvas id="scoreChart" style="height: 500px; width: 100%"></canvas></div>');

            const dates = response['dates'];
            let dataSets = [];
            let colors = ["#bce4d8", "#aedcd5", "#a1d5d2", "#95cecf", "#89c8cc", "#7ec1ca", "#72bac6", "#66b2c2", "#59acbe", "#4ba5ba", "#419eb6", "#3b96b2", "#358ead", "#3586a7", "#347ea1", "#32779b", "#316f96", "#2f6790", "#2d608a", "#2c5985"];

            for (let p = 0; p < response['data'].length; p++) {
                dataSets.push({
                    label: response['data'][p]['name'],
                    data: response['data'][p]['score_relative'],
                    backgroundColor: response['data'][p]['me'] ? '#ee4d2e' : colors[p % colors.length],
                    radius: 1
                });
            }

            const myChart = new Chart(
                document.getElementById('scoreChart'),
                {
                    type: 'bar',
                    data: {
                        labels: dates,
                        datasets: dataSets,
                    },
                }
            );

            $this.container.append('<div class="infos text-left"><p style="padding-left: 10px"><i class="fa fa-info-circle"></i> <i>Absolute Punkteänderung pro Kalenderwoche</i></p><canvas id="scoreChart2" style="height: 500px; width: 100%"></canvas></div>');

            dataSets = [];

            for (let p = 0; p < response['data'].length; p++) {
                dataSets.push({
                    label: response['data'][p]['name'],
                    data: response['data'][p]['score_diff'],
                    backgroundColor: response['data'][p]['me'] ? '#ee4d2e' : colors[p % colors.length],
                    radius: 1
                });
            }

            const myChart2 = new Chart(
                document.getElementById('scoreChart2'),
                {
                    type: 'bar',
                    data: {
                        labels: dates,
                        datasets: dataSets,
                    },
                }
            );
        });
    };

    this.loadPageExpos = function () {
        let html = '';

        getJSON('flights/stats', function (response) {
            response = JSON.parse(response.responseText);

            html = '<div class="infos text-left">';
            html += '<table class="borderless" cellspacing="0">';
            html += '<tr>';
            html += '<tr><th colspan="7"><b>Eigene Statistik (gesamte Zeit)</b></th></tr>';
            html += '<th style="white-space: nowrap">Planet</th>';
            html += '<th style="white-space: nowrap" class="text-right">Letzte 24 Std</th>';
            html += '<th style="white-space: nowrap" class="text-right">Metall</th>';
            html += '<th style="white-space: nowrap" class="text-right">Kristall</th>';
            html += '<th style="white-space: nowrap" class="text-right">Deuterium</th>';
            html += '<th style="white-space: nowrap" class="text-right">Punkte</th>';
            html += '</tr>';

            $.each(response.own_stats, function (key, obj) {
                html += '<tr>';
                html += '<td style="white-space: nowrap" class="text-left">' + key + '</td>';
                html += '<td style="white-space: nowrap" class="text-right">' + obj.count_24 + '</td>';
                html += '<td style="white-space: nowrap" class="text-right ' + getStyle(obj.metal_diff) + '">' + obj.metal_diff + '</td>';
                html += '<td style="white-space: nowrap" class="text-right ' + getStyle(obj.crystal_diff) + '">' + obj.crystal_diff + '</td>';
                html += '<td style="white-space: nowrap" class="text-right ' + getStyle(obj.deuterium_diff) + '">' + obj.deuterium_diff + '</td>';
                html += '<td style="white-space: nowrap" class="text-right ' + getStyle(obj.score_diff) + '">' + obj.score_diff + '</td>';
                html += '</tr>';
            });

            html += '</table>';
            html += '</div>';

            html += '<div class="infos text-left">';
            html += '<table class="borderless" cellspacing="0">';
            html += '<tr>';
            html += '<tr><th colspan="7"><b>Expos (letzte 24 Std)</b></th></tr>';
            html += '<th style="white-space: nowrap">Planet</th>';
            html += '<th style="white-space: nowrap" class="text-right">Letzte 24 Std</th>';
            html += '<th style="white-space: nowrap" class="text-right">Metall</th>';
            html += '<th style="white-space: nowrap" class="text-right">Kristall</th>';
            html += '<th style="white-space: nowrap" class="text-right">Deuterium</th>';
            html += '<th style="white-space: nowrap" class="text-right">Punkte</th>';
            html += '</tr>';

            $.each(response.stats_per_player, function (key, obj) {
                html += '<tr>';
                html += '<td style="white-space: nowrap" class="text-left">' + obj.name + '</td>';
                html += '<td style="white-space: nowrap" class="text-right">' + obj.expeditions.count + '</td>';
                html += '<td style="white-space: nowrap" class="text-right ' + getStyle(obj.expeditions.metal_diff) + '">' + obj.expeditions.metal_diff + '</td>';
                html += '<td style="white-space: nowrap" class="text-right ' + getStyle(obj.expeditions.crystal_diff) + '">' + obj.expeditions.crystal_diff + '</td>';
                html += '<td style="white-space: nowrap" class="text-right ' + getStyle(obj.expeditions.deuterium_diff) + '">' + obj.expeditions.deuterium_diff + '</td>';
                html += '<td style="white-space: nowrap" class="text-right ' + getStyle(obj.expeditions.score_diff) + '">' + obj.expeditions.score_diff + '</td>';
                html += '</tr>';
            });

            html += '</table>';
            html += '</div>';

            html += '<div class="infos text-left">';
            html += '<table class="borderless" cellspacing="0">';
            html += '<tr>';
            html += '<tr><th colspan="7"><b>Raids (letzte 24 Std)</b></th></tr>';
            html += '<th style="white-space: nowrap">Planet</th>';
            html += '<th style="white-space: nowrap" class="text-right">Gesamt</th>';
            html += '<th style="white-space: nowrap" class="text-right">Metall</th>';
            html += '<th style="white-space: nowrap" class="text-right">Kristall</th>';
            html += '<th style="white-space: nowrap" class="text-right">Deuterium</th>';
            html += '<th style="white-space: nowrap" class="text-right">Punkte</th>';
            html += '</tr>';

            $.each(response.stats_per_player, function (key, obj) {
                html += '<tr>';
                html += '<td style="white-space: nowrap" class="text-left">' + obj.name + '</td>';
                html += '<td style="white-space: nowrap" class="text-right">' + obj.raids.count + '</td>';
                html += '<td style="white-space: nowrap" class="text-right ' + getStyle(obj.raids.metal_diff) + '">' + obj.raids.metal_diff + '</td>';
                html += '<td style="white-space: nowrap" class="text-right ' + getStyle(obj.raids.crystal_diff) + '">' + obj.raids.crystal_diff + '</td>';
                html += '<td style="white-space: nowrap" class="text-right ' + getStyle(obj.raids.deuterium_diff) + '">' + obj.raids.deuterium_diff + '</td>';
                html += '<td style="white-space: nowrap" class="text-right ' + getStyle(obj.raids.score_diff) + '">' + obj.raids.score_diff + '</td>';
                html += '</tr>';
            });

            html += '</table>';
            html += '</div>';

            $this.container.html(html);
        })
    };

    this.loadPageGalaxy = function () {
        let html = '';

        getJSON('hub/galaxy', function (response) {
            response = JSON.parse(response.responseText);

            html = '<div class="infos text-left">';
            html += '<table class="borderless" cellspacing="0">';
            html += '<tr>';
            html += '<th style="white-space: nowrap; width: 10%">Galaxie</th>';
            html += '<th style="white-space: nowrap" class="text-right">Systeme 1-400</th>';
            html += '</tr>';

            $.each(response, function (galaxy, data) {
                html += '<tr>';
                html += '<td style="white-space: nowrap" class="text-left">Galaxie ' + galaxy + '</td>';
                html += '<td style="white-space: nowrap" class="text-left">';
                html += '<div style="display: flex; width: 100%; justify-content: stretch">';
                $.each(data, function (system, obj) {
                    html += '<div title="System ' + system + ': ' + (obj.last_viewed_at || '---') + '" style="height: 25px; background: ' + getColorAlt([92, 184, 92], obj.intensity, [238, 77, 46]) + '; min-width: 1px; flex-grow: 1"></div>';
                });
                html += '</div>';
                html += '</td>';
                html += '</tr>';
            });

            html += '</table>';
            html += '<small class="text-left" style="display: block; color: ' + getRgb(cWhite) + '; padding-top: 10px; margin-top: 10px; border-top: 1px solid #222">Für jedes System wird ein schmaler Balken abgebildet. Die Farbe ist grün, sofern das System erst kürzlich angeschaut wurde und rot, wenn die letzte Überprüfung 7 Tage oder länger her ist. Das dargestellte System sowie Zeitpunkt der letzten Aktualisierung sind per Mouseover sichtbar.</small>';
            html += '</div>';

            $this.container.html(html);
        });
    };

    this.loadPageHostileSpying = function (page = 1) {
        let html = '';

        getJSON('hostile-spying?page=' + page, function (response) {
            response = JSON.parse(response.responseText);
            html += '<div class="infos text-left">';
            html += '<div class="text-center">';

            for (let p = 1; p <= response.last_page; p++) {
                html += '<a style="margin-right: 1px; background: #444; border-radius: 1px; padding: 4px; color: ' + getRgb(p === response.current_page ? cRed : cWhite) + '" href="javascript:void(0)" onclick="pageHub.loadPageHostileSpying(' + p + ')">' + p + '</a>';
            }

            html += '</div><br><table class="borderless">';
            html += '<tr>';
            html += '<th class="text-left">Allianz</th>';
            html += '<th class="text-left">Spion</th>';
            html += '<th class="text-left">Koords</th>';
            html += '<th class="text-left">Ziel</th>';
            html += '<th class="text-left">Ziel Koords</th>';
            html += '<th class="text-left">Zeitpunkt</th>';
            html += '</tr>';
            $.each(response.data, function (key, obj) {
                html += '<tr>';
                html += '<td class="text-left">' + (obj.attacker_alliance || '---') + '</td>';
                html += '<td class="text-left">' + (obj.attacker_name || '---') + '</td>';
                html += '<td class="text-left">' + obj.planet_start_coordinates + '</td>';
                html += '<td class="text-left">' + obj.target_name + '</td>';
                html += '<td class="text-left">' + obj.planet_target_coordinates + '</td>';
                html += '<td class="text-left">' + obj.timestamp + '</td>';
                html += '</tr>';
            });
            html += '</table>';
            html += '</div>';

            $this.container.html(html);
        });
    };

    this.loadPageAlliancePower = function () {
        let html = '';

        getJSON('hub/galaxy-alliances', function (response) {
            response = JSON.parse(response.responseText);
            html += '<div class="infos text-left">';
            html += '<table class="galaxy-power" cellspacing="0" cellpadding="0">';

            $.each(response, function (galaxy, galaxyData) {
                html += '<tr><th colspan="400" style="padding-top: 10px !important; padding-left: 0 !important;">Galaxie ' + galaxy + '</th></tr>';
                html += '<tr>';
                for (let i = 1; i <= 40; i++) {
                    html += '<th width="10" style="font-size: 8px; width: 10px; padding: 0 !important;" colspan="10">' + (i * 10 - 9) + '</th>';
                }
                html += '</tr>';

                $.each(galaxyData, function (planet, data) {
                    html += '<tr>';
                    $.each(data, function (system, obj) {
                        html += '<td class="galaxy-power" width="1" style="background: transparent; font-size: 10px; padding: 0;" title="' + system + ':' + planet + ': ' + (obj.name || '---') + ' (' + (obj.alliance || '---') + ')"><div style="box-shadow: 0 0 ' + Math.round(obj.power / 250) + 'px ' + Math.round(obj.power / 1250) + 'px ' + (obj.color || '#ffffff') + '; background-color: ' + (obj.color || 'rgba(255, 255, 255, 0.1)') + '"></div></td>';
                    });
                    html += '</tr>';
                });
            });

            html += '</table>';
            html += '</div>';

            $('head').append('<style>table.galaxy-powerx {border-collapse: collapse !important;} td.galaxy-power {outline: none !important; border: none !important; padding: 0 !important;}.galaxy-power > div {width: 7px !important; height: 7px !important;}</style>');

            $this.container.html(html);
        });
    };

    this.loadPageChangelog = function () {
        let html = '';

        html += '<div class="infos text-left">';
        html += '<table class="borderless">';
        html += '<tr>';
        html += '<th class="text-right" style="widtH: 75px">Version</th>';
        html += '<th class="text-left" style="width: 150px">DateTime</th>';
        html += '<th class="text-left">Changes</th>';
        html += '</tr>';

        $.each(changelog, function (key, obj) {
            html += '<tr>';
            html += '<td class="text-right" style="white-space: nowrap; color: ' + getRgb(version === obj.version ? cGreen : cWhite) + '">' + obj.version + '</td>';
            html += '<td class="text-left" style="white-space: nowrap; color: ' + getRgb(version === obj.version ? cGreen : cWhite) + '">' + obj.date_time + '</td>';
            html += '<td class="text-left" style="color: ' + getRgb(version === obj.version ? cGreen : cWhite) + '">' + obj.changes + '</td>';
            html += '</tr>';
        });

        html += '</table>';
        html += '<p class="text-center text-green" style="padding-top: 10px">coded with <i class="fa fa-heart text-red"></i> by eichhorn/esKju</p>';
        html += '</div>';

        $this.container.html(html);
    };
};


/***/ }),

/***/ 7730:
/***/ (() => {

window.PageImperium = function () {
    this.init = function () {
        let coords;
        let item;
        let itemName;
        let tds;
        let tdItemName;
        let maxLevel;

        $('span.text-green').css('display', 'block');

        $('tr').each(function (key, obj) {
            tds = $(obj).find('td');
            tdItemName = $(tds[0]).find('a').html();

            $.each(tds, function (sKey, sObj) {
                $(tds[sKey]).addClass(sKey === 0 ? 'text-left' : 'text-right');
            });

            if (key === 2) {
                $('#planetSelector option').each(function (sKey, sObj) {
                    $(tds[sKey + 2]).html('<div style="width: ' + ($(tds[sKey + 2]).offsetWidth + 'px') + '; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">' + $(tds[sKey + 2]).html() + '</div>');
                });
            }

            if (key > 10 && key < 30) {
                maxLevel = 0;
                $.each(tds, function (sKey, sObj) {
                    if (sKey > 1) {
                        maxLevel = getInt($(sObj).html()) > maxLevel ? getInt($(sObj).html()) : maxLevel;
                    }
                });
            }

            $('#planetSelector option').each(function (sKey, sObj) {
                coords = getCoordinates(sObj.innerHTML);
                item = getValue(coords[0] + '_building_item');
                itemName = item.match(/(.*) \(([0-9]+)\)/);
                itemName = itemName ? itemName[1] : '';

                if (key > 10 && key < 30) {
                    $(tds[sKey + 2]).css('color', getColorAlt(cGreen, getInt($(tds[sKey + 2]).html()) / maxLevel, cRed));
                }

                if ($(tds[sKey + 2]).html() === '0') {
                    $(tds[sKey + 2]).css('color', 'rgba(255, 255, 255, 0.15)');
                }

                if (tdItemName === itemName) {
                    $(tds[sKey + 2]).prepend('<i class="fa fa-arrow-up"></i> ');
                }
            });
        });
    }
}


/***/ }),

/***/ 2419:
/***/ (() => {

window.PageMessages = function () {
    const messages = $($('#messagestable > tbody > tr').get().reverse());
    let message;
    let messageId;
    let dateTime;
    let expeditionType;
    let expeditionSize;
    let headerText;
    let parseResult;
    let galaxy;
    let system;
    let planet;
    let timestamp;
    let coords;
    let labels;
    let values;
    let resources;

    this.colors = new top.Colors();
    const $this = this;

    this.init = function () {
        const ids = [];
        let messageId;

        messages.each(function (key, obj) {
            messageId = parseInt($(obj).attr('class')?.match(/message\_([0-9]+)/)[1]);

            if (messageId && Array.from(ids).indexOf(messageId) === -1) {
                ids.push(messageId);
            }
        });

        postJSON('messages', {messageIds: ids}, function (unknownIds) {
            messages.each(function (key, obj) {
                messageId = parseInt($(obj).attr('class')?.match(/message\_([0-9]+)/)[1]);

                if (messageId && Array.from(JSON.parse(unknownIds.responseText)).indexOf(messageId) !== -1) {
                    // spy report
                    if ($(obj).find('.spyRaport').length > 0) {
                        $this.parseSpyReport(key, obj);
                    } else if ($(obj).hasClass('message_head') && $($(obj).find('td')[3]).html().search(/Spionage\-Aktivität/) !== -1) {
                        $this.parseEnemySpying(key, obj);
                    } else if ($(obj).find('.raportMessage').length > 0) {
                        $this.parseBattleReport(key, obj);
                    } else if ($(obj).hasClass('message_head') && $($(obj).find('td')[3]).html().search(/Expeditionsbericht/) !== -1) {
                        $this.parseExpedition(key, obj);
                    }
                }
            });
        }, false);
    }

    this.parseSpyReport = function (key, obj) {
        dateTime = $(messages[key - 1]).find('td:nth-child(2)').html();

        headerText = $(obj).find('.spyRaportHead a').html();
        parseResult = headerText.match(/Spionagebericht von (.*) \[([0-9]+)\:([0-9]+)\:([0-9]+)\] am (.*)/, headerText);
        galaxy = parseResult[2];
        system = parseResult[3];
        planet = parseResult[4];
        timestamp = parseResult[5];
        coords = galaxy + ':' + system + ':' + planet;

        labels = $(obj).find('.spyRaportContainerRow .spyRaportContainerCell:nth-child(2n+1)');
        values = $(obj).find('.spyRaportContainerRow .spyRaportContainerCell:nth-child(2n)');
        resources = {};

        labels.each(function (labelKey, label) {
            resources[($(label).find('a').attr('onclick') || '').match(/\(([0-9]+)\)/)[1]] = getInt($(values[labelKey]).html());
        });

        postJSON('spy-reports', {
            id: parseInt($(obj).attr('class').match(/message\_([0-9]+)/)[1]),
            galaxy: parseInt(parseResult[2]),
            system: parseInt(parseResult[3]),
            planet: parseInt(parseResult[4]),
            timestamp: dateTime,
            resources: resources,
            resourcesVisible: $(obj).html().search(/Rohstoffe/) !== -1,
            shipsVisible: $(obj).html().search(/Schiffe/) !== -1,
            defenseVisible: $(obj).html().search(/Verteidigungsanlagen/) !== -1,
            buildingsVisible: $(obj).html().search(/Gebäude/) !== -1,
            researchVisible: $(obj).html().search(/Forschungen/) !== -1
        }, function (response) {
        });
    }

    this.parseBattleReport = function (key, obj) {
        var html = $(obj).html();
        var parseResult = getCoordinates($(obj).find('.raportMessage').html());

        postJSON('battle-reports', {
            id: parseInt($(obj).attr('class').match(/message\_([0-9]+)/)[1]),
            report_id: html.match(/(raport|report)\=([^"]{32})/)[2],
            galaxy: parseInt(parseResult[1]),
            system: parseInt(parseResult[2]),
            planet: parseInt(parseResult[3]),
            attacker_lost: getInt(html.match(/Angreifer\: ([\.0-9]+)\</)[1]),
            defender_lost: getInt(html.match(/Verteidiger\: ([\.0-9]+)\</)[1]),
            metal: getInt(html.match(/(reportSteal|raportSteal) element901\"\>([\.0-9]+)\</)[2]),
            crystal: getInt(html.match(/(reportSteal|raportSteal) element902\"\>([\.0-9]+)\</)[2]),
            deuterium: getInt(html.match(/(reportSteal|raportSteal) element903\"\>([\.0-9]+)\</)[2]),
            debris_metal: getInt(html.match(/(reportDebris|raportDebris) element901\"\>([\.0-9]+)\</)[2]),
            debris_crystal: getInt(html.match(/(reportDebris|raportDebris) element902\"\>([\.0-9]+)\</)[2]),
            timestamp: $(messages[key + 1]).find('td:nth-child(2)').html()
        }, function (response) {
        });
    }

    this.parseEnemySpying = function (key, obj) {
        messageId = $(obj).attr('id').replace(/message\_/, '');
        dateTime = $(obj).hasClass('message_head') && $($(obj).find('td')[1]).html();
        const coords = $($(messages[key - 1]).find('td')).html().match(/([0-9]+)\:([0-9]+)\:([0-9]+)/g);

        postJSON('hostile-spying', {
            id: messageId,
            external_id: messageId,
            date_time: dateTime,
            planet_start_coordinates: coords[0],
            planet_target_coordinates: coords[1]
        }, function () {
        });
    };

    this.parseExpedition = function (key, obj) {
        messageId = $(obj).attr('id').replace(/message\_/, '');
        dateTime = $(obj).hasClass('message_head') && $($(obj).find('td')[1]).html();

        $($(messages[key - 1]).find('td')).html($($(messages[key - 1]).find('td')).html().replace(/Logbuch Nachtrag des Kommunikationsoffiziers: Dieser Bereich des Universums ist wohl noch nicht erkundet worden./, '<span style="color: ' + $this.colors.green() + '"><i class="fa fa-check"></i></span> Logbuch Nachtrag des Kommunikationsoffiziers: Dieser Bereich des Universums ist wohl noch nicht erkundet worden.'));
        $($(messages[key - 1]).find('td')).html($($(messages[key - 1]).find('td')).html().replace(/Logbuch Nachtrag des Kommunikationsoffiziers: Es ist ein erhebendes Gefühl, der Erste in einem unerforschten Sektor zu sein./, '<span style="color: ' + $this.colors.green() + '"><i class="fa fa-check"></i></span> Logbuch Nachtrag des Kommunikationsoffiziers: Es ist ein erhebendes Gefühl, der Erste in einem unerforschten Sektor zu sein.'));
        $($(messages[key - 1]).find('td')).html($($(messages[key - 1]).find('td')).html().replace(/Logbuch Nachtrag des Kommunikationsoffiziers: Es scheint nicht so, als ob jemals ein Mensch in diesem Bereich der Galaxis gewesen wäre./, '<span style="color: ' + $this.colors.red() + '"><i class="fa fa-exclamation-triangle"></i> 25%</span> Logbuch Nachtrag des Kommunikationsoffiziers: Es scheint nicht so, als ob jemals ein Mensch in diesem Bereich der Galaxis gewesen wäre.'));
        $($(messages[key - 1]).find('td')).html($($(messages[key - 1]).find('td')).html().replace(/Logbuch Nachtrag des Kommunikationsoffiziers: Es wurden Anzeichen für die Präsenz anderer Expeditionsflotten gefunden./, '<span style="color: ' + $this.colors.red() + '"><i class="fa fa-exclamation-triangle"></i> 50%</span> Logbuch Nachtrag des Kommunikationsoffiziers: Es wurden Anzeichen für die Präsenz anderer Expeditionsflotten gefunden.'));
        $($(messages[key - 1]).find('td')).html($($(messages[key - 1]).find('td')).html().replace(/Logbuch Nachtrag des Kommunikationsoffiziers: Wenn wir uns zu unsicher fühlen, können wir uns ja mit all den anderen Expeditionen, die hier herum fliegen, zusammen tun./, '<span style="color: ' + $this.colors.red() + '"><i class="fa fa-exclamation-triangle"></i> 75%</span> Logbuch Nachtrag des Kommunikationsoffiziers: Wenn wir uns zu unsicher fühlen, können wir uns ja mit all den anderen Expeditionen, die hier herum fliegen, zusammen tun.'));

        message = $($(messages[key - 1]).find('td')).html();
        expeditionType = 'UNKNOWN';
        expeditionSize = null;

        if (message.match(/Deine Expedition hat einen kleinen Asteroidenschwarm entdeckt, aus dem einige Ressourcen gewonnen werden können./)
            || message.match(/Auf einem abgelegenen Planetoiden wurden einige leicht zugängliche Ressourcenfelder gefunden und erfolgreich Rohstoffe gewonnen./)
            || message.match(/Deine Expedition stieß auf sehr alte Raumschiffwracks einer längst vergangenen Schlacht. Einzelne Komponenten konnte man bergen und recyceln./)
            || message.match(/Die Expedition stieß auf einen radioaktiv verstrahlten Planetoiden mit hochgiftiger Atmosphäre. Jedoch ergaben Scans, dass dieser Planetoid sehr rohstoffhaltig ist. Mittels automatischer Drohnen wurde versucht, ein Maximum an Rohstoffen zu gewinnen./)
        ) {
            $($(obj).find('td')[3]).html('<span class="badge badge-ress">Ress (klein)</span>');
            expeditionType = 'RESOURCE';
            expeditionSize = 'SMALL';
        }

        if (message.match(/Deine Expedition fand einen uralten, voll beladenen, aber menschenleeren Frachterkonvoi. Einige Ressourcen konnten geborgen werden./)
            || message.match(/Auf einem kleinen Mond mit eigener Atmosphäre fand deine Expedition große Rohstoffvorkommen. Die Bodencrews sind dabei diese natürlichen Schätze zu heben./)
            || message.match(/Wir haben einen kleinen Konvoi ziviler Schiffe getroffen, die dringend Nahrung und Medikamente benötigten. Im Austausch dafür erhielten wir eine ganze Menge nützlicher Ressourcen./)
        ) {
            $($(obj).find('td')[3]).html('<span class="badge badge-ress">ress (mittel)</span>');
            expeditionType = 'RESOURCE';
            expeditionSize = 'MEDIUM';
        }

        if (message.match(/Deine Expeditionsflotte meldet den Fund eines riesigen Alien-Schiffswracks. Mit der Technologie konnten sie zwar nichts anfangen, aber das Schiff ließ sich in seine Einzelteile zerlegen und dadurch konnte man wertvolle Rohstoffe gewinnen./)
            || message.match(/Ein Mineraliengürtel um einen unbekannten Planeten enthielt Unmengen an Rohstoffen. Die Expeditionsflotte meldet volle Lager!/)
        ) {
            $($(obj).find('td')[3]).html('<span class="badge badge-ress">ress (groß)</span>');
            expeditionType = 'RESOURCE';
            expeditionSize = 'LARGE';
        }

        if (message.match(/Wir sind auf die Überreste einer Vorgängerexpedition gestoßen! Unsere Techniker schauen, ob sie einige der Wracks wieder Flugfähig bekommen/)
            || message.match(/Wir haben eine verlassene Piratenbasis gefunden. Im Hangar liegen noch einige alte Schiffe. Unsere Techniker schauen nach, ob einige davon noch zu gebrauchen sind./)
            || message.match(/Unsere Expedition fand einen Planeten, der wohl durch anhaltende Kriege fast komplett zerstört wurde. In der Umlaufbahn trieben diverse Schiffswracks. Die Techniker versuchen, einige davon zu reparieren. Vielleicht erhalten wir so auch Information darüber, was hier geschehen ist./)
            || message.match(/Deine Expedition ist auf eine alte Sternenfestung gestoßen, die wohl seit Ewigkeiten verlassen ist. Im Hangar der Festung wurden ein paar Schiffe gefunden. Die Techniker schauen, ob sie einige davon wieder flott bekommen./)
        ) {
            $($(obj).find('td')[3]).html('<span class="badge badge-ships">Schiffe (klein)</span>');
            $($(messages[key - 1]).find('td')).html(message.replace(/([ a-zA-ZüöäÜÖÄß]+)\: ([.0-9]+)/g, '<span style="color: ' + $this.colors.red() + ';">$1: $2</span>'));
            expeditionType = 'FLEET';
            expeditionSize = 'SMALL';
        }

        if (message.match(/Wir haben die Reste einer Armada gefunden. Die Techniker der Expeditionsflotte haben sich sofort auf die halbwegs intakten Schiffe begeben und versuchen, diese wieder instandzusetzen./)
            || message.match(/Unsere Expedition stieß auf eine alte, automatische Schiffswerft. Einige Schiffe sind noch in der Produktionsphase, und unsere Techniker versuchen, die Energieversorgung der Werft wiederherzustellen./)
        ) {
            $($(obj).find('td')[3]).html('<span class="badge badge-ships">Schiffe (mittel)</span>');
            $($(messages[key - 1]).find('td')).html(message.replace(/([ a-zA-ZüöäÜÖÄß]+)\: ([.0-9]+)/g, '<span style="color: ' + $this.colors.red() + ';">$1: $2</span>'));
            expeditionType = 'FLEET';
            expeditionSize = 'MEDIUM';
        }

        if (message.match(/Wir haben einen riesigen Raumschiffsfriedhof gefunden. Einigen Technikern der Expeditionsflotte ist es gelungen, das eine oder andere Schiff wieder in Betrieb zu nehmen./)
            || message.match(/Wir haben einen Planeten mit Resten einer Zivilisation entdeckt. Aus dem Orbit ist noch ein riesiger Raumbahnhof zu erkennen, der als einziges Gebäude noch intakt ist. Einige unserer Techniker und Piloten haben sich auf die Oberfläche begeben um nachzuschauen, ob ein paar der dort abgestellten Schiffe noch zu gebrauchen sind./)
        ) {
            $($(obj).find('td')[3]).html('<span class="badge badge-ships">Schiffe (groß)</span>');
            $($(messages[key - 1]).find('td')).html(message.replace(/([ a-zA-ZüöäÜÖÄß]+)\: ([.0-9]+)/g, '<span style="color: ' + $this.colors.red() + ';">$1: $2</span>'));
            expeditionType = 'FLEET';
            expeditionSize = 'LARGE';
        }

        if (message.match(/Außer einiger kurioser, kleiner Tierchen von einem unbekannten Sumpfplaneten, bringt diese Expedition nichts Aufregendes von ihrer Reise mit./)
            || message.match(/Deine Expedition hat wunderschöne Bilder einer Supernova gemacht. Wirklich neue Erkenntnisse hat diese Expedition jedoch nicht gebracht. Aber man hat gute Chancen auf den Bestes-Bild-Des-Universums-Wettbewerb in diesem Jahr./)
            || message.match(/Ein seltsames Computervirus legte kurz nach Verlassen des Sonnensystems die Navigation lahm. Dies führte dazu, dass die gesamte Expeditionsflotte die ganze Zeit im Kreis flog. Überflüssig zu sagen, dass die Expedition nicht besonders erfolgreich war./)
            || message.match(/Eine Lebensform aus reiner Energie hat dafür gesorgt, dass sämtliche Expeditionsmitglieder tagelang auf die hypnotischen Muster auf den Bildschirmen starrten. Als endlich die Meisten wieder klar im Kopf geworden waren, musste die Expedition aufgrund von akutem Deuterium-Mangel allerdings abgebrochen werden./)
            || message.match(/Nun, zumindest weiß man jetzt, dass rote Anomalien der Klasse 5 nicht nur chaotische Auswirkungen auf die Schiffssysteme haben, sondern auch massive Halluzinationen bei der Crew auslösen können. Viel mehr hat diese Expedition aber nicht gebracht./)
            || message.match(/Trotz der ersten, vielversprechenden Scans dieses Sektors kommen wir leider mit leeren Händen zurück./)
            || message.match(/Vielleicht hätte man den Geburtstag des Captains nicht auf diesem abgelegenen Planeten feiern sollen. Ein fieses Dschungelfieber hat große Teile der Crew gezwungen die Expedition in der Krankenstation zu begleiten. Der akute Personalausfall führte dazu, dass die Expedition scheiterte./)
            || message.match(/Deine Expedition hat, wortwörtlich, mit der Leere des Alls Bekanntschaft gemacht. Es gab nicht einmal einen kleinen Asteroiden, oder Strahlung, oder Partikel, oder irgendetwas, dass diese Expedition aufregend gestaltet hätte/)
            || message.match(/Ein Reaktorfehler des Führungsschiffes hätte beinahe die gesamte Expedition vernichtet. Zum Glück waren die Techniker mehr als fähig und konnten das Schlimmste verhindern. Die Reparatur nahm jedoch soviel Zeit in Anspruch, dass die Expedition unverrichteter Dinge wieder zurückkehrte./)
            || message.match(/Es konnten keine Schiffe repariert werden./)
        ) {
            $($(obj).find('td')[3]).html('<span class="badge badge-nothing">nichts</span>');
            expeditionType = 'NOTHING';
            expeditionSize = null;
        }

        if (message.match(/Eine unvorhergesehene Rückkopplung in den Energiespulen der Antriebsaggregate beschleunigte den Rücksprung der Expedition, so dass sie nun früher als erwartet zurückkehrt. Ersten Meldungen zufolge hat sie jedoch nichts Spannendes zu berichten./)
            || message.match(/Der etwas wagemutige neue Kommandant nutzte ein instabiles Wurmloch, um den Rückflug zu verkürzen – mit Erfolg! Jedoch hat die Expedition selbst keine neuen Erkenntnisse gebracht./)
            || message.match(/Deine Expedition meldet keinen Besonderheiten in dem erforschten Sektor. Jedoch geriet die Flotte beim Rücksprung in einen Sonnenwind. Dadurch wurde der Sprung ziemlich beschleunigt. Deine Expedition kehrt nun etwas früher nach Hause./)
        ) {
            $($(obj).find('td')[3]).html('<span class="badge badge-nothing">nichts (schnell)</span>');
            expeditionType = 'NOTHING_FAST';
            expeditionSize = null;
        }

        if (message.match(/Ein böser Patzer des Navigators führte zu einer Fehlkalkulation beim Sprung der Expedition. Nicht nur landete die Flotte an einem völlig falschen Ort, auch der Rückweg nahm nun erheblich mehr Zeit in Anspruch./)
            || message.match(/Aus bisher unbekannten Gründen, ging der Sprung der Expeditionsflotte völlig daneben. Beinahe wäre man im Herzen einer Sonne herausgekommen. Zum Glück ist man in einem bekannten System gelandet, jedoch wird der Rücksprung länger dauern als ursprünglich gedacht./)
            || message.match(/Das neue Navigationsmodul hat wohl doch noch mit einigen Bugs zu kämpfen. Nicht nur ging der Sprung der Expeditionsflotte in die völlig falsche Richtung, auch wurde das gesamte Deuterium verbraucht, wobei der Sprung der Flotte nur knapp hinter dem Mond des Startplaneten endete. Etwas enttäuscht kehrt die Expedition nun auf Impuls zurück. Dadurch wird die Rückkehr wohl ein wenig verzögert./)
            || message.match(/Deine Expedition geriet in einen Sektor mit verstärkten Partikelstürmen. Dadurch überluden sich die Energiespeicher der Flotte und bei sämtlichen Schiffen fielen die Hauptsysteme aus. Deine Mechaniker konnten das Schlimmste verhindern, jedoch wird die Expedition nun mit einiger Verspätung zurückkehren./)
            || message.match(/Das Führungsschiff deiner Expeditionsflotte kollidierte mit einem fremden Schiff, das ohne Vorwarnung direkt in die Flotte sprang. Das fremde Schiff explodierte und die Schäden am Führungsschiff waren beachtlich. Sobald die gröbsten Reparaturen abgeschlossen sind, werden sich deine Schiffe auf den Rückweg machen, da in diesem Zustand die Expedition nicht fortgeführt werden kann./)
            || message.match(/Der Sternwind eines roten Riesen verfälschte den Sprung der Expedition dermaßen, dass es einige Zeit dauerte, den Rücksprung zu berechnen. Davon abgesehen gab es in dem Sektor, in dem die Expedition herauskam, nichts außer der Leere zwischen den Sternen./)
        ) {
            $($(obj).find('td')[3]).html('<span class="badge badge-nothing">nichts (langsam)</span>');
            expeditionType = 'NOTHING_SLOW';
            expeditionSize = null;
        }

        if (message.match(/Ein paar anscheinend sehr verzweifelte Weltraumpiraten haben versucht, unsere Expeditionsflotte zu kapern./)
            || message.match(/Einige primitive Barbaren greifen uns mit Raumschiffen an, die nicht einmal ansatzweise die Bezeichnung Raumschiff verdient haben. Sollte der Beschuss ernst zu nehmende Ausmaße annehmen, sehen wir uns gezwungen das Feuer zu erwidern./)
            || message.match(/Wir haben ein paar Funksprüche sehr betrunkener Piraten aufgefangen. Anscheinend sollen wir überfallen werden./)
            || message.match(/Wir mussten uns gegen einige Piraten wehren, die zum Glück nicht allzu zahlreich waren./)
            || message.match(/Unsere Expeditionsflotte meldet, dass ein gewisser Moa Tikarr und seine wilde Meute die bedingungslose Kapitulation unserer Flotte verlangen. Sollten sie Ernst machen, werden sie feststellen müssen, dass sich unsere Schiffe durchaus zu wehren wissen./)
        ) {
            $($(obj).find('td')[3]).html('<span class="badge badge-fight">Piraten (klein)</span>');
            expeditionType = 'PIRATES';
            expeditionSize = 'SMALL';
        }

        if (message.match(/Deine Expeditionsflotte hatte ein unschönes Zusammentreffen mit einigen Weltraumpiraten./)
            || message.match(/Wir sind in den Hinterhalt einiger Sternen-Freibeuter geraten! Ein Kampf war leider unvermeidlich./)
            || message.match(/Der Hilferuf, dem die Expedition folgte, stellte sich als böse Falle einiger arglistiger Sternen-Freibeuter heraus. Ein Gefecht war unvermeidlich./)
        ) {
            $($(obj).find('td')[3]).html('<span class="badge badge-fight">Piraten (mittel)</span>');
            expeditionType = 'PIRATES';
            expeditionSize = 'MEDIUM';
        }

        if (message.match(/Die aufgefangenen Signale stammten nicht von Fremdwesen, sondern von einer geheimen Piratenbasis! Die Piraten waren von unserer Anwesenheit in ihrem Sektor nicht besonders begeistert./)
            || message.match(/Die Expeditionsflotte meldet schwere Kämpfe mit nicht-identifizierten Piratenschiffen!/)
            || message.match(/Wir haben gerade eine dringende Nachricht vom Expeditionskommandanten erhalten: "Sie kommen auf uns zu! Sie sind aus dem Hyperraum gesprungen, zum Glück sind es nur Piraten, wir haben also eine Chance, wir werden kämpfen!"/)
        ) {
            $($(obj).find('td')[3]).html('<span class="badge badge-fight">Piraten (groß)</span>');
            expeditionType = 'PIRATES';
            expeditionSize = 'LARGE';
        }

        if (message.match(/Deine Expeditionsflotte hatte einen nicht besonders freundlichen Erstkontakt mit einer unbekannten Spezies./)
            || message.match(/Einige fremdartig anmutende Schiffe haben ohne Vorwarnung die Expeditionsflotte angegriffen!/)
            || message.match(/Unsere Expedition wurde von einer kleinen Gruppe unbekannter Schiffe angegriffen!/)
            || message.match(/Die Expeditionsflotte meldet Kontakt mit unbekannten Schiffen. Die Funksprüche sind nicht entschlüsselbar, jedoch scheinen die fremden Schiffe ihre Waffen zu aktivieren./)
        ) {
            $($(obj).find('td')[3]).html('<span class="badge badge-fight">Aliens (klein)</span>');
            expeditionType = 'ALIENS';
            expeditionSize = 'SMALL';
        }

        if (message.match(/Eine unbekannte Spezies greift unsere Expedition an!/)
            || message.match(/Deine Expeditionsflotte hat anscheinend das Hoheitsgebiet einer bisher unbekannten, aber äußerst aggressiven und kriegerischen Alienrasse verletzt./)
            || message.match(/Die Verbindung zu unserer Expeditionsflotte wurde kurzfristig gestört. Soweit wir die letzte Botschaft richtig entschlüsselt haben, steht die Flotte unter schwerem Feuer – die Aggressoren konnten nicht identifiziert werden./)
        ) {
            $($(obj).find('td')[3]).html('<span class="badge badge-fight">Aliens (mittel)</span>');
            expeditionType = 'ALIENS';
            expeditionSize = 'MEDIUM';
        }

        if (message.match(/Deine Expedition ist in eine Alien-Invasions-Flotte geraten und meldet schwere Gefechte!/)
            || message.match(/Ein großer Verband kristalliner Schiffe unbekannter Herkunft hält direkten Kollisionskurs mit unserer Expeditionsflotte. Wir müssen nun wohl vom Schlimmsten ausgehen./)
            || message.match(/Wir hatten ein wenig Schwierigkeiten, den Dialekt der fremden Rasse richtig auszusprechen. Unser Diplomat nannte versehentlich "Feuer!" statt "Frieden!"./)
        ) {
            $($(obj).find('td')[3]).html('<span class="badge badge-fight">Aliens (groß)</span>');
            expeditionType = 'ALIENS';
            expeditionSize = 'LARGE';
        }

        if (message.match(/Von der Expedition ist nur noch folgender Funkspruch übrig geblieben: Zzzrrt Oh Gott! Krrrzzzzt das zrrrtrzt sieht krgzzzz ja aus wie Krzzzzzzzztzzzz.../)
            || message.match(/Das Letzte, was von dieser Expedition noch gesendet wurde, waren einige unglaublich gut gelungene Nahaufnahmen eines sich öffnenden, schwarzen Loches./)
            || message.match(/Ein Kernbruch des Führungsschiffes führte zu einer Kettenreaktion, die in einer durchaus spektakulären Explosion die gesamte Expedition vernichtete./)
            || message.match(/Die Expeditionsflotte ist nicht mehr aus dem Sprung in den Normalraum zurückgekehrt. Unsere Wissenschaftler rätseln noch immer, was geschehen sein könnte, jedoch scheint die Flotte endgültig verloren zu sein./)
        ) {
            $($(obj).find('td')[3]).html('<span class="badge badge-black-hole">Schwarzes Loch</span>');
            expeditionType = 'BLACK_HOLE';
            expeditionSize = null;
        }

        postJSON('expeditions', {
            id: messageId,
            external_id: messageId,
            date_time: dateTime,
            type: expeditionType,
            size: expeditionSize,
            message
        }, function () {
        });
    }
};


/***/ }),

/***/ 896:
/***/ (() => {

window.PageOverview = function () {
    const $this = this;

    this.renderTime = new Date().getTime();

    this.isLoading = false;
    this.cacheKey = 'overviewData';
    this.container = null;
    this.request = null;
    this.fleetQueue = [];

    this.sumFleetMetal = 0;
    this.sumFleetCrystal = 0;
    this.sumFleetDeuterium = 0;

    this.init = function () {
        this.parseOwnAttacks();
        this.prepareHtml();
        this.analyzeFleetMovement();
        this.renderHtml();
        this.loadData();
        this.bindHotkeys();
    };

    this.bindHotkeys = function () {
        const mappingFilters = {
            i: 'filter_inactive',
            n: 'filter_noobs',
            u: 'filter_vacation',
            a: 'filter_alliance',
            s: 'filter_spy_report',
            k: 'filter_battle_report',
        };

        const mappingThresholds = {
            p: 'filter_score_enable',
            g: 'filter_score_building_enable',
            f: 'filter_score_science_enable',
            m: 'filter_score_fleet_enable',
            v: 'filter_score_defense_enable',
            i: 'filter_inactive_since_enable',
            k: 'filter_last_battle_report_enable',
            s: 'filter_last_spy_report_enable',
            q: 'filter_metal_enable',
            w: 'filter_crystal_enable',
            e: 'filter_deuterium_enable',
        };

        $(window).keypress(function (e) {
            const key = e.key.toLowerCase();
            let newValue = null;

            if ($('*:focus').length === 0) {
                if (!e.shiftKey) {
                    if (mappingFilters[key]) {
                        switch (getValue(mappingFilters[key])) {
                            case 'HIDE':
                                newValue = 'ONLY';
                                break;

                            case 'ONLY':
                                newValue = 'ALL';
                                break;

                            default:
                                newValue = 'HIDE';
                        }

                        setValue(mappingFilters[key], newValue)
                    }
                }

                // thresholds
                else {
                    if (mappingThresholds[key]) {
                        switch (getValue(mappingThresholds[key])) {
                            case '0':
                                newValue = '1';
                                break;

                            default:
                                newValue = '0';
                        }

                        setValue(mappingThresholds[key], newValue)
                    }
                }

                $this.renderHtml();
            }
        });
    }

    this.setLoading = function (value) {
        this.isLoading = value;
    };

    this.prepareHtml = function () {
        let infos;


        $($('content .infos')[1]).addClass('fleet-movement');
        $($('content .infos')[1]).html($($('content .infos')[1]).html().replace(/\&nbsp\;/, '')); // remove trailing space

        $('span.fleets').each(function (key, obj) {
            parentObj = $($(obj).parent());
            parentObj.html(parentObj.html().replace(/Eine deiner /, '').replace(/zum Planet/, 'zu').replace(/vom Planet/, 'von').replace(/von dem Planet/, 'von').replace(/den Planet/, '').replace(/vom Spieler/, 'von').replace(/ Eine/, 'Eine').replace(/ist im Orbit/, 'hält bei').replace(/(die|der) Position/, '').replace(/zuen/g, 'zu'));
        });

        $('span.fleets').each(function (key, obj) {
            parentObj = $($(obj).parent());
            parentObj.html(parentObj.html().replace(/Flotten/, 'Flotte'));
        });

        $('span.fleets').each(function (key, obj) {
            parentObj = $($(obj).parent());
            parentObj.html(parentObj.html().replace(/\. Mission\: /, '</span><span>'));
        });

        let parentObj;
        $('span.fleets').each(function (key, obj) {
            parentObj = $($(obj).parent());

            if (parentObj.html().search(/Verbandsangriff/) !== -1) {
                parentObj.find('br').remove();
                parentObj.html(parentObj.html().replace(/<span>(Verbandsangriff|Angreifen)<\/span>/g, ''));
                parentObj.append('<span style="color: rgb(51, 153, 102)">AKS</span>');
                parentObj.html(parentObj.html().replace(/Eine deiner /g, '').replace(/zum Planet/g, 'zu').replace(/vom Planet/g, 'von').replace(/von dem Planet/g, 'von').replace(/den Planet/g, '').replace(/vom Spieler/g, 'von').replace(/Eine /g, '').replace(/ist im Orbit/g, 'hält bei').replace(/(die|der) Position/g, '').replace(/\. Mission\: Angreifen/g, '').replace(/\. Mission\: Verbandsangriff/g, '').replace(/zuen/g, 'zu'));

                $(parentObj.find('.flight')).each(function (skey, sobj) {
                    if (skey > 0) {
                        $(sobj).detach().appendTo(parentObj.find('span')[1]);
                    }
                });

                $(parentObj.find('span')[1]).html($(parentObj.find('span')[1]).html().replace(/span/g, 'div'));
            }
        });

        $('span.fleets').each(function (key, obj) {
            var end = new Date($(obj).attr('data-fleet-end-time') * 1000);

            $(obj).parent().append(' <span>' + end.toLocaleTimeString("de-DE") + '</span>');
        });

        // parse planet queue & infos
        infos = $('.infos')[2].innerHTML.split('<br>');

        const timestamp = Math.round(new Date().getTime() / 1000);
        const queues = {
            building: $('.infos')[2].innerHTML.match(/Gebäude\: <\/a\>([^<>]+)\<br\>\<([^>]+)data\-time\=\"([0-9]+)\"/m),
            research: $('.infos')[2].innerHTML.match(/Forschung\: <\/a\>([^<>]+)\<br\>\<([^>]+)data\-time\=\"([0-9]+)\"/m),
            hangar: $('.infos')[2].innerHTML.match(/Schiffswerft\: <\/a\>([^<>]+)\<br\>\<([^>]+)data\-time\=\"([0-9]+)\"/m)
        };

        $.each(queues, function (key, obj) {
            setValue(ownId + '_' + key + '_item', obj ? obj[1] : ''); // active queue item with level/amount
            setValue(ownId + '_' + key + '_timestamp', obj ? timestamp + parseInt(obj[3]) : ''); // end timestamp
        });

        const planetInfo = {
            image: null,
            fieldsUsed: infos.length >= 6 && infos[5].match(/bebaute Felder\"\>([0-9]+)\</),
            fieldsTotal: infos.length >= 6 && infos[5].match(/bebaubare Felder\"\>([0-9]+)\</),
            temperatureMin: infos.length >= 7 && infos[6].match(/von ([-0-9]+)\°/),
            temperatureMax: infos.length >= 7 && infos[6].match(/bis ([-0-9]+)\°/)
        };

        setValue(ownId + '_fieldsUsed', planetInfo.fieldsUsed ? planetInfo.fieldsUsed[1] : '');
        setValue(ownId + '_fieldsTotal', planetInfo.fieldsTotal ? planetInfo.fieldsTotal[1] : '');
        setValue(ownId + '_temperatureMin', planetInfo.temperatureMin ? planetInfo.temperatureMin[1] : '');
        setValue(ownId + '_temperatureMax', planetInfo.temperatureMax ? planetInfo.temperatureMax[1] : '');

        $('content').addClass('home'); // add home class
        this.container = $('.infos:last-child'); // container for hub overview
        const infosObj = $('.infos');

        $('.infos .planeto').remove(); // remove useless headlines
        infos = infosObj[0].innerHTML.split('<br>'); // prepare info gathering
        const admins = infos[1].split(/\:\:\&nbsp\;/);
        let html = '';

        html += '<table class="borderless" style="padding: 0; margin: 0"><tr><td class="text-left" width="50%" style="padding: 0">';
        html += '<table class="borderless">';
        html += '<tr>';
        html += '<td class="text-left" width="10%">Serverzeit</td>';
        html += '<td class="text-left">' + infos[0].replace(/Serverzeit \:/, '') + '</td>';
        html += '</tr>';
        html += '<tr>';
        html += '<td class="text-left">Admins</td>';
        html += '<td class="text-left">' + (admins && admins.length > 1 ? admins[1] : '---').replace(/\&nbsp\;•/, ',') + '</td>';
        html += '</tr>';
        html += '<tr>';
        html += '<td class="text-left">Punkte</td>';
        html += '<td class="text-left">' + infos[3].replace(/Punkte /, '') + '</td>';
        html += '</tr>';
        html += '<tr>';
        html += '<td class="text-left">Live</td>';
        html += '<td class="text-left"><span id="live-score"></span> <span id="live-score-diff"></span></td>';
        html += '</tr>';
        html += '</table>';
        html += '<a style="margin-left: 12px; margin-top: 10px; color: #888; font-size: 10px;" href="javascript:void(0)" onclick="return Dialog.PlanetAction();">Planet umbenennen/aufgeben</a>';
        html += '</td><td style="padding: 0"><canvas id="playerChart" style="height: 100px; width: 100%"></canvas><canvas id="playerChartBar" style="height: 75px; width: 100%"></canvas></td></table>';
        $(infosObj[0]).html(html);

        displayChart();

        // generate planet overview (NEW)
        html = '<table class="noMargin">';
        html += '<tr>';
        html += '<th width="20%">Planet</th>';
        html += '<th class="text-right">Gebäude</th>';
        html += '<th class="text-right">Forschung</th>';
        html += '<th class="text-right">Hangar</th>';
        html += '<th class="text-right">Metall</th>';
        html += '<th class="text-right">Kristall</th>';
        html += '<th class="text-right">Deuterium</th>';
        html += '<th class="text-right">Energie</th>';
        html += '<th class="text-right">Beobachtung</th>';
        html += '</tr>';

        let coords, name, time, tooltip;

        $('#planetSelector option').each(function (key, obj) {
            coords = getCoordinates(obj.innerHTML);
            name = obj.innerHTML.split('[');

            html += '<tr>';

            tooltip = '';
            time = getValue(coords[0] + '_fieldsTotal');
            value = getValue(coords[0] + '_fieldsUsed');
            tooltip += (value && value !== typeof (undefined) && value !== '' ? value : '---');
            tooltip += ' / ';
            tooltip += (time && time !== typeof (undefined) && time !== '' ? time : '---') + ' Felder<br>';

            time = getValue(coords[0] + '_temperatureMax');
            value = getValue(coords[0] + '_temperatureMin');
            tooltip += (value && value !== typeof (undefined) && value !== '' ? value + '°C' : '---');
            tooltip += ' bis ';
            tooltip += (time && time !== typeof (undefined) && time !== '' ? time + '°C' : '---');

            // planet
            html += '<td style="white-space: nowrap" class="text-left tooltip" data-tooltip-content="' + tooltip + '">' + coords[0] + ' (' + name[0].replace('\ (Mond\) ', '').substring(0, name[0].length - 1) + ')</td>';

            // buildings
            time = getValue(coords[0] + '_building_timestamp');
            html += '<td class="text-right" title="' + (getValue(coords[0] + '_building_item') || '---') + '">' + (time && time !== typeof (undefined) ? '<span class="timer" data-time="' + (parseInt(time) - Math.round(new Date().getTime() / 1000)) + '"></span>' : '---') + '</td>';

            // research
            if (key === 0) {
                time = getValue(coords[0] + '_research_timestamp');
                value = getValue(coords[0] + '_research_item');
                html += '<td class="text-right" title="' + (value && value !== typeof (undefined) && value !== '' ? value : '---') + '">' + (time && time !== typeof (undefined) ? '<span class="timer" data-time="' + (parseInt(time) - Math.round(new Date().getTime() / 1000)) + '"></span>' : '---') + '</td>';
            } else {
                html += '<td class="disabled text-right" style="color: #333">---</td>';
            }

            // hangar
            time = getValue(coords[0] + '_hangar_timestamp');
            value = getValue(coords[0] + '_hangar_item');
            html += '<td class="text-right" title="' + (value && value !== typeof (undefined) && value !== '' ? value : '---') + '">' + (time && time !== typeof (undefined) ? '<span class="timer" data-time="' + (parseInt(time) - Math.round(new Date().getTime() / 1000)) + '"></span>' : '---') + '</td>';

            // resources
            html += '<td class="text-right"><span data-tooltip-content="' + numberFormat(Math.round(getInt(getValue(coords[0] + '_production_metal')) / 86400 * 3600)) + ' / Stunde<br>Limit: ' + numberFormat(getInt(getValue(coords[0] + '_limit_metal'))) + '" class="tooltip ress_metal_' + coords[0].replace(/\:/g, '_') + '"></span></td>';
            html += '<td class="text-right"><span data-tooltip-content="' + numberFormat(Math.round(getInt(getValue(coords[0] + '_production_crystal')) / 86400 * 3600)) + ' / Stunde<br>Limit: ' + numberFormat(getInt(getValue(coords[0] + '_limit_crystal'))) + '" class="tooltip ress_crystal_' + coords[0].replace(/\:/g, '_') + '"></span></td>';
            html += '<td class="text-right"><span data-tooltip-content="' + numberFormat(Math.round(getInt(getValue(coords[0] + '_production_deuterium')) / 86400 * 3600)) + ' / Stunde<br>Limit: ' + numberFormat(getInt(getValue(coords[0] + '_limit_deuterium'))) + '" class="tooltip ress_deuterium_' + coords[0].replace(/\:/g, '_') + '"></span></td>';
            html += '<td class="text-right" style="color: ' + getRgb(parseInt(getValue(coords[0] + '_production_energy')) > 0 ? cGreen : cRed) + '">' + (getValue(coords[0] + '_production_energy') || '---') + '</td>';

            // notifications
            dateTime = new PlanetResourceNotification().getFinishTime(coords[0]);

            if (!dateTime) {
                html += '<td class="text-right">---</td>';
            } else {
                html += '<td class="text-right tooltip" data-tooltip-content="<b>Es fehlen:</b></br>';
                html += new PlanetResourceNotification().getDiffForResource(coords[0], 'metal') + ' / ' + numberFormat(getInt(getValue(coords[0] + '_notification_metal'))) + ' Metall<br>';
                html += new PlanetResourceNotification().getDiffForResource(coords[0], 'crystal') + ' / ' + numberFormat(getInt(getValue(coords[0] + '_notification_crystal'))) + ' Kristall<br>';
                html += new PlanetResourceNotification().getDiffForResource(coords[0], 'deuterium') + ' / ' + numberFormat(getInt(getValue(coords[0] + '_notification_deuterium'))) + ' Deuterium';
                html += '"><i class="fa fa-bell-slash"  onclick="(new PlanetResourceNotification().removeNotification(\'' + coords[0] + '\'))"></i> <span class="notification-timer" data-timestamp="' + dateTime + '">' + formatTimeDiff(dateTime) + '</span></td>';
            }

            html += '</tr>';
        });

        html += '<tr>';
        html += '<td class="text-left">Flotten</td>';
        html += '<td class="text-right" style="color: #888">---</td>';
        html += '<td class="text-right" style="color: #888">---</td>';
        html += '<td class="text-right" style="color: #888">---</td>';
        html += '<td class="text-right tooltip" id="infoFleetMetal"><span id="sumFleetMetal"></span></td>';
        html += '<td class="text-right tooltip" id="infoFleetCrystal"><span id="sumFleetCrystal"></span></td>';
        html += '<td class="text-right tooltip" id="infoFleetDeuterium"><span id="sumFleetDeuterium"></span></td>';
        html += '<td class="text-right" style="color: #888">---</td>';
        html += '<td class="text-right" style="color: #888">---</td>';
        html += '</tr>';

        html += '<tr>';
        html += '<td class="text-left">Summe</td>';
        html += '<td class="text-right" style="color: #888">---</td>';
        html += '<td class="text-right" style="color: #888">---</td>';
        html += '<td class="text-right" style="color: #888">---</td>';
        html += '<td class="text-right tooltip" id="infoMetal"><span id="sumMetal"></span> <small style="color: #888">/ <span id="sumLimitMetal"></span></small></td>';
        html += '<td class="text-right tooltip" id="infoCrystal"><span id="sumCrystal"></span> <small style="color: #888">/ <span id="sumLimitCrystal"></span></small></td>';
        html += '<td class="text-right tooltip" id="infoDeuterium"><span id="sumDeuterium"></span> <small style="color: #888">/ <span id="sumLimitDeuterium"></span></small></td>';
        html += '<td class="text-right" style="color: #888">---</td>';
        html += '<td class="text-right" style="color: #888">---</td>';
        html += '</tr>';

        html += '</table>';

        $(infosObj[2]).html(html);
    };

    this.checkVersion = function () {
        var data = this.getData();

        if (data && isNewerVersionAvailable(data.version)) {
            $('body').prepend('<div style="padding: 10px 15px; background: ' + getRgb(cRed) + '; color: ' + getRgb(cWhite) + '; z-index: 10000; position: fixed; top: 0; left: 0; right: 0;" id="progress-bar"><i class="fa fa-exclamation-triangle"></i>  Eine neue Plugin-Version v<a href="https://pr0game-hub.eskju.net/download/releases/pr0game-hub.v' + data.version + '.js" target="_blank" download>' + data.version + '</a> ist verf&uuml;gbar.</div>');
        }
    };

    this.parseOwnAttacks = function () {
        let coordinates = null;

        $('#hidden-div2 > li > span:nth-child(2)').each(function (key, obj) {
            obj = $(obj);

            if (obj.hasClass('ownattack')) {
                coordinates = $(obj).find('.ownattack');

                $this.fleetQueue.push({
                    from: $(coordinates[1]).html().replace(/\[(.*)\]/, '$1'),
                    to: $(coordinates[2]).html().replace(/\[(.*)\]/, '$1'),
                    type: obj.attr('class'),
                    time: $(obj).parent().find('span.fleets')
                });
            }

            if (obj.hasClass('ownespionage')) {
                coordinates = $(obj).find('.ownespionage');

                $this.fleetQueue.push({
                    from: $(coordinates[1]).html().replace(/\[(.*)\]/, '$1'),
                    to: $(coordinates[2]).html().replace(/\[(.*)\]/, '$1'),
                    type: obj.attr('class'),
                    time: $(obj).parent().find('span.fleets')
                });
            }
        });
    };

    this.loadData = function () {
        if (this.request !== null) {
            this.request.abort();
        }

        const ownPlanets = [];
        let coords;
        $('#planetSelector option').each(function (key, obj) {
            coords = getCoordinates(obj.innerHTML);
            ownPlanets.push(coords[0]);
        });

        this.setLoading(true);
        this.debugTime();
        this.request = postJSON('players/overview', {
            galaxy: ownGalaxy,
            system: ownSystem,
            planet: ownPlanet,
            ownPlanets: ownPlanets,
            show_galaxy: getValue('show_galaxy_enable') === '1' ? (getValue('show_galaxy_value') || ownGalaxy) : ownGalaxy,
            order_by: getValue('orderBy'),
            order_direction: getValue('orderDirection'),
            date_for_humans: (getValue('date_for_humans') || '0') === '1'
        }, function (response) {
            $this.debugTime('POST `players/overview`');
            setValue($this.cacheKey, response.responseText);
            $this.setLoading(false);
            $this.checkVersion();
            $this.renderHtml();
        }, false);
    };

    this.getData = function () {
        var content = getValue(this.cacheKey);

        try {
            var fn = $this.sortData;
            var data = JSON.parse(content);

            // sort player list
            data.players = data.players.sort(fn);

            return data;
        } catch (msg) {
            return {
                players: [],
                outdated_ids: [],
                version: version,
                player: null
            };
        }
    };

    this.bindFilters = function () {
        $('.phFilter').each(function (key, obj) {
            $(obj).on('change', function () {
                if ($(this).attr('type') === 'checkbox') {
                    savePhOption($(this).attr('data-alias'), $(this)[0].checked ? '1' : '0');
                } else {
                    savePhOption($(this).attr('data-alias'), $(this).val());
                }
            });
        });
    };

    this.bindHeadlineSort = function () {
        $('.sortable').each(function (key, obj) {
            $(obj).css('cursor', 'pointer');

            if ($(obj).attr('data-sort') == (getValue('orderBy') || 'distance')) {
                if ((getValue('orderDirection') || 'ASC') === 'ASC') {
                    $(obj).prepend('<i class="fa fa-caret-up"></i> ');
                } else {
                    $(obj).prepend('<i class="fa fa-caret-down"></i> ');
                }
            }

            $(obj).click(function () {
                $this.orderBy($(obj).attr('data-sort'), $(obj).attr('data-direction'));
                $this.renderHtml();
            });
        });
    };

    this.orderBy = function (orderBy, orderDirection) {
        if (orderBy === getValue('orderBy')) {
            orderDirection = getValue('orderDirection') === 'ASC' ? 'DESC' : 'ASC';
        }

        setValue('orderBy', orderBy);
        setValue('orderDirection', orderDirection);
    }

    this.sortData = function (a, b) {
        let property = getValue('orderBy') || 'distance';
        const invertSort = getValue('orderDirection') !== 'DESC' ? 1 : -1;

        const offsets = property.split('.');
        if (offsets.length === 2) {
            a = a[offsets[0]];
            b = b[offsets[0]];
            property = offsets[1];
        }

        let aVal = a[property] || '';
        let bVal = b[property] || '';

        if (property !== 'alliance_name' && property !== 'name') {
            aVal = getInt(aVal);
            bVal = getInt(bVal);
        } else {
            aVal = aVal.toLowerCase();
            bVal = bVal.toLowerCase();
        }

        return ((aVal < bVal) ? -1 : (aVal > bVal) ? 1 : 0) * invertSort;
    };

    this.applyRowStyles = function (response) {

    };

    this.bindSettingsLink = function () {
        $('#showSettings').click(function () {
            setValue('hideSettings', '0');
            $this.renderHtml();
        });

        $('#hideSettings').click(function () {
            setValue('hideSettings', '1');
            $this.renderHtml();
        });
    };

    this.bindSpyLinks = function () {
        $('.spio-link').click(function () {
            $.getJSON("game.php?page=fleetAjax&ajax=1&mission=6&planetID=" + $(this).attr('data-id'), function (data) {
                showMessage(data.mess, (data.code === 600 ? 'success' : 'danger'));
            });
        });
    };

    this.renderHtml = function () {
        $this.debugTime();
        var html = '<table id="hubOverview" width="100%" style="max-width: 100% !important"><tr>';
        var response = this.getData();

        updateConfigVars();

        if (!response) {
            return;
        }

        html += '<th style="text-align: center;">#</th>';
        html += '<th class="sortable" data-sort="alliance_name" data-direction="ASC">Ally</th>';
        html += '<th class="sortable" data-sort="player.name" data-direction="ASC">Spieler</th>';
        html += '<th style="text-align: center;" colspan="3">';
        html += '<span class="sortable" data-sort="distance" title="Distanz" data-direction="ASC" id="sortByDistance"><i class="fa fa-map-marker-alt"></i></span>';
        html += '&nbsp;';
        html += '<span class="sortable" data-sort="system" title="System" data-direction="ASC" id="sortBySystem"><i class="fa fa-sort-numeric-down"></i></span>';
        html += '</th>';
        html += '<th class="sortable" data-sort="player.score" title="Punkte" data-direction="DESC" style="text-align: center; color: ' + getRgb(cBlue) + '" id="sortByScore"><i class="fa fa-chart-line"></i></th>';
        html += '<th class="sortable" data-sort="score_building" title="Gebaeudepunkte" data-direction="DESC" style="text-align: center; color: ' + getRgb(cGreen) + '" id="sortByScoreBuilding"><i class="fa fa-industry"></i></th>';
        html += '<th class="sortable" data-sort="player.score_science" title="Forschungspunkte" data-direction="DESC" style="text-align: center; color: ' + getRgb(cPink) + '" id="sortByScoreScience"><i class="fa fa-flask"></i></th>';
        html += '<th class="sortable" data-sort="score_military" title="Militaerpunkte" data-direction="DESC" style="text-align: center; color:' + getRgb(cRed) + '" id="sortByScoreMilitary"><i class="fa fa-fighter-jet"></i></th>';
        html += '<th class="sortable" data-sort="score_defense" title="Verteidigungspunkte" data-direction="DESC" style="text-align: center; color: ' + getRgb(cYellow) + '" id="sortByScoreDefense"><i class="fa fa-shield"></i></th>';
        html += '<th class="sortable" data-sort="last_battle_report_hours" title="Letzter Angriff" data-direction="ASC" style="text-align: right;"><i class="fa fa-crosshairs"></i></th>';
        html += '<th class="sortable" data-sort="last_spy_report_hours" title="Letze Spionage" data-direction="DESC" style="text-align: right;"><i class="fa fa-user-secret"></i></th>';
        html += '<th style="text-align: center;">Actions</th>';
        html += '<th class="sortable" data-sort="last_spy_metal" data-direction="DESC" title="Metall (Letzte Spionage)" style="text-align: right;" id="sortBySpioMet">MET</th>';
        html += '<th class="sortable" data-sort="last_spy_crystal" data-direction="DESC" title="Kristall (Letzte Spionage)" style="text-align: right;" id="sortBySpioCry">CRY</th>';
        html += '<th class="sortable" data-sort="last_spy_deuterium" data-direction="DESC" title="Deuterium (Letzte Spionage)" style="text-align: right;" id="sortBySpioDeu">DEU</th></tr>';

        if (response.player !== null) {
            ownPlayer = response.player;
        }

        if (response.live_score) {
            $('#live-score').html(numberFormat(response.live_score));
            $('#live-score-diff').html('(' + (response.live_score_diff > 0 ? '+' : '') + numberFormat(response.live_score_diff) + ')');
            $('#live-score-diff').css('color', getRgb(response.live_score_diff > 0 ? cGreen : cRed));
        }

        let counter = 0;
        let playerRowStyle;
        let playerScoreStyle;
        let playerScoreBuildingStyle;
        let playerScoreScienceStyle;
        let playerScoreMilitaryStyle;
        let playerScoreDefenseStyle;
        let playerLinkStyle;

        $(response.players).each(function (key, obj) {
            if (filterTableRow(obj, response.player)) {
                counter++;

                playerRowStyle = getPlayerRowStyle(obj.player, response.player.score);
                playerScoreStyle = getPlayerScoreStyle(obj.player, response.player);
                playerScoreBuildingStyle = getPlayerScoreBuildingStyle(obj.player, response.player);
                playerScoreScienceStyle = getPlayerScoreScienceStyle(obj.player, response.player);
                playerScoreMilitaryStyle = getPlayerScoreMilitaryStyle(obj.player, response.player);
                playerScoreDefenseStyle = getPlayerScoreDefenseStyle(obj.player, response.player);
                playerLinkStyle = getPlayerRowTdStyle(obj.player, response.player.score, response.player);

                html += '<tr id="row' + obj.id + '" style="background: ' + (playerRowStyle.background || 'transparent') + '">';
                html += '<td>' + counter + '</td>';
                html += '<td style="text-align: left; max-width: 50px"><div style="max-width: 50px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">' + (obj.alliance_name || '---') + '</div></td>';
                html += '<td style="text-align: left; max-width: 100px"><div style="max-width: 100px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">';

                if (obj.inactive_since !== null && obj.inactive_since < 48) {
                    html += '<span style="padding: 2px 5px; border-radius: 2px; background: ' + getRgb(cRed) + '; color: ' + getRgb(cWhite) + '; border-radius: 2px; margin-right: 5px; font-size: 10px;">' + obj.inactive_since + 'H</span>';
                }

                html += '<a style="color: ' + (playerLinkStyle.color || '') + '" href="/game.php?page=playerCard&id=' + obj.player.id + '">' + obj.player.name + (obj.type === 'MOON' ? ' [MOND]' : '') + '</a></div></td>';
                html += '<td id="row' + obj.id + 'Galaxy">' + (obj.galaxy || '---') + '</td>';
                html += '<td id="row' + obj.id + 'System"><a style="color: ' + (playerLinkStyle.color || '') + '" href="/game.php?page=galaxy&galaxy=' + (obj.galaxy || '') + '&system=' + (obj.system || '') + '">' + (obj.system || '---') + '</a></td>';
                html += '<td id="row' + obj.id + 'Planet">' + (obj.planet || '---') + '</td>';
                html += '<td id="row' + obj.id + 'Score" style="color: ' + (playerScoreStyle.color || '') + '">' + numberFormat(obj.player.score, true) + '</td>';
                html += '<td id="row' + obj.id + 'ScoreBuilding" style="color: ' + (playerScoreBuildingStyle.color || '') + '" title="Gesamt: ' + (obj.player.score_building !== null ? numberFormat((obj.player.score_building), false) : '???') + '">' + numberFormat(obj.score_building, true) + '</td>';
                html += '<td id="row' + obj.id + 'ScoreScience" style="color: ' + (playerScoreScienceStyle.color || '') + '">' + numberFormat(obj.player.score_science, true) + '</td>';
                html += '<td id="row' + obj.id + 'ScoreMilitary" style="color: ' + (playerScoreMilitaryStyle.color || '') + '" title="Gesamt: ' + (obj.player.score_military !== null ? numberFormat((obj.player.score_military), false) : '???') + '">' + numberFormat((obj.score_military), true) + '</td>';
                html += '<td id="row' + obj.id + 'ScoreDefense" style="color: ' + (playerScoreDefenseStyle.color || '') + '" title="Gesamt: ' + (obj.player.score_defense !== null ? numberFormat((obj.player.score_defense), false) : '???') + '">' + numberFormat((obj.score_defense), false) + '</td>';
                html += '<td style="text-align: right; white-space: nowrap">';

                var fleetQueueItemsDisplayed = 0;
                $.each($this.fleetQueue, function (i, fleetQueueItem) {
                    if (fleetQueueItem.to == obj.coordinates || fleetQueueItem.from == obj.coordinates) {
                        switch (fleetQueueItem.type) {
                            case 'flight ownattack':
                                html += '<div style="text-align: center; background: ' + getRgb(cRed) + '; margin-bottom: -1px; color: ' + getRgb(cWhite) + '; border-radius: 2px; padding: 2px 5px; font-size: 10px;">' + fleetQueueItem.time[0].outerHTML + '</div>';
                                fleetQueueItemsDisplayed++;
                                break;

                            case 'return ownattack':
                                html += '<div style="text-align: center; background: ' + getRgb(cBlack) + '; color: ' + getRgb(cRed) + '; outline: 1px solid ' + getRgb(cRed) + '; outline-offset: -1px; border-radius: 2px; padding: 2px 5px; font-size: 10px;">' + fleetQueueItem.time[0].outerHTML + '</div>';
                                fleetQueueItemsDisplayed++;
                                break;

                            case 'flight ownespionage':
                                html += '<div style="text-align: center; background: ' + getRgb(cYellow) + '; margin-bottom: -1px; color: ' + getRgb(cBlack) + '; border-radius: 2px; padding: 2px 5px; font-size: 10px;">' + fleetQueueItem.time[0].outerHTML + '</div>';
                                fleetQueueItemsDisplayed++;
                                break;

                            case 'return ownespionage':
                                html += '<div style="text-align: center; background: ' + getRgb(cBlack) + '; color: ' + getRgb(cYellow) + '; outline: 1px solid ' + getRgb(cYellow) + '; outline-offset: -1px; border-radius: 2px; padding: 2px 5px; font-size: 10px;">' + fleetQueueItem.time[0].outerHTML + '</div>';
                                fleetQueueItemsDisplayed++;
                                break;
                        }
                    }
                });

                html += (fleetQueueItemsDisplayed === 0 ? (obj.last_battle_report || '') : '');
                html += ' </td>';
                html += '<td style="text-align: right; cursor: pointer; white-space: nowrap" onclick="showSpyReportHistory(' + obj.galaxy + ', ' + obj.system + ', ' + obj.planet + ')">' + (obj.last_spy_report || '') + '</td>';
                html += '<td>';

                if (obj.external_id) {
                    html += '[<a style="color: ' + (playerLinkStyle.color || '') + '; cursor: pointer" class="spio-link" data-id="' + obj.external_id + '">S</a>]';
                } else {
                    html += ' [<a style="color: ' + (playerLinkStyle.color || '') + '; cursor: pointer" href="/game.php?page=fleetTable&galaxy=' + obj.galaxy + '&system=' + obj.system + '&planet=' + obj.planet + '&planettype=' + (obj.type === 'PLANET' ? 1 : 3) + '&target_mission=6">S</a>]';
                }

                html += ' [<a style="color: ' + (playerLinkStyle.color || '') + '; cursor: pointer" href="/game.php?page=fleetTable&galaxy=' + obj.galaxy + '&system=' + obj.system + '&planet=' + obj.planet + '&planettype=' + (obj.type === 'PLANET' ? 1 : 3) + '&target_mission=1">A</a>]';

                html += '</td>';
                html += '<td style="text-align: right;">' + numberFormat(obj.last_spy_metal, true) + '</td>';
                html += '<td style="text-align: right;">' + numberFormat(obj.last_spy_crystal, true) + '</td>';
                var ressSum = Math.ceil(getInt(obj.last_spy_metal) / 2 + getInt(obj.last_spy_crystal) / 2 + getInt(obj.last_spy_deuterium) / 2);
                html += '<td style="text-align: right;" title="' + Math.ceil(ressSum / 5000) + ' KT, ' + ressSum + ' raidable">' + numberFormat(obj.last_spy_deuterium, true) + '</td>';
                html += '</tr>';
            }
        });

        this.container.html(getOverviewHeader() + html + '</table>');
        this.bindSettingTabs();
        this.bindFilters();
        this.applyRowStyles(response);
        this.bindHeadlineSort();
        this.bindSettingsLink();
        this.bindSpyLinks();

        $this.debugTime('renderHTML');
    }

    this.analyzeFleetMovement = function () {
        let columns;
        let activities = [];
        let coordinates;
        let timeAndId;
        let id;
        let type;
        let isReturn;
        let resources;

        $('.fleet-movement ul li').each(function (key, obj) {
            columns = $($(obj).children());
            coordinates = $(columns[1]).html().match(/\[([:0-9]+)\](.*)\[([:0-9]+)\]/);
            timeAndId = $(columns[0]).attr('id').replace(/fleettime\_/, '');
            id = timeAndId.substring(10, timeAndId.length);
            type = $(columns[2]).find('a').length > 0 ? $($(columns[2]).find('a')).html() : $(columns[2]).html();
            isReturn = $(columns[1]).hasClass('return') || $(columns[1]).html().search(/hält bei/) !== -1;

            $(obj).attr('id', 'fleet' + id + '-' + ($(columns[1]).hasClass('return') || $(columns[1]).html().search(/hält bei/) !== -1 ? '1' : '0'));

            if (coordinates && coordinates.length > 0) {
                resources = $this.getResources($(columns[2]).find('span.textForBlind'));
                activities.push({
                    external_id: id, // fleet time
                    is_return: $(columns[1]).hasClass('return') || $(columns[1]).html().search(/hält bei/) !== -1, // if true try to assign an outbound flight by coords and timestamps
                    outbound_flight_id: $(columns[1]).hasClass('return') || $(columns[1]).html().search(/hält bei/) !== -1 ? id : null, // set by API; search for same departure time
                    timestamp_departure: null,
                    timestamp_arrival: parseInt($(columns[0]).attr('data-fleet-end-time')), // fleet_end_time
                    type: type, // e.g. 'attack', 'transport', ..
                    planet_start_coordinates: coordinates[1], // start-planet's coordinates
                    planet_target_coordinates: coordinates[3], // target-planet's coordinates
                    resources: resources, // resources carried
                    ships: $this.getShips($(columns[1]).find('span.textForBlind')), // ship amounts
                });

                if (type !== 'Transport' || isReturn) {
                    $this.sumFleetMetal += getInt(resources['metal'] || 0);
                    $this.sumFleetCrystal += getInt(resources['crystal'] || 0);
                    $this.sumFleetDeuterium += getInt(resources['deuterium'] || 0);
                }
            }
        });

        $('#sumFleetMetal').html(numberFormat(this.sumFleetMetal, true));
        $('#sumFleetCrystal').html(numberFormat(this.sumFleetCrystal, true));
        $('#sumFleetDeuterium').html(numberFormat(this.sumFleetDeuterium, true));

        // @todo
        const todo = {
            slots_used: -1,
            slots_available: -1
        };

        $('.fleet-movement').append('<div style="border-top: 1px solid #222;padding: 10px 0 0 0; margin: 10px 0"><b>' + todo.slots_used + ' / ' + todo.slots_available + ' Slots genutzt</b></div>');
    };

    this.getResources = function (cell) {
        if (cell.length === 0) {
            return [];
        }

        const cellContent = $(cell).html();
        const resources = cellContent.match(/([.0-9]+) Metall\; ([.0-9]+) Kristall\; ([.0-9]+) Deuterium/);

        return {
            metal: resources[1],
            crystal: resources[2],
            deuterium: resources[3]
        };
    }

    this.getShips = function (cell) {
        if (cell.length === 0) {
            return [];
        }

        const returnArray = {};
        const ships = $(cell).html().replace(/([\(\)]+)/g, '').split(/;/);
        let parsedShip;

        $.each(ships, function (key, obj) {
            parsedShip = obj.match(/([0-9]+) (.*)$/);

            if (parsedShip && parsedShip.length >= 3) {
                returnArray[parsedShip[2]] = parsedShip[1];
            }
        });

        return returnArray;
    };

    this.bindSettingTabs = function () {
        this.showSettingsTabs(getValue('settings_tab') || 'general');

        $('#settingsFilterGeneral').click(function () {
            pageOverview.showSettingsTabs('general');
        });

        $('#settingsFilterHighlighting').click(function () {
            pageOverview.showSettingsTabs('highlighting');
        });

        $('#settingsFilterFilter').click(function () {
            pageOverview.showSettingsTabs('filter');
        });

        $('#settingsFilterThresholds').click(function () {
            pageOverview.showSettingsTabs('thresholds');
        });

        $('#settingsFilterFriends').click(function () {
            pageOverview.showSettingsTabs('friends');
        });
    };

    this.showSettingsTabs = function (alias) {
        setValue('settings_tab', alias);

        $('.settings-filter').css('display', 'none');
        $('.settings-filter-' + alias).css('display', '');

        $('.settings-button').removeClass('text-red');
        $('.settings-button-' + alias).addClass('text-red');
    };

    this.debugTime = function (message = null) {
        if (message) {
            console.log('debugTime', (new Date().getTime() - this.renderTime) / 1000, message);
        }

        this.renderTime = new Date().getTime();
    };
};


/***/ }),

/***/ 524:
/***/ (() => {

window.parsePagePlayerCard = function () {
    var playerId = window.location.href.match(/[\?\&]id=([(0-9]+)/i)[1];

    if($('body').html().match(/\/includes\/pages\/game\/ShowPlayerCardPage\.class\.php/)) {
        postJSON('players/' + playerId + '/delete', {}, function() {});
        return;
    }

    var allianceId = ($('#content tr:nth-child(4) a').attr('onclick') || '').match(/\&id\=([0-9]+)/);

    postJSON('players/' + playerId, {
        name: $('#content tr:nth-child(2) td:nth-child(2)').html(),
        alliance_id: allianceId ? allianceId[1] : null,
        alliance_name: $('#content tr:nth-child(4) a').html() || null,
        main_coordinates: $('#content tr:nth-child(3) a').html().replace(/\[(.*)\]/, '$1'),
        score_building: getInt($('#content tr:nth-child(6) td:nth-child(2)').html()),
        score_science: getInt($('#content tr:nth-child(7) td:nth-child(2)').html()),
        score_military: getInt($('#content tr:nth-child(8) td:nth-child(2)').html()),
        score_defense: getInt($('#content tr:nth-child(9) td:nth-child(2)').html()),
        score: getInt($('#content tr:nth-child(10) td:nth-child(2)').html()),
        combats_won: getInt($('#content tr:nth-child(13) td:nth-child(2)').html()),
        combats_draw: getInt($('#content tr:nth-child(14) td:nth-child(2)').html()),
        combats_lost: getInt($('#content tr:nth-child(15) td:nth-child(2)').html()),
        combats_total: getInt($('#content tr:nth-child(16) td:nth-child(2)').html()),
        units_shot: getInt($('#content tr:nth-child(18) td:nth-child(2)').html()),
        units_lost: getInt($('#content tr:nth-child(19) td:nth-child(2)').html()),
        rubble_metal: getInt($('#content tr:nth-child(20) td:nth-child(2)').html()),
        rubble_crystal: getInt($('#content tr:nth-child(21) td:nth-child(2)').html()),
    }, function (response) {});

    var tbl = $('table');
    tbl.append('<tr><th colspan="3">Planeten</th></tr>');
    getJSON('players/' + playerId + '/planets', function(response) {
        if(response.status === 200) {
            $.each(JSON.parse(response.responseText), function(key, obj) {
                tbl.append('<tr><td colspan="3" style="text-align: left"><a href="/game.php?page=galaxy&galaxy=' + (obj.galaxy || '') + '&system=' + (obj.system || '') + '">' + obj.coordinates + '</a></td></tr>');
            });
        }
    });

    $('#content').append('<canvas id="playerChart" style="width: 95%; margin: 15px auto; height: 300px"></canvas>');
    $('#content').append('<canvas id="playerChartBar" style="width: 95%; margin: 15px auto; height: 100px"></canvas>');
    displayChart(playerId);
}


/***/ }),

/***/ 6789:
/***/ (() => {

window.PageResearch = function()
{
    const $this = this;
    this.data = [];

    this.convertHtml = function() {
        $('content').addClass('research');

        $('.infos, .infoso').each(function(key, obj) {
            $(obj).addClass('building');
            $($(obj).find('div:nth-child(2)')).addClass('building-left');
            $($(obj).find('div:nth-child(3)')).addClass('building-right');

            $this.disableButtons($($(obj).find('div:nth-child(3)')));
            $this.changeBuildTimeStyle($($(obj).find('div:nth-child(3)')));
        });

        $('content').html($('content').html().replace(/\(Stufe ([0-9]+)\)/g, '<br><span class="highlight">Stufe $1</span><br>'));
    };

    this.init = function() {
        const research = [];
        let info;
        let level;

        this.convertHtml();

        $('.buildn').each(function(key, obj) {
            info = $(obj).html().match(/\.info\(([0-9]+)\)\"\>([^<]+)\<\/a\>/);
            level = $(obj).html().match(/Stufe ([0-9]+)/);

            research.push({
                research_id: getInt(info[1]),
                level: level ? getInt(level[1]) : 0
            });
        });

        postJSON('players/research', {research}, function(response) {
            $this.data = JSON.parse(response.responseText);

            $('.buildn').each(function(key, obj) {
                info = $(obj).html().match(/\.info\(([0-9]+)\)\"\>([^<]+)\<\/a\>/);
                $(obj).append('Max: ' + $this.data[info[1]].max_level);

                if($this.data[info[1]].max_level > 0) {
                    $(obj).append('<div class="player_names">' + $this.data[info[1]].player_names.replace(/,/g,', ') + '</div>');
                }
            });
        });
    };

    this.disableButtons = function (cell) {
        if ($(cell).find('.text-red').length > 0) {
            $($(cell).find('.build_submit')).addClass('text-gray');
            $(cell).parent().addClass('fade-' + ($(cell).find('.build_submit').length === 0 ? '25' : '75'));

            let buildingRight = $($(cell).parent().find('.building-right'));
            let ressList = $(buildingRight.find('> span:first-child')).html();
            let coords = ownId;
            let resourceId = $($(cell).parent().find('.buildn > a')).attr('onclick').match(/\(([0-9]+)\)/)[1];

            let metal = $this.getCost('Metall', ressList);
            let crystal = $this.getCost('Kristall', ressList);
            let deuterium = $this.getCost('Deuterium', ressList);

            // show notification button
            if (new PlanetResourceNotification().hasNotification(coords, resourceId)) {
                const timestamp = new PlanetResourceNotification().getFinishTime(coords);
                buildingRight.append('<br><button onclick="(new PlanetResourceNotification().removeNotification(\'' + coords + '\'))" style="color: ' + getRgb(cRed) + '"><i class="fa fa-bell-slash"></i> baubar in <span class="notification-timer" data-timestamp="' + timestamp + '">' + formatTimeDiff(timestamp) + '</span></button>');
            } else {
                buildingRight.append('<br><button onclick="(new PlanetResourceNotification().addNotification(\'' + coords + '\', \'' + resourceId + '\',' + metal + ',' + crystal + ',' + deuterium + '))" style="color: ' + getRgb(cGreen) + '"><i class="fa fa-bell"></i> benachrichtigen, wenn baubar</button>');
            }
        }

        window.setInterval(function () {
            $('.notification-timer').each(function () {
                $(this).text(formatTimeDiff($(this).attr('data-timestamp')));
            });
        }, 1000);
    }

    this.changeBuildTimeStyle = function(cell) {
        $(cell).html($(cell).html().replace(/(.*)Bauzeit\:(.*)/,'$1<span class="text-gray">Bauzeit: $2</span>'));
    }

    this.getCost = function (label, html) {
        let tmp;

        switch (label) {
            case 'Metall':
                tmp = html.match(/\<a (.*)\>(Metall)\<\/a\>(.*)\<b(.*)\<span(.*)\>([.0-9]+)\<\//);
                break;

            case 'Kristall':
                tmp = html.match(/\<a (.*)\>(Kristall)\<\/a\>(.*)\<b(.*)\<span(.*)\>([.0-9]+)\<\//);
                break;

            case 'Deuterium':
                tmp = html.match(/\<a (.*)\>(Deuterium)\<\/a\>(.*)\<b(.*)\<span(.*)\>([.0-9]+)\<\//);
                break;
        }

        return tmp ? getInt(tmp[6]) : 0;
    }
};


/***/ }),

/***/ 2658:
/***/ (() => {

window.PageResources = function () {
    const $this = this;

    this.init = function () {
        this.parseLines($('content table tr'));
    };

    this.parseLines = function (rows) {
        let label;

        $.each(rows, function (key, obj) {
            label = $($(obj).find('td')[0]).find('a').length === 0 ? $($(obj).find('td')[0]).html() : $($(obj).find('td > a')[0]).html();

            switch (label) {
                case 'Lagerkapazität':
                    setValue(ownCoords[0] + '_limit_metal', $this.parseCapacity($($($(obj).find('td')[1]).find('span')).html()));
                    setValue(ownCoords[0] + '_limit_crystal', $this.parseCapacity($($($(obj).find('td')[2]).find('span')).html()));
                    setValue(ownCoords[0] + '_limit_deuterium', $this.parseCapacity($($($(obj).find('td')[3]).find('span')).html()));
                    break;

                case 'Pro Tag':
                    setValue(ownCoords[0] + '_production_metal', getInt($($($(obj).find('td')[1]).find('span')).html()).toString());
                    setValue(ownCoords[0] + '_production_crystal', getInt($($($(obj).find('td')[2]).find('span')).html()).toString());
                    setValue(ownCoords[0] + '_production_deuterium', getInt($($($(obj).find('td')[3]).find('span')).html()).toString());
                    setValue(ownCoords[0] + '_production_energy', getInt($($($(obj).find('td')[4]).find('span')).html()).toString());
                    break;
            }
        });
    }

    this.parseCapacity = function (value) {
        let multiplier = 1;

        if (value.search(/K/) !== -1) {
            multiplier = 1000;
        }

        if (value.search(/M/) !== -1) {
            multiplier = 1000;
            value = parseFloat(value.replace(/,/, '.')) * 1000;
        }

        return getInt(value) * multiplier;
    };
}


/***/ }),

/***/ 7577:
/***/ (() => {

window.parsePageStatistics = function () {
    var userIds = [];
    var inactiveIds = [];
    var vacationIds = [];

    $('.table519:nth-child(2) tr').each(function (key, obj) {
        if (key > 0) {
            var userId = parseInt($(obj).find('td:nth-child(2) a').attr('onclick').replace(/return Dialog\.Playercard\((.*)\, (.*)\);/, '$1'));
            userIds.push(userId);

            $(obj).attr('id', 'row' + userId);

            if ($(obj).find('td:nth-child(2) .galaxy-short-inactive').length > 0) {
                inactiveIds.push(userId);
            }

            if ($(obj).find('td:nth-child(2) .galaxy-short-vacation').length > 0) {
                vacationIds.push(userId);
            }
        } else {
            $(obj).append('<th>Koords</th>');
            $(obj).append('<th>B</th>');
            $(obj).append('<th>S</th>');
            $(obj).append('<th>M</th>');
            $(obj).append('<th>D</th>');
        }
    });

    postJSON('players/stats', {
        ids: userIds,
        inactive_ids: inactiveIds,
        vacation_ids: vacationIds,
        order_by: getValue('orderBy')
    }, function (response) {
        response = JSON.parse(response.responseText);

        $(response.players).each(function (key, obj) {
            var selector = $('#row' + obj.id);
            selector.append('<td id="row' + obj.id + 'Coordinates">' + (obj.main_coordinates || '---') + '</td>');
            selector.append('<td id="row' + obj.id + 'ScoreBuilding">' + (obj.score_building || '') + '</td>');
            selector.append('<td id="row' + obj.id + 'ScoreScience">' + (obj.score_science || '') + '</td>');
            selector.append('<td id="row' + obj.id + 'ScoreMilitary">' + (obj.score_military || '') + '</td>');
            selector.append('<td id="row' + obj.id + 'ScoreDefense">' + (obj.score_defense || '') + '</td>');

            selector.css(getPlayerRowStyle(obj));
            $('#row' + obj.id + ' td:nth-child(5)').css(getPlayerScoreStyle(obj, response.player));
            $('#row' + obj.id + 'ScoreBuilding').css(getPlayerScoreBuildingStyle(obj, response.player));
            $('#row' + obj.id + 'ScoreScience').css(getPlayerScoreScienceStyle(obj, response.player));
            $('#row' + obj.id + 'ScoreMilitary').css(getPlayerScoreMilitaryStyle(obj, response.player));
            $('#row' + obj.id + 'ScoreDefense').css(getPlayerScoreDefenseStyle(obj, response.player));

            $('#row' + obj.id + ' td:nth-child(1)').css(getPlayerRowTdStyle(obj, response.player));
            $('#row' + obj.id + ' td:nth-child(2)').css(getPlayerRowTdStyle(obj, response.player));
        });
    });
};


/***/ }),

/***/ 1034:
/***/ (() => {

window.processQueue = function () {

};


/***/ }),

/***/ 9683:
/***/ (() => {

window.getProgressBar = function () {
    const progressBar = $('#progress-bar');

    if (progressBar.length === 1) {
        return progressBar;
    }

    $('body').prepend('<div style="padding: 10px 15px; background: ' + getRgb(cBlue) + '; color: ' + getRgb(cWhite) + '; z-index: 10000; position: fixed; top: 0; left: 0; right: 0;" id="progress-bar"></div>');
    return $('#progress-bar');
};


/***/ }),

/***/ 9779:
/***/ (() => {

window.anonymizeBattleReport = function() {
    $("head").append('<style>.anonymize { filter: blur(5px); }</style>');
    $("body").html($("body").html().replace(/\[([0-9]{1,3})\:([0-9]{1,3})\:([0-9]{1,3})\]/g,'[<span class="anonymize">$1:$2:$3</span>]'));

    var cells = $('td');
    cells.each(function(key, obj) {
        $(obj).html($(obj).html().replace(/([0-9]{3,})\%/g,' <span class="anonymize">$1%</span>'));
    });

    var rounds = $("body").html().split('<hr>');
    var roundCount = rounds.length;
    var returnHtml = '';
    for(var i = 0; i < roundCount; i++) {
        if(i === 0) {
            returnHtml += rounds[i];
            returnHtml += '<div style="margin: 20px auto; text-align: center"><img style="border-radius: 0; width: 600px" src="https://pr0game-hub.eskju.net/ff_transparent.png"></div>';
        }

        if(i === roundCount - 1 && roundCount > 1) {
            returnHtml += rounds[i];
        }
    }

    $("body").html(returnHtml);
    $('#anonymize').remove();
};


/***/ }),

/***/ 6813:
/***/ (() => {

window.CsvToArray = function(string) {
    string = string || '';

    return string.split(',') || [];
};


/***/ }),

/***/ 2545:
/***/ (() => {

window.displayAllianceChart = function (allianceId) {
    $('head').append('<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>');
    getJSON('alliances/' + allianceId + '/chart', function (response) {
        const chartRespone = JSON.parse(response.responseText);
        const dates = chartRespone.dates;
        const labels = chartRespone.players;
        const dataSets = [];
        const colors = ['red', 'orange', 'yellow', 'green', 'blue', 'indigo', 'violette', 'white', 'lightgreen', 'lightblue'];

        for (let i = 0; i < chartRespone.datasets.length; i++) {
            dataSets.push({
                label: labels[i],
                data: chartRespone.datasets[i],
                borderColor: colors[i % colors.length],
                borderWidth: 1,
                radius: 1
            });
        }

        $('content').append('<canvas id="chart" style="width: 95%; margin: 15px auto; height: 500px"></canvas>');
        $('body').animate({opacity: 1}, 500, function () {
            const myChart = new Chart(
                document.getElementById('chart'),
                {
                    type: 'line',
                    data: {
                        labels: dates,
                        datasets: dataSets,
                    },
                    options: {
                        scales: {
                            x: {}
                        },
                        plugins: {
                            legend: {}
                        }
                    }
                }
            );
        });
    });
};


/***/ }),

/***/ 7977:
/***/ (() => {

window.displayChart = function (playerId) {
    $('head').append('<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>');
    getJSON('players' + (playerId ? '/' + playerId : '') + '/chart', function (response) {
        const chartRespone = JSON.parse(response.responseText);
        const dates = [];
        const ownScore = [];
        const score = [];
        const scoreRelative = [];
        const scoreDiff = [];
        const scoreBuilding = [];
        const scoreResearch = [];
        const scoreMilitary = [];
        const scoreDefense = [];

        $.each(chartRespone, function (key, obj) {
            dates.push(key);
            ownScore.push(obj.own_score);
            score.push(obj.score_max);
            scoreRelative.push(obj.score_relative);
            scoreDiff.push(obj.score_diff);
            scoreBuilding.push(obj.score_building);
            scoreResearch.push(obj.score_science);
            scoreMilitary.push(obj.score_military);
            scoreDefense.push(obj.score_defense);
        });

        $('body').animate({opacity: 1}, 500, function () {
            const myChart = new Chart(
                document.getElementById('playerChart'),
                {
                    type: 'line',
                    data: {
                        labels: dates,
                        datasets: [
                            {
                                label: 'Punkte',
                                data: score,
                                borderColor: '#008fff',
                                borderWidth: 2,
                                radius: 2
                            },
                            {
                                label: 'Eigene Punkte',
                                data: ownScore,
                                borderColor: '#ffffff',
                                borderWidth: 1,
                                borderDash: [5, 5],
                                radius: 1
                            },
                            {
                                label: 'Gebäude',
                                data: scoreBuilding,
                                borderColor: '#addc8d',
                                borderWidth: 1,
                                borderDash: [2, 2],
                                radius: 2
                            },
                            {
                                label: 'Forschung',
                                data: scoreResearch,
                                borderColor: '#843bff',
                                borderWidth: 1,
                                borderDash: [2, 2],
                                radius: 2
                            },
                            {
                                label: 'Militär',
                                data: scoreMilitary,
                                borderColor: '#c52b2f',
                                borderWidth: 1,
                                borderDash: [2, 2],
                                radius: 2
                            },
                            {
                                label: 'Verteidigung',
                                data: scoreDefense,
                                borderColor: '#ffc166',
                                borderWidth: 1,
                                borderDash: [2, 2],
                                radius: 2
                            }
                        ],
                    },
                    options: {
                        scales: {
                            x: {
                                display: playerId !== undefined
                            }
                        },
                        plugins: {
                            legend: {
                                display: playerId !== undefined
                            }
                        }
                    }
                }
            );

            new Chart(
                document.getElementById('playerChartBar'),
                {
                    data: {
                        labels: scoreRelative,
                        datasets: [
                            {
                                type: 'bar',
                                label: 'Punktedifferenz relativ (in %)',
                                yAxisID: 'y',
                                data: scoreRelative,
                                backgroundColor: function (context) {
                                    var index = context.dataIndex;
                                    var value = context.dataset.data[index];
                                    return value < 0 ? '#ee4d2e' : '#addc8d';
                                },
                            },
                            {
                                type: 'line',
                                label: 'Punktedifferenz absolut',
                                yAxisID: 'y2',
                                data: scoreDiff,
                                pointRadius: 0,
                                borderWidth: 2,
                                borderColor: '#888888'
                            }
                        ],
                    },
                    options: {
                        scales: {
                            x: {
                                display: false
                            },
                            y: {
                                type: 'linear',
                                position: 'left'
                            },
                            y2: {
                                type: 'linear',
                                position: 'right'
                            }
                        },
                        plugins: {
                            legend: {
                                display: false
                            }
                        }
                    }
                }
            );
        });
    });
};


/***/ }),

/***/ 3795:
/***/ (() => {

window.displayOverviewHighlight = function(label, alias, color, placeholder='Schwellwert') {
    let html = '<tr class="settings-filter settings-filter-highlighting">';
    html += '<td width="50%" style="text-align: left; color: ' + getRgb(color) + '">' + label + '</td>';
    html += '<td width="4%">';
    html += '<input id="' + alias + '" class="phFilter" data-alias="' + alias + '_enable" value="1" type="checkbox" ' + (getValue(alias + '_enable') === '1' ? 'checked' : '') + '>';
    html += '</td>';
    html += '<td width="46%" colspan="2">';
    html += '<input id="' + alias + '_value" class="phFilter" data-alias="' + alias + '_value" style="width: 100%" placeholder="' + placeholder + '" value="' + (getValue(alias + '_value') || '') + '">';
    html += '</td>';
    html += '</tr>';

    return html;
}


/***/ }),

/***/ 5032:
/***/ (() => {

window.displayOverviewSettingsPlayerVar = function(label, alias, className) {
    let html = '<tr class="settings-filter settings-filter-' + className + '">';
    html += '<td width="50%" style="text-align: left">' + label + '</td>';
    html += '<td width="50%" colspan="3">';
    html += '<input id="' + alias + '" class="phFilter" data-alias="' + alias + '" style="width: 100%" placeholder="' + label + '" value="' + (getValue(alias) || '') + '">';
    html += '</td>';
    html + '</tr>';

    return html;
};



/***/ }),

/***/ 826:
/***/ (() => {

window.displayOverviewSettingsRange = function(label, alias) {
    let html = '<tr class="settings-filter settings-filter-thresholds">';
    html += '<td width="50%" style="text-align: left">' + label + '</td>';
    html += '<td width="4%">';
    html += '<input id="' + alias + '_enable" class="phFilter" data-alias="' + alias + '_enable" value="1" type="checkbox" ' + (getValue(alias + '_enable') === '1' ? 'checked' : '') + '>';
    html += '</td>';
    html += '<td width="23%">';
    html += '<input id="' + alias + '_min" class="phFilter" data-alias="' + alias + '_min" style="width: 100%" placeholder="min" value="' + (getValue(alias + '_min') || '') + '">';
    html += '</td>';
    html += '<td width="23%">';
    html += '<input id="' + alias + '_max" class="phFilter" data-alias="' + alias + '_max" style="width: 100%" placeholder="max" value="' + (getValue(alias + '_max') || '') + '">';
    html += '</td>';
    html + '</tr>';

    return html;
};



/***/ }),

/***/ 1261:
/***/ (() => {

window.displayOverviewSettingsSelect = function(label, alias, values) {
    let html = '<tr class="settings-filter settings-filter-filter">';
    html += '<td width="50%" style="text-align: left">' + label + '</td>';
    html += '<td colspan="3">';
    html += '<select id="' + alias + '_select" class="phFilter" data-alias="' + alias + '" style="width: 100%">';

    $.each(values, function(key, obj) {
        html += '<option value="' + key + '" ' + (getValue(alias) === key ? 'selected' : '') + '>' + obj + '</option>';
    });

    html += '</select>';
    html += '</td>';
    html + '</tr>';

    return html;
};


/***/ }),

/***/ 8679:
/***/ (() => {

window.displayOverviewSettings = function () {
    let html = '';
    html += '<div id="phSettings" style="margin: 25px 0; max-width: 100% !important; ' + (getValue('hideSettings') === '1' ? 'display: none' : '') + '">';
    html += '<div style="padding: 12px; text-align: left; background: #121314">';
    html += '<b>Einstellungen</b>';
    html += '<a id="settingsFilterGeneral" class="settings-button settings-button-general" style="cursor: pointer; display: inline-block; margin-left: 10px; padding: 5px 10px; border: 1px solid rgba(255, 255, 255, 0.1)">Allgemein</a>';
    html += '<a id="settingsFilterHighlighting" class="settings-button settings-button-highlighting" style="cursor: pointer; display: inline-block; margin-left: 2px; padding: 5px 10px; border: 1px solid rgba(255, 255, 255, 0.1)">Highlighting</a>';
    html += '<a id="settingsFilterFilter" class="settings-button settings-button-filter" style="cursor: pointer; display: inline-block; margin-left: 2px; padding: 5px 10px; border: 1px solid rgba(255, 255, 255, 0.1)">Filter</a>';
    html += '<a id="settingsFilterThresholds" class="settings-button settings-button-thresholds" style="cursor: pointer; display: inline-block; margin-left: 2px; padding: 5px 10px; border: 1px solid rgba(255, 255, 255, 0.1)">Thresholds</a>';
    html += '<a id="settingsFilterFriends" class="settings-button settings-button-friends" style="cursor: pointer; display: inline-block; margin-left: 2px; padding: 5px 10px; border: 1px solid rgba(255, 255, 255, 0.1)">Freunde &amp; Feinde</a>';
    html += '</div>';
    html += '<table width="100%" class="table519">';
    html += '<tr class="settings-filter settings-filter-general"><th colspan="4">Allgemein</th></tr>';
    html += '<tr class="settings-filter settings-filter-general"><td colspan="4"><p style="font-size: 11px; text-align: left;">Solltest Du keinen API Key besitzen, wende Dich bitte per Discord an @eichhorn#1526.<br><b style="color: ' + getRgb(cRed) + '">Gib Deinen API Key nicht an andere weiter!</b></p></td></tr>';
    html += '<tr class="settings-filter settings-filter-general">';
    html += '<td width="50%" style="text-align: left">API Key</td>';
    html += '<td colspan="3"><input class="phFilter" data-alias="api_key" type="text" style="width: 100%" placeholder="API Key" value="' + (getValue('api_key') || '') + '"></td>';
    html + '</tr>';
    html += '<tr class="settings-filter settings-filter-general">';
    html += '<td width="50%" style="text-align: left">Debug-Modus</td>';
    html += '<td><input type="checkbox" class="phFilter" data-alias="debug_mode" value="1" ' + (getValue('debug_mode') === '1' ? 'checked' : '') + '></td><td colspan="2" style="text-align: left; color: #888">Zeige Infos in der Konsole</td>';
    html + '</tr>';
    html += '<tr class="settings-filter settings-filter-general">';
    html += '<td width="50%" style="text-align: left">Developer-Modus</td>';
    html += '<td><input type="checkbox" class="phFilter" data-alias="developer_mode" value="1" ' + (getValue('developer_mode') === '1' ? 'checked' : '') + '></td><td colspan="2" style="text-align: left; color: #888">Nutzt die Entwickler-API (nur zum Coden!)</td>';
    html + '</tr>';
    html += '<tr class="settings-filter settings-filter-general">';
    html += '<td width="50%" style="text-align: left">Leserliches Datumsformat</td>';
    html += '<td><input type="checkbox" class="phFilter" data-alias="date_for_humans" value="1" ' + (getValue('date_for_humans') === '1' ? 'checked' : '') + '></td><td colspan="2" style="text-align: left; color: #888">z.B. "vor 5min" statt Datum/Uhrzeit. Erfordert Reload (F5)!</td>';
    html + '</tr>';
    html += displayOverviewSettingsPlayerVar('Zeilen im Spio-Bericht (je Kategorie)', 'filter_spy_report_lines', 'general');

    html += '<tr class="settings-filter settings-filter-highlighting"><th colspan="4">HIGHLIGHTING</th></tr>';
    html += '<tr class="settings-filter settings-filter-highlighting"><td colspan="4"><p style="font-size: 11px; text-align: left;">Standardmäßig werden die Spielerwerte als Referenz genommen; Für Galaxie/System/Planet wird standardmäßig der aktive Planet gesetzt. Ist die Checkbox angehakt, wird der jeweilige Wert vom Eingetragenen überschrieben. Die Spieler-Werte werden in der Farbskala weiß (0 Punkte) bis Farbe (gesetztes Punktelimit) dargestellt.</p></td></tr>';
    html += displayOverviewHighlight('Gesamtpunkte', 'highlight_score', cBlue);
    html += displayOverviewHighlight('Gebäudepunkte', 'highlight_score_building', cGreen);
    html += displayOverviewHighlight('Forschungspunkte', 'highlight_score_science', cPink);
    html += displayOverviewHighlight('Militärpunkte', 'highlight_score_military', cRed);
    html += displayOverviewHighlight('Verteidigungspunkte', 'highlight_score_defense', cYellow);
    html += displayOverviewHighlight('Galaxie überschreiben? (z.B. 4 für Gala 4)', 'show_galaxy', cWhite, 'Galaxie Nummer');

    html += '<tr class="settings-filter settings-filter-filter"><th colspan="4">FILTER</th></tr>';
    html += displayOverviewSettingsSelect(getHotkeyIcon('I') + 'Inaktive Spieler', 'filter_inactive', {
        ALL: 'Anzeigen',
        HIDE: 'Ausblenden',
        ONLY: 'Andere ausblenden'
    });
    html += displayOverviewSettingsSelect(getHotkeyIcon('N') + 'Spieler mit Noobschutz', 'filter_noobs', {
        ALL: 'Anzeigen',
        HIDE: 'Ausblenden',
        ONLY: 'Andere ausblenden'
    });
    html += displayOverviewSettingsSelect(getHotkeyIcon('U') + 'Spieler im Urlaubsmodus', 'filter_vacation', {
        ALL: 'Anzeigen',
        HIDE: 'Ausblenden',
        ONLY: 'Andere ausblenden'
    });
    html += displayOverviewSettingsSelect(getHotkeyIcon('A') + 'Spieler der Allianz', 'filter_alliance', {
        ALL: 'Anzeigen',
        HIDE: 'Ausblenden',
        ONLY: 'Andere ausblenden'
    });
    html += displayOverviewSettingsSelect(getHotkeyIcon('S') + 'Spieler mit Spiobericht', 'filter_spy_report', {
        ALL: 'Anzeigen',
        HIDE: 'Ausblenden',
        ONLY: 'Andere ausblenden'
    });
    html += displayOverviewSettingsSelect(getHotkeyIcon('K') + 'Spieler mit Kampfbericht', 'filter_battle_report', {
        ALL: 'Anzeigen',
        HIDE: 'Ausblenden',
        ONLY: 'Andere ausblenden'
    });

    html += '<tr class="settings-filter settings-filter-thresholds"><th colspan="4">THRESHOLDS</th></tr>';
    html += displayOverviewSettingsRange(getHotkeyIcon('P', true) + 'Punkte', 'filter_score');
    html += displayOverviewSettingsRange(getHotkeyIcon('G', true) + 'Gebäudepunkte', 'filter_score_building');
    html += displayOverviewSettingsRange(getHotkeyIcon('F', true) + 'Forschungspunkte', 'filter_score_science');
    html += displayOverviewSettingsRange(getHotkeyIcon('M', true) + 'Militärpunkte', 'filter_score_fleet');
    html += displayOverviewSettingsRange(getHotkeyIcon('V', true) + 'Verteidigungspunkte', 'filter_score_defense');
    html += displayOverviewSettingsRange(getHotkeyIcon('I', true) + 'Inaktiv seit ... Stunden', 'filter_inactive_since');
    html += displayOverviewSettingsRange(getHotkeyIcon('K', true) + 'Stunden seit letztem Kampfbericht', 'filter_last_battle_report');
    html += displayOverviewSettingsRange(getHotkeyIcon('S', true) + 'Stunden seit letztem Spionagebericht', 'filter_last_spy_report');
    html += displayOverviewSettingsRange(getHotkeyIcon('Q', true) + 'Metall (letzte Spionage)', 'filter_metal');
    html += displayOverviewSettingsRange(getHotkeyIcon('W', true) + 'Kristall (letzte Spionage)', 'filter_crystal');
    html += displayOverviewSettingsRange(getHotkeyIcon('E', true) + 'Deuterium (letzte Spionage)', 'filter_deuterium');

    html += '<tr class="settings-filter settings-filter-friends"><th colspan="4">FREUNDE &amp; FEINDE</th></tr>';
    html += '<tr class="settings-filter settings-filter-friends"><td colspan="4" style="text-align: left">Bitte kommagetrennt die Spieler- bzw. Allianz-IDs eintragen. Die IDs findet Ihr in der URL der Spieler- bzw. Allianzprofile.<br>Betroffene Spieler und Allianzen werden in der Planetenübersicht farblich hervorgehoben.</td></tr>';
    html += displayOverviewSettingsPlayerVar('Befreundete Allianz-IDs', 'filter_ids_friend_alliances', 'friends');
    html += displayOverviewSettingsPlayerVar('Befreundete Spieler-IDs', 'filter_ids_friends', 'friends');
    html += displayOverviewSettingsPlayerVar('Verfeindete Allianz-IDs', 'filter_ids_enemy_alliances', 'friends');
    html += displayOverviewSettingsPlayerVar('Verfeindete Spieler-IDs', 'filter_ids_enemies', 'friends');

    html += '</table>';
    html += '</div>';

    // 843
    // 19, 933

    // 262
    // 25

    return html;
}


/***/ }),

/***/ 964:
/***/ (() => {

window.formatTimeDiff = function (timestamp) {
    if (getInt(timestamp) === 0) {
        return '---';
    }

    const diffInSeconds = Math.ceil(timestamp - new Date().getTime() / 1000);

    if(diffInSeconds < 0) {
        return '---';
    }

    let returnString = '';
    const hours = Math.floor(diffInSeconds / 3600);
    const hoursDiff = diffInSeconds % 3600;

    const minutes = Math.floor(hoursDiff / 60);
    const seconds = hoursDiff % 60;

    return addTrailingZeros(hours) + ':' + addTrailingZeros(minutes) + ':' + addTrailingZeros(seconds);
};

window.addTrailingZeros = function (value) {
    if (value <= 0) {
        return '00';
    }

    if (value < 10) {
        return '0' + value;
    }

    return value;
}


/***/ }),

/***/ 1292:
/***/ (() => {

window.getColorAlt = function pickHex(color1, weight, color) {
    var w1 = (weight === 1 ? 1 : weight - 0.33);
    w1 = w1 < 0 ? 0 : w1;
    w1 = w1 > 1 ? 1 : w1;
    var w2 = 1 - w1;
    w2 = w2 > 1 ? 1 : w2;
    w2 = w2 < 0 ? 0 : w2;
    var rgb = [Math.round(color1[0] * w1 + color[0] * w2),
        Math.round(color1[1] * w1 + color[1] * w2),
        Math.round(color1[2] * w1 + color[2] * w2)];
    return 'rgb(' + rgb[0] + ', ' + rgb[1] + ', ' + rgb[2] + ');' + (weight === 1 ? 'font-weight: bold' : '');
};


/***/ }),

/***/ 9487:
/***/ (() => {

window.getColorIntensity = function (value, threshold) {
    var intensity = value / threshold * 255;
    return intensity > 255 ? 255 : intensity;
}


/***/ }),

/***/ 3741:
/***/ (() => {

window.getColor = function pickHex(color1, weight) {
    var color = [255, 255, 255];
    var w1 = weight;
    w1 = w1 < 0 ? 0 : w1;
    w1 = w1 > 1 ? 1 : w1;
    var w2 = 1 - w1;
    w2 = w2 > 1 ? 1 : w2;
    w2 = w2 < 0 ? 0 : w2;
    var rgb = [Math.round(color1[0] * w1 + color[0] * w2),
        Math.round(color1[1] * w1 + color[1] * w2),
        Math.round(color1[2] * w1 + color[2] * w2)];
    return 'rgb(' + rgb[0] + ', ' + rgb[1] + ', ' + rgb[2] + ')';
};


/***/ }),

/***/ 8523:
/***/ (() => {

window.getCombatSimulatorLink = function (data, galaxy, system, planet) {

    let sience = [];

    let sdata = data.science.data;
    sdata.forEach((row) => {
        (sience.length == 0 && row.values[2].value !== null ? sience = row.values : '');
    });

    let resource = data.resources.data[0].values;
    let fleet = data.fleet.data[0].values;
    let defense = data.defense.data[0].values;

    let values = sience.concat(resource, fleet, defense);

    let map = {
        metal: 901,
        crystal: 902,
        deuterium: 903,
        military_tech: 109,
        defense_tech: 110,
        shield_tech: 111,
        small_transporters: 202,
        large_transporters: 203,
        light_hunters: 204,
        heavy_hunters: 205,
        cruisers: 206,
        battleships: 207,
        colony_ships: 208,
        recyclers: 209,
        spy_drones: 210,
        bombers: 211,
        solar_satellites: 212,
        destroyers: 213,
        death_stars: 214,
        battle_cruisers: 215,
        rocket_launchers: 401,
        light_laser_turrets: 402,
        heavy_laser_turrets: 403,
        gauss_canons: 404,
        ion_turrets: 405,
        plasma_turrets: 406,
        small_shields: 407,
        large_shields: 408,

    };

    let params = 'koords=' + galaxy + ':' + system + ':' + planet;

    values.forEach((item) => {
        if (typeof map[item.alias] != 'undefined') {
            params += (params === '' ? '' : '&') + map[item.alias] + '=' + item.value;
        }
    });

    return 'window.open(\'https://pr0game.gamers-universe.eu/pr0game/sim/?' + params + '\',\'_blank\')';
};

window.getPr0gameSimulatorLink = function (data, galaxy, system, planet) {

    let sience = [];

    let sdata = data.science.data;
    sdata.forEach((row) => {
        (sience.length == 0 && row.values[2].value !== null ? sience = row.values : '');
    });

    let resource = data.resources.data[0].values;
    let fleet = data.fleet.data[0].values;
    let defense = data.defense.data[0].values;

    let values = sience.concat(resource, fleet, defense);

    let map = {
        metal: 901,
        crystal: 902,
        deuterium: 903,
        military_tech: 109,
        defense_tech: 110,
        shield_tech: 111,
        small_transporters: 202,
        large_transporters: 203,
        light_hunters: 204,
        heavy_hunters: 205,
        cruisers: 206,
        battleships: 207,
        colony_ships: 208,
        recyclers: 209,
        spy_drones: 210,
        bombers: 211,
        solar_satellites: 212,
        destroyers: 213,
        death_stars: 214,
        battle_cruisers: 215,
        rocket_launchers: 401,
        light_laser_turrets: 402,
        heavy_laser_turrets: 403,
        gauss_canons: 404,
        ion_turrets: 405,
        plasma_turrets: 406,
        small_shields: 407,
        large_shields: 408,

    };

    let params = '';

    values.forEach((item) => {
        if (typeof map[item.alias] != 'undefined') {
            params += (params === '' ? '' : '&') + 'im[' + map[item.alias] + ']=' + item.value;
        }
    });

    return 'window.open(\'https://pr0game.com/game.php?page=battleSimulator&' + params + '\',\'_blank\')';
};


/***/ }),

/***/ 7327:
/***/ (() => {

window.getCoordinates = function (string) {
    const isMoon = string ? string.replace('(Mond)', '') !== string : string;
    const match = string ? string.match(/([0-9]+)\:([0-9]+)\:([0-9]+)/) : false;

    return !match ? false : [
        match[0] + (isMoon ? 'M' : ''),
        match[1],
        match[2],
        match[3],
        isMoon
    ];
}


/***/ }),

/***/ 2015:
/***/ (() => {

window.getHotkeyIcon = function(key, shift = false) {
    let html = '';

    if(shift) {
        html = getHotkeyIcon('<i class="fa fa-arrow-up"></i>');
    }

    return html + '<span style="width: 21px; outline: 1px solid ' + getRgb(cRed) + '; outline-offset: -1px; display: inline-block; font-size: 10px; line-height: 21px; text-align: center; margin-right: 5px; border-radius: 2px; background: ' + getRgb(cBlack) + '; color: ' + getRgb(cRed) + '">' + key + '</span>';
};


/***/ }),

/***/ 7652:
/***/ (() => {

window.getInt = function (intOrString) {
    return parseInt((intOrString !== null && intOrString !== undefined && intOrString !== ''? intOrString : '0').toString().replace(/\./g, ''));
}


/***/ }),

/***/ 9227:
/***/ (() => {

window.getMaxValue = function(array, property) {
    let maxValue = null;

    $.each(array, function(key, obj) {
        if(parseInt(obj[property]) > maxValue) {
            maxValue = parseInt(obj[property]);
        }
    });

    return maxValue;
};


/***/ }),

/***/ 121:
/***/ (() => {

window.getPlayerAttributeStyle = function (obj, player, alias, color) {
    let referenceValue = 1;

    if (cfgHighlight[alias] && cfgHighlight[alias].enabled) {
        referenceValue = cfgHighlight[alias].threshold;
    } else {
        if (player && player[alias]) {
            referenceValue = getInt(player[alias]);
        }
    }

    return {color: getColor(color, getInt(obj[alias]) / referenceValue)};
};

window.getPlayerScoreStyle = function (obj, player) {
    return getPlayerAttributeStyle(obj, player, 'score', cBlue);
}
window.getPlayerScoreBuildingStyle = function (obj, player) {
    return getPlayerAttributeStyle(obj, player, 'score_building', cGreen);
}
window.getPlayerScoreScienceStyle = function (obj, player) {
    return getPlayerAttributeStyle(obj, player, 'score_science', cPink);
}
window.getPlayerScoreMilitaryStyle = function (obj, player) {
    return getPlayerAttributeStyle(obj, player, 'score_military', cRed);
}
window.getPlayerScoreDefenseStyle = function (obj, player) {
    return getPlayerAttributeStyle(obj, player, 'score_defense', cYellow);
}


/***/ }),

/***/ 2432:
/***/ (() => {

window.getPlayerRowTdStyle = function (obj, ownScore) {
    if (obj.on_vacation === 1) {
        return {color: getRgb(cBlue)};
    } else if (ownPlayer !== null && (ownPlayer.alliance_id !== null && (obj.alliance_id === 12 || obj.alliance_id === 95))) {
        return {color: getRgb(cGreen)};
    } else if (obj.is_inactive === 1) {
        return {color: getRgb(cCyan)};
    } else if (getInt(obj.score) < 5000 && getInt(obj.score) < getInt(ownScore) / 5) {
        return {color: getRgb(cGray)};
    } else if (ownScore < 5000 && getInt(obj.score) > getInt(ownScore) * 5) {
        return {color: getRgb(cRed)};
    }

    const friendAllianceIds = CsvToArray(getValue('filter_ids_friend_alliances'));
    const friendIds = CsvToArray(getValue('filter_ids_friends'));
    const enemyAllianceIds = CsvToArray(getValue('filter_ids_enemy_alliances'));
    const enemyIds = CsvToArray(getValue('filter_ids_enemies'));

    for (let i = 0; i < friendAllianceIds.length; i++) {
        if (friendAllianceIds[i].toString() === (obj.alliance_id || 'xxx').toString()) {
            return {color: 'rgb(192, 184, 92)'};
        }
    }

    for (let i = 0; i < friendIds.length; i++) {
        if (friendIds[i].toString() === (obj.id || '').toString()) {
            return {color: 'rgb(192, 184, 92)'};
        }
    }

    for (let i = 0; i < enemyAllianceIds.length; i++) {
        if (enemyAllianceIds[i].toString() === (obj.alliance_id || 'xxx').toString()) {
            return {color: getRgb(cRed)};
        }
    }

    for (let i = 0; i < enemyIds.length; i++) {
        if (enemyIds[i].toString() === (obj.id || '').toString()) {
            return {color: getRgb(cRed)};
        }
    }

    return {};
}


/***/ }),

/***/ 9438:
/***/ (() => {

window.getPlayerRowStyle = function (obj, ownScore) {
    if (obj.on_vacation === 1) {
        return {background: getRgb(cBlue)};
    } else if (ownPlayer !== null && (ownPlayer.alliance_id !== null && (obj.alliance_id === 12 || obj.alliance_id === 95))) {
        return {background: getRgb(cGreen)};
    } else if (obj.is_inactive === 1) {
        return {background: getRgb(cCyan)};
    } else if (getInt(obj.score) < 5000 && getInt(obj.score) < ownScore / 5) {
        return {background: getRgb(cGray)};
    } else if (ownScore < 5000 && getInt(obj.score) > ownScore * 5) {
        return {background: getRgb(cRed)};
    }

    const friendAllianceIds = CsvToArray(getValue('filter_ids_friend_alliances'));
    const friendIds = CsvToArray(getValue('filter_ids_friends'));
    const enemyAllianceIds = CsvToArray(getValue('filter_ids_enemy_alliances'));
    const enemyIds = CsvToArray(getValue('filter_ids_enemies'));

    for (let i = 0; i < friendAllianceIds.length; i++) {
        if (friendAllianceIds[i].toString() === (obj.alliance_id || '').toString()) {
            return {background: 'rgb(192, 184, 92)'};
        }
    }

    for (let i = 0; i < friendIds.length; i++) {
        if (friendIds[i].toString() === (obj.id || '').toString()) {
            return {background: 'rgb(192, 184, 92)'};
        }
    }

    for (let i = 0; i < enemyAllianceIds.length; i++) {
        if (enemyAllianceIds[i].toString() === (obj.alliance_id || '').toString()) {
            return {background: getRgb(cRed)};
        }
    }

    for (let i = 0; i < enemyIds.length; i++) {
        if (enemyIds[i].toString() === (obj.id || '').toString()) {
            return {background: getRgb(cRed)};
        }
    }

    return {};
}


/***/ }),

/***/ 8064:
/***/ (() => {

window.getRgb = function(color) {
    return 'rgb(' + color[0] + ', ' + color[1] + ', ' + color[2] + ')';
}


/***/ }),

/***/ 2805:
/***/ (() => {

window.getStyle = function (value) {
    if (getInt(value) === 0) {
        return 'text-gray';
    }

    if (getInt(value) < 0) {
        return 'text-red';
    }

    return 'text-green';
}


/***/ }),

/***/ 6590:
/***/ (() => {

window.hotkeys = function () {
    $(window).keypress(function (e) {
        if ($('*:focus').length === 0) {
            if (e.keyCode === 32) {
                e.stopPropagation();
                e.preventDefault();
                processXhrQueue();
            }
        }
    });
};


/***/ }),

/***/ 9130:
/***/ (() => {

window.numberFormat = function (number, toUnit = false) {
    if(number === null) {
        return '';
    }

    number = getInt(number);

    if (toUnit) {
        let unit = 'K';

        if (number === 0) {
            return '0';
        }

        return (Math.round(number / 100) / 10).toFixed(1) + unit;
    }


    return Math.floor(number || 0).toString().replace(/\B(?=(\d{3})+(?!\d))/g, '.');
}


/***/ }),

/***/ 7859:
/***/ (() => {

window.PlanetResourceNotification = function () {
    const $this = this;

    this.addNotification = function (coords, resourceId, metal, crystal, deuterium, level) {
        setValue(coords + '_notification_resourceId', resourceId);
        setValue(coords + '_notification_metal', parseInt(metal));
        setValue(coords + '_notification_crystal', parseInt(crystal));
        setValue(coords + '_notification_deuterium', parseInt(deuterium));
        setValue(coords + '_notification_level', parseInt(level));

        showMessage('Benachrichtigung gespeichert.');
    };

    this.removeNotification = function (coords) {
        setValue(coords + '_notification_resourceId', null);
        setValue(coords + '_notification_metal', null);
        setValue(coords + '_notification_crystal', null);
        setValue(coords + '_notification_deuterium', null);
    }

    this.hasNotification = function (coords, resourceId) {
        return parseInt(getValue(coords + '_notification_resourceId')) === parseInt(resourceId);
    };

    this.getFinishTime = function (coords) {
        if (getInt(getValue(coords + '_notification_resourceId')) === 0) {
            return null;
        }

        let metalTime = this.getFinishTimeForResource(coords, 'metal');
        let crystalTime = this.getFinishTimeForResource(coords, 'crystal');
        let deuteriumTime = this.getFinishTimeForResource(coords, 'deuterium');

        if (deuteriumTime > crystalTime && deuteriumTime > metalTime) {
            return deuteriumTime;
        }

        if (crystalTime > metalTime) {
            return crystalTime;
        }

        if (metalTime <= new Date().getTime() / 1000) {
            return null;
        }

        return metalTime;
    };

    this.getFinishTimeForResource = function (coords, resource) {
        const need = getInt(getValue(coords + '_notification_' + resource));
        const available = getInt(getValue(coords + '_' + resource));
        const productionPerDay = getInt(getValue(coords + '_production_' + resource));
        const lastUpdate = getInt(getValue(coords + '_resource_update'));
        const diff = need - available < 0 ? 0 : need - available;
        const secondsLeft = diff < 0 ? 0 : diff / productionPerDay * 86400;

        return Math.ceil(lastUpdate / 1000 + secondsLeft);
    };

    this.getDiffForResource = function (coords, resource) {
        const need = getInt(getValue(coords + '_notification_' + resource));
        const available = getInt(getValue(coords + '_' + resource));
        const diff = need - available < 0 ? 0 : need - available;

        return numberFormat(diff);
    };

    this.getNotifications = function () {
        let result = [];
        let coords;
        let resourceId;
        const resources = {
            '1': 'Metallmine',
            '2': 'Kristallmine',
            '3': 'Deuteriumsynthesierer',
            '4': 'Solarkraftwerk',
            '6': 'Technodome',
            '12': 'Fusionskraftwerk',
            '14': 'Roboterfabrik',
            '15': 'Nanofabrik',
            '21': 'Schiffswerft',
            '22': 'Metalllager',
            '23': 'Kristalllager',
            '24': 'Deuteriumtank',
            '31': 'Forschungslabor',
            '33': 'Terraformer',
            '34': 'Allianzdepot',
            '41': 'Basis',
            '42': 'Phalanx',
            '43': 'Portal',
            '44': 'Raketensilo',

            '106': 'Spionagetechnik',
            '108': 'Computertechnik',
            '109': 'Waffentechnik',
            '110': 'Schildtechnik',
            '111': 'Raumschiffpanzerung',
            '113': 'Energietechnik',
            '114': 'Hyperraumtechnik',
            '115': 'Verbrennungstriebwerk',
            '117': 'Impulstriebwerk',
            '118': 'Hyperraumantrieb',
            '120': 'Lasertechnik',
            '121': 'Ionentechnik',
            '122': 'Plasmatechnik',
            '123': 'Intergalaktisches Forschungsnetzwerk',
            '124': 'Astrophysik',
            '131': 'Produktionsmaximierung Metall',
            '132': 'Produktionsmaximierung Kristall',
            '133': 'Produktionsmaximierung Deuterium',
            '199': 'Gravitonforschung',

            '202': 'small_transporters',
            '203': 'large_transporters',
            '204': 'light_hunters',
            '205': 'heavy_hunters',
            '206': 'cruisers',
            '207': 'battleships',
            '208': 'colony_ships',
            '209': 'recyclers',
            '210': 'spy_drones',
            '211': 'bombers',
            '212': 'solar_satellites',
            '213': 'destroyers',
            '214': 'death_stars',
            '215': 'battle_cruisers',

            '401': 'rocket_launchers',
            '402': 'light_laser_turrets',
            '403': 'heavy_laser_turrets',
            '404': 'gauss_canons',
            '405': 'ion_turrets',
            '406': 'plasma_turrets',
            '407': 'small_shields',
            '408': 'large_shields',

            '502': 'interceptor_missiles',
            '503': 'interplanetary_missiles',

            '901': 'metal',
            '902': 'crystal',
            '903': 'deuterium',
            '911': 'energy'
        };

        $('#planetSelector option').each(function (key, obj) {
            coords = getCoordinates(obj.innerHTML)[0];
            resourceId = getValue(coords + '_notification_resourceId');

            if (resourceId) {
                result.push({
                    coords,
                    resourceId,
                    resource: resources[resourceId],
                    metal: $this.getDiffForResource(coords, 'metal'),
                    crystal: $this.getDiffForResource(coords, 'crystal'),
                    deuterium: $this.getDiffForResource(coords, 'deuterium'),
                    level: getValue(coords + '_notification_level')
                });
            }
        });

        return result;
    };
};


/***/ }),

/***/ 1688:
/***/ (() => {

window.replaceFixColors = function() {
    $('content *[style]').each(function(key, obj) {
        if($(obj).attr('style').search(/color\:lime/) !== -1) {
            $(obj).attr('style', $(obj).attr('style').replace(/color\:lime/,''));
            $(obj).addClass('text-green');
        }

        if($(obj).attr('style').search(/color\:\#ffd600/) !== -1) {
            $(obj).attr('style', $(obj).attr('style').replace(/color\:\#ffd600/,''));
            $(obj).addClass('text-red');
        }

        if($(obj).attr('style').search(/color\:red/) !== -1) {
            $(obj).attr('style', $(obj).attr('style').replace(/color\:\#ffd600/,''));
            $(obj).addClass('text-red');
        }
    });
};


/***/ }),

/***/ 3225:
/***/ (() => {

window.Resources = function () {
    const $this = this;
    this.sumMetal = 0;
    this.sumCrystal = 0;
    this.sumDeuterium = 0;
    this.sumLimitMetal = 0;
    this.sumLimitCrystal = 0;
    this.sumLimitDeuterium = 0;

    this.init = function () {
        setValue(ownCoords[0] + '_metal', getInt($('#current_metal').html()).toString());
        setValue(ownCoords[0] + '_crystal', getInt($('#current_crystal').html()).toString());
        setValue(ownCoords[0] + '_deuterium', getInt($('#current_deuterium').html()).toString());
        setValue(ownCoords[0] + '_resource_update', new Date().getTime().toString());

        $this.updateVars();
    }

    this.updateVars = function () {
        let coords;

        this.sumMetal = 0;
        this.sumCrystal = 0;
        this.sumDeuterium = 0;
        this.sumProdMetal = 0;
        this.sumProdCrystal = 0;
        this.sumProdDeuterium = 0;
        this.sumLimitMetal = 0;
        this.sumLimitCrystal = 0;
        this.sumLimitDeuterium = 0;

        $('#planetSelector option').each(function (key, obj) {
            coords = getCoordinates(obj.innerHTML)[0];
            $this.updateVar(coords, 'metal');
            $this.updateVar(coords, 'crystal');
            $this.updateVar(coords, 'deuterium');
        });

        $('#sumMetal').html(numberFormat(this.sumMetal + (pageOverview ? pageOverview.sumFleetMetal :  false || 0), true));
        $('#sumCrystal').html(numberFormat(this.sumCrystal + (pageOverview ? pageOverview.sumFleetCrystal :  false || 0), true));
        $('#sumDeuterium').html(numberFormat(this.sumDeuterium + (pageOverview ? pageOverview.sumFleetDeuterium :  false || 0), true));
        $('#sumLimitMetal').html(numberFormat(this.sumLimitMetal, true));
        $('#sumLimitCrystal').html(numberFormat(this.sumLimitCrystal, true));
        $('#sumLimitDeuterium').html(numberFormat(this.sumLimitDeuterium, true));
        $('#infoMetal').attr('data-tooltip-content', numberFormat(Math.round(this.sumProdMetal / 24), true) + ' / Stunde<br>' +  numberFormat(Math.round(this.sumProdMetal), true) + ' / Tag');
        $('#infoCrystal').attr('data-tooltip-content', numberFormat(Math.round(this.sumProdCrystal / 24), true) + ' / Stunde<br>' +  numberFormat(Math.round(this.sumProdCrystal), true) + ' / Tag');
        $('#infoDeuterium').attr('data-tooltip-content', numberFormat(Math.round(this.sumProdDeuterium / 24), true) + ' / Stunde<br>' +  numberFormat(Math.round(this.sumProdDeuterium), true) + ' / Tag');

        $('#current_metal').stop().animate({left: 0}, 1000, () => {
            $this.updateVars();
        });
    };

    this.updateVar = function (coords, alias) {
        const initValue = getInt(getValue(coords + '_' + alias));
        const production = getInt(getValue(coords + '_production_' + alias));
        const limit = getInt(getValue(coords + '_limit_' + alias));
        const timeDiff = getValue(coords + '_resource_update') ? new Date().getTime() - getInt(getValue(coords + '_resource_update')) : null;
        const currentValue = !timeDiff ? initValue : initValue + production / 86400 * timeDiff / 1000;

        if (currentValue > limit) {
            $('.ress_' + alias + '_' + coords.replace(/\:/g, '_')).html('<span class="text-red" title="Die Lager sind vermutlich voll. Produktion gestoppt.">' + numberFormat(parseInt(currentValue), true) + '<small style="color: #888"> / ' + numberFormat(parseInt(limit), true) + '</small></span>');
        } else {
            $('.ress_' + alias + '_' + coords.replace(/\:/g, '_')).html(numberFormat(parseInt(currentValue), true) + '<small style="color: #888"> / ' + numberFormat(parseInt(limit), true) + '</small>');
            $('.ress_' + alias + '_' + coords.replace(/\:/g, '_')).css('color', getColorAlt(cRed, parseInt(currentValue) / parseInt(limit), cGreen));
        }

        $('.ress_light_' + alias + '_' + coords.replace(/\:/g, '_')).html(numberFormat(parseInt(currentValue)));

        switch (alias) {
            case 'metal':
                this.sumMetal += parseInt(currentValue);
                this.sumProdMetal += getInt(production);
                this.sumLimitMetal += parseInt(limit);
                break;

            case 'crystal':
                this.sumCrystal += parseInt(currentValue);
                this.sumProdCrystal += getInt(production);
                this.sumLimitCrystal += parseInt(limit);
                break;

            case 'deuterium':
                this.sumDeuterium += parseInt(currentValue);
                this.sumProdDeuterium += getInt(production);
                this.sumLimitDeuterium += parseInt(limit);
                break;
        }
    }
};


/***/ }),

/***/ 1276:
/***/ (() => {

window.savePhOption = function(key, value) {
    setValue(key, value);

    pageOverview.renderHtml();
};


/***/ }),

/***/ 1724:
/***/ (() => {

window.showMessage = function (message, level) {
    let background;
    let color;

    switch (level) {
        case 'danger':
            background = '#161618';
            color = '#d23c22';
            break;

        default:
            background = '#161618';
            color = '#5cb85c';
            break;
    }

    $('#alertBox').remove();
    $('body').prepend('<div id="alertBox" style="padding: 25px 15px; background: ' + background + '; color: ' + color + '; z-index: 10000; position: fixed; top: 0; left: 0; right: 0; opacity: 0; text-align: center; font-weight: bold;">' + message + '</div>');
    $('#alertBox').animate({opacity: 1}, 250).animate({opacity: 1}, 2500).animate({opacity: 0}, 500, function () {
        $(this).remove();
    });
}


/***/ }),

/***/ 8089:
/***/ (() => {

window.showSpyReportHistoryBox = function (spyReportHistory, offset) {
    var html = '<table width="100%" style="max-width: 100% !important" class="table519"><tr>';
    html += '<th style="text-align: left; width: 250px" width="200">Zeit</th>';

    $(spyReportHistory[offset].data[0].values).each(function (key, obj) {
        html += '<th style="text-align: center;">' + obj.name + '</th>';
    });

    html += '</tr>';

    $(spyReportHistory[offset].data).each(function (key, obj) {
        html += '<tr>';
        html += '<td style="text-align: left;"><a class="tooltip" data-tooltip-content="' + obj.dateTime + '">' + obj.timestamp + '</a> (' + ((obj.reporter ? obj.reporter.name : '???') || '???') + ')</td>';

        $(obj.values).each(function (key, value) {
            value.value = value.value === null ? '---' : value.value;
            html += '<td style="position: relative; ' + (value.value.toString() !== '0' && value.value.toString() !== '---' ? 'color: #fff' : 'color: #444') + '">';
            html += value.value;

            if (value.difference === null || value.difference === 0 || value.valueBefore === value.value) {
                // nothing to show
            } else if (value.valueBefore && value.valueBefore > value.value) {
                html += ' <span style="color: ' + getRgb(cRed) + '; position: absolute; right: 15px">' + value.difference + '</span>';
            } else {
                html += ' <span style="color: ' + getRgb(cGreen) + '; position: absolute; right: 15px">+' + value.difference + '</span>';
            }

            html += '</td>';
        });

        html += '</tr>';
    });

    html += '</table>';

    return html;
};


/***/ }),

/***/ 9002:
/***/ (() => {

window.showSpyReportHistory = function (galaxy, system, planet, limit) {
    if(!limit) {
        limit = (getValue('filter_spy_report_lines') || 10);
    }

    getJSON('spy-reports/' + galaxy + '/' + system + '/' + planet + '?lines=' + limit, function (spyReports) {
        const spyReportHistory = JSON.parse(spyReports.responseText);

        $('#spyReportBackdrop').remove();
        $('#spyReportOverlay').remove();
        $('body').append('<div id="spyReportBackdrop" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0, 0, 0, 0.95); z-index: 10000"></div>');
        $('body').append('<div id="spyReportOverlay" style="position: fixed; top: 25px; left: 25px; right: 25px; max-height: 95%; z-index: 10000; background: #161618; overflow-y: auto"></div>');
        var container = $('#spyReportOverlay');
        var html = '<div style="padding: 10px; text-align: center">';
        html += '<b>Spionage-Historie von <a href="/game.php?page=galaxy&galaxy=' + (galaxy || '') + '&system=' + (system || '') + '">' + galaxy + ':' + system + ':' + planet + '</a></b><br>';
        html += '<a href="javascript:void(0)" onclick="showSpyReportHistory(' + galaxy + ',' + system + ',' + planet + ')">Standard</a> | ';
        html += '<a href="javascript:void(0)" onclick="showSpyReportHistory(' + galaxy + ',' + system + ',' + planet + ', 5)">5 Zeilen</a> | ';
        html += '<a href="javascript:void(0)" onclick="showSpyReportHistory(' + galaxy + ',' + system + ',' + planet + ', 10)">10 Zeilen</a> | ';
        html += '<a href="javascript:void(0)" onclick="showSpyReportHistory(' + galaxy + ',' + system + ',' + planet + ', 999999)">Alle Zeilen</a> | ';
        html += '<a href="javascript:void(0)" onclick="' + getPr0gameSimulatorLink(spyReportHistory, galaxy, system, planet) + '">Kampfsim pr0</a> | ';
        html += '<a href="javascript:void(0)" onclick="' + getCombatSimulatorLink(spyReportHistory, galaxy, system, planet) + '">Kampfsim</a> ';
        html += '</div>';
        html += showSpyReportHistoryBox(spyReportHistory, 'resources');
        html += showSpyReportHistoryBox(spyReportHistory, 'fleet');
        html += showSpyReportHistoryBox(spyReportHistory, 'defense');
        html += showSpyReportHistoryBox(spyReportHistory, 'science');
        html += showSpyReportHistoryBox(spyReportHistory, 'buildings');

        $(container).html(html);

        // close by ESC or backdrop click
        $(window).keydown(function (event) {
            if (event.key === 'Escape') {
                $('#spyReportOverlay').remove();
                $('#spyReportBackdrop').remove();
            }
        });

        $('#spyReportBackdrop').click(function () {
            $('#spyReportOverlay').remove();
            $('#spyReportBackdrop').remove();
        });
    });
};


/***/ }),

/***/ 3738:
/***/ (() => {

window.isNewerVersionAvailable = function (apiVersion) {
    if(apiVersion !== version) {
        setValue('version', apiVersion);
    }
}


/***/ }),

/***/ 1879:
/***/ (() => {

window.getJSON = function (url, callback, queue = true) {
    const concatSym = url.search(/\?/) !== -1 ? '&' : '?';
    url = apiUrl + url + concatSym + 'api_key=' + apiKey + '&version=' + version;

    if (debugMode) {
        console.log('GET', url);
    }

    return xmlhttpRequest({
        method: 'GET',
        url: url,
        onload: function (response) {
            callback(response);

            if (debugMode) {
                console.log(response.responseText);
            }
        },
        onerror: function (response) {
            if (debugMode) {
                console.log(response.status);
            }
        }
    });
};


/***/ }),

/***/ 1398:
/***/ (() => {

window.postJSON = function (url, data, callback, queue = true) {
    if (queue) {
        queueXhr('POST', url, data, callback);
        return;
    }

    url = apiUrl + url + '?api_key=' + apiKey + '&version=' + version;

    if (debugMode) {
        console.log('POST', url, data);
    }

    return xmlhttpRequest({
        method: 'POST',
        data: JSON.stringify(data),
        url: url,
        headers: {
            'Content-Type': 'application/json'
        },
        onload: function (response) {
            callback(response);

            if (debugMode) {
                console.log(response.responseText);
            }
        },
        onerror: function (response) {
            if (debugMode) {
                console.log(response.status);
            }
        }
    });
};


/***/ }),

/***/ 6196:
/***/ (() => {

let xhrQueue = [];

window.queueXhr = function (method, url, data, callback) {
    xhrQueue.push({method, url, data, callback});

    if (xhrQueue.length === 1) {
        const targetObj = $('content').length > 0 ? $('content') : $('body');
        const updateButton = '<button  id="update-button"style="background: none; border-radius: 3px; color: #fff; border: 1px solid #fff; padding: 5px 10px;" onclick="processXhrQueue()">Daten synchronisieren</button>';
        $(targetObj).prepend('<div id="update-bar" style="padding: 10px 15px; background: ' + getRgb(cRed) + '; color: ' + getRgb(cWhite) + '; z-index: 10000; top: 0; left: 0; right: 0;"><div style="display: flex"><div style="flex-basis: 25%">' + updateButton + '</div><div id="update-messages" style="flex-basis: 75%" class="text-right"></div></div></div>');
    }

    $('#update-messages').append('<div>' + url + '</div>')
};

window.processXhrQueue = function () {
    $.each(xhrQueue, function (key, obj) {
        switch (obj.method) {
            case 'POST':
                postJSON(obj.url, obj.data, obj.callback, false);
                break;

            case 'GET':
                getJSON(obj.url, obj.callback, false);
                break;
        }
    });

    xhrQueue = [];
    $('#update-bar').html('<i class="fa fa-spin fa-spinner"></i> Updating ...');
    $('#update-bar').animate({opacity: 0}, 1000, function () {
        $('#update-bar').remove();
    });
}


/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId](module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/compat get default export */
/******/ 	(() => {
/******/ 		// getDefaultExport function for compatibility with non-harmony modules
/******/ 		__webpack_require__.n = (module) => {
/******/ 			var getter = module && module.__esModule ?
/******/ 				() => (module['default']) :
/******/ 				() => (module);
/******/ 			__webpack_require__.d(getter, { a: getter });
/******/ 			return getter;
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/define property getters */
/******/ 	(() => {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = (exports, definition) => {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	(() => {
/******/ 		__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))
/******/ 	})();
/******/ 	
/************************************************************************/
var __webpack_exports__ = {};
// This entry need to be wrapped in an IIFE because it need to be in strict mode.
(() => {
"use strict";
/* harmony import */ var _config_colors__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(3989);
/* harmony import */ var _config_colors__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_config_colors__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _util_anonymize_battle_report__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(9779);
/* harmony import */ var _util_anonymize_battle_report__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_util_anonymize_battle_report__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _util_csv_to_array__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(6813);
/* harmony import */ var _util_csv_to_array__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_util_csv_to_array__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _util_display_alliance_chart__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(2545);
/* harmony import */ var _util_display_alliance_chart__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_util_display_alliance_chart__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var _util_display_chart__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(7977);
/* harmony import */ var _util_display_chart__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_util_display_chart__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var _util_display_overview_settings__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(8679);
/* harmony import */ var _util_display_overview_settings__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(_util_display_overview_settings__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var _util_display_overview_settings_highlight__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(3795);
/* harmony import */ var _util_display_overview_settings_highlight__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(_util_display_overview_settings_highlight__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var _util_display_overview_settings_playervar__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(5032);
/* harmony import */ var _util_display_overview_settings_playervar__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(_util_display_overview_settings_playervar__WEBPACK_IMPORTED_MODULE_7__);
/* harmony import */ var _util_display_overview_settings_select__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(1261);
/* harmony import */ var _util_display_overview_settings_select__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(_util_display_overview_settings_select__WEBPACK_IMPORTED_MODULE_8__);
/* harmony import */ var _util_display_overview_settings_range__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(826);
/* harmony import */ var _util_display_overview_settings_range__WEBPACK_IMPORTED_MODULE_9___default = /*#__PURE__*/__webpack_require__.n(_util_display_overview_settings_range__WEBPACK_IMPORTED_MODULE_9__);
/* harmony import */ var _util_format_time__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(964);
/* harmony import */ var _util_format_time__WEBPACK_IMPORTED_MODULE_10___default = /*#__PURE__*/__webpack_require__.n(_util_format_time__WEBPACK_IMPORTED_MODULE_10__);
/* harmony import */ var _util_get_color__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(3741);
/* harmony import */ var _util_get_color__WEBPACK_IMPORTED_MODULE_11___default = /*#__PURE__*/__webpack_require__.n(_util_get_color__WEBPACK_IMPORTED_MODULE_11__);
/* harmony import */ var _util_get_color_alt__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(1292);
/* harmony import */ var _util_get_color_alt__WEBPACK_IMPORTED_MODULE_12___default = /*#__PURE__*/__webpack_require__.n(_util_get_color_alt__WEBPACK_IMPORTED_MODULE_12__);
/* harmony import */ var _util_get_color_intensity__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(9487);
/* harmony import */ var _util_get_color_intensity__WEBPACK_IMPORTED_MODULE_13___default = /*#__PURE__*/__webpack_require__.n(_util_get_color_intensity__WEBPACK_IMPORTED_MODULE_13__);
/* harmony import */ var _util_get_combat_simulator_link__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(8523);
/* harmony import */ var _util_get_combat_simulator_link__WEBPACK_IMPORTED_MODULE_14___default = /*#__PURE__*/__webpack_require__.n(_util_get_combat_simulator_link__WEBPACK_IMPORTED_MODULE_14__);
/* harmony import */ var _util_get_coordinates__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(7327);
/* harmony import */ var _util_get_coordinates__WEBPACK_IMPORTED_MODULE_15___default = /*#__PURE__*/__webpack_require__.n(_util_get_coordinates__WEBPACK_IMPORTED_MODULE_15__);
/* harmony import */ var _util_get_hotkey_icon__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(2015);
/* harmony import */ var _util_get_hotkey_icon__WEBPACK_IMPORTED_MODULE_16___default = /*#__PURE__*/__webpack_require__.n(_util_get_hotkey_icon__WEBPACK_IMPORTED_MODULE_16__);
/* harmony import */ var _util_get_int__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(7652);
/* harmony import */ var _util_get_int__WEBPACK_IMPORTED_MODULE_17___default = /*#__PURE__*/__webpack_require__.n(_util_get_int__WEBPACK_IMPORTED_MODULE_17__);
/* harmony import */ var _util_get_max_value__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(9227);
/* harmony import */ var _util_get_max_value__WEBPACK_IMPORTED_MODULE_18___default = /*#__PURE__*/__webpack_require__.n(_util_get_max_value__WEBPACK_IMPORTED_MODULE_18__);
/* harmony import */ var _util_get_player_attribute_style__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(121);
/* harmony import */ var _util_get_player_attribute_style__WEBPACK_IMPORTED_MODULE_19___default = /*#__PURE__*/__webpack_require__.n(_util_get_player_attribute_style__WEBPACK_IMPORTED_MODULE_19__);
/* harmony import */ var _util_get_player_row_id_style__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(2432);
/* harmony import */ var _util_get_player_row_id_style__WEBPACK_IMPORTED_MODULE_20___default = /*#__PURE__*/__webpack_require__.n(_util_get_player_row_id_style__WEBPACK_IMPORTED_MODULE_20__);
/* harmony import */ var _util_get_player_row_style__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(9438);
/* harmony import */ var _util_get_player_row_style__WEBPACK_IMPORTED_MODULE_21___default = /*#__PURE__*/__webpack_require__.n(_util_get_player_row_style__WEBPACK_IMPORTED_MODULE_21__);
/* harmony import */ var _util_get_rgb__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(8064);
/* harmony import */ var _util_get_rgb__WEBPACK_IMPORTED_MODULE_22___default = /*#__PURE__*/__webpack_require__.n(_util_get_rgb__WEBPACK_IMPORTED_MODULE_22__);
/* harmony import */ var _util_get_style__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(2805);
/* harmony import */ var _util_get_style__WEBPACK_IMPORTED_MODULE_23___default = /*#__PURE__*/__webpack_require__.n(_util_get_style__WEBPACK_IMPORTED_MODULE_23__);
/* harmony import */ var _util_hotkeys__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(6590);
/* harmony import */ var _util_hotkeys__WEBPACK_IMPORTED_MODULE_24___default = /*#__PURE__*/__webpack_require__.n(_util_hotkeys__WEBPACK_IMPORTED_MODULE_24__);
/* harmony import */ var _util_number_format__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(9130);
/* harmony import */ var _util_number_format__WEBPACK_IMPORTED_MODULE_25___default = /*#__PURE__*/__webpack_require__.n(_util_number_format__WEBPACK_IMPORTED_MODULE_25__);
/* harmony import */ var _util_planet_resource_notification__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(7859);
/* harmony import */ var _util_planet_resource_notification__WEBPACK_IMPORTED_MODULE_26___default = /*#__PURE__*/__webpack_require__.n(_util_planet_resource_notification__WEBPACK_IMPORTED_MODULE_26__);
/* harmony import */ var _util_replace_fix_colors__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(1688);
/* harmony import */ var _util_replace_fix_colors__WEBPACK_IMPORTED_MODULE_27___default = /*#__PURE__*/__webpack_require__.n(_util_replace_fix_colors__WEBPACK_IMPORTED_MODULE_27__);
/* harmony import */ var _util_resources__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(3225);
/* harmony import */ var _util_resources__WEBPACK_IMPORTED_MODULE_28___default = /*#__PURE__*/__webpack_require__.n(_util_resources__WEBPACK_IMPORTED_MODULE_28__);
/* harmony import */ var _util_save_ph_value__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(1276);
/* harmony import */ var _util_save_ph_value__WEBPACK_IMPORTED_MODULE_29___default = /*#__PURE__*/__webpack_require__.n(_util_save_ph_value__WEBPACK_IMPORTED_MODULE_29__);
/* harmony import */ var _util_show_message__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(1724);
/* harmony import */ var _util_show_message__WEBPACK_IMPORTED_MODULE_30___default = /*#__PURE__*/__webpack_require__.n(_util_show_message__WEBPACK_IMPORTED_MODULE_30__);
/* harmony import */ var _util_show_spy_report_history__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(9002);
/* harmony import */ var _util_show_spy_report_history__WEBPACK_IMPORTED_MODULE_31___default = /*#__PURE__*/__webpack_require__.n(_util_show_spy_report_history__WEBPACK_IMPORTED_MODULE_31__);
/* harmony import */ var _util_show_spy_report_history_box__WEBPACK_IMPORTED_MODULE_32__ = __webpack_require__(8089);
/* harmony import */ var _util_show_spy_report_history_box__WEBPACK_IMPORTED_MODULE_32___default = /*#__PURE__*/__webpack_require__.n(_util_show_spy_report_history_box__WEBPACK_IMPORTED_MODULE_32__);
/* harmony import */ var _util_version_check__WEBPACK_IMPORTED_MODULE_33__ = __webpack_require__(3738);
/* harmony import */ var _util_version_check__WEBPACK_IMPORTED_MODULE_33___default = /*#__PURE__*/__webpack_require__.n(_util_version_check__WEBPACK_IMPORTED_MODULE_33__);
/* harmony import */ var _xhr_get_json__WEBPACK_IMPORTED_MODULE_34__ = __webpack_require__(1879);
/* harmony import */ var _xhr_get_json__WEBPACK_IMPORTED_MODULE_34___default = /*#__PURE__*/__webpack_require__.n(_xhr_get_json__WEBPACK_IMPORTED_MODULE_34__);
/* harmony import */ var _xhr_post_json__WEBPACK_IMPORTED_MODULE_35__ = __webpack_require__(1398);
/* harmony import */ var _xhr_post_json__WEBPACK_IMPORTED_MODULE_35___default = /*#__PURE__*/__webpack_require__.n(_xhr_post_json__WEBPACK_IMPORTED_MODULE_35__);
/* harmony import */ var _xhr_queue__WEBPACK_IMPORTED_MODULE_36__ = __webpack_require__(6196);
/* harmony import */ var _xhr_queue__WEBPACK_IMPORTED_MODULE_36___default = /*#__PURE__*/__webpack_require__.n(_xhr_queue__WEBPACK_IMPORTED_MODULE_36__);
/* harmony import */ var _component_changelog__WEBPACK_IMPORTED_MODULE_37__ = __webpack_require__(6809);
/* harmony import */ var _component_changelog__WEBPACK_IMPORTED_MODULE_37___default = /*#__PURE__*/__webpack_require__.n(_component_changelog__WEBPACK_IMPORTED_MODULE_37__);
/* harmony import */ var _component_menu__WEBPACK_IMPORTED_MODULE_38__ = __webpack_require__(7328);
/* harmony import */ var _component_menu__WEBPACK_IMPORTED_MODULE_38___default = /*#__PURE__*/__webpack_require__.n(_component_menu__WEBPACK_IMPORTED_MODULE_38__);
/* harmony import */ var _page_alliance__WEBPACK_IMPORTED_MODULE_39__ = __webpack_require__(6170);
/* harmony import */ var _page_alliance__WEBPACK_IMPORTED_MODULE_39___default = /*#__PURE__*/__webpack_require__.n(_page_alliance__WEBPACK_IMPORTED_MODULE_39__);
/* harmony import */ var _page_buildings__WEBPACK_IMPORTED_MODULE_40__ = __webpack_require__(5550);
/* harmony import */ var _page_buildings__WEBPACK_IMPORTED_MODULE_40___default = /*#__PURE__*/__webpack_require__.n(_page_buildings__WEBPACK_IMPORTED_MODULE_40__);
/* harmony import */ var _page_defense__WEBPACK_IMPORTED_MODULE_41__ = __webpack_require__(1914);
/* harmony import */ var _page_defense__WEBPACK_IMPORTED_MODULE_41___default = /*#__PURE__*/__webpack_require__.n(_page_defense__WEBPACK_IMPORTED_MODULE_41__);
/* harmony import */ var _page_fleet__WEBPACK_IMPORTED_MODULE_42__ = __webpack_require__(3551);
/* harmony import */ var _page_fleet__WEBPACK_IMPORTED_MODULE_42___default = /*#__PURE__*/__webpack_require__.n(_page_fleet__WEBPACK_IMPORTED_MODULE_42__);
/* harmony import */ var _page_galaxy__WEBPACK_IMPORTED_MODULE_43__ = __webpack_require__(8164);
/* harmony import */ var _page_galaxy__WEBPACK_IMPORTED_MODULE_43___default = /*#__PURE__*/__webpack_require__.n(_page_galaxy__WEBPACK_IMPORTED_MODULE_43__);
/* harmony import */ var _page_hangar__WEBPACK_IMPORTED_MODULE_44__ = __webpack_require__(1497);
/* harmony import */ var _page_hangar__WEBPACK_IMPORTED_MODULE_44___default = /*#__PURE__*/__webpack_require__.n(_page_hangar__WEBPACK_IMPORTED_MODULE_44__);
/* harmony import */ var _page_hub__WEBPACK_IMPORTED_MODULE_45__ = __webpack_require__(691);
/* harmony import */ var _page_hub__WEBPACK_IMPORTED_MODULE_45___default = /*#__PURE__*/__webpack_require__.n(_page_hub__WEBPACK_IMPORTED_MODULE_45__);
/* harmony import */ var _page_imperium__WEBPACK_IMPORTED_MODULE_46__ = __webpack_require__(7730);
/* harmony import */ var _page_imperium__WEBPACK_IMPORTED_MODULE_46___default = /*#__PURE__*/__webpack_require__.n(_page_imperium__WEBPACK_IMPORTED_MODULE_46__);
/* harmony import */ var _page_messages__WEBPACK_IMPORTED_MODULE_47__ = __webpack_require__(2419);
/* harmony import */ var _page_messages__WEBPACK_IMPORTED_MODULE_47___default = /*#__PURE__*/__webpack_require__.n(_page_messages__WEBPACK_IMPORTED_MODULE_47__);
/* harmony import */ var _page_overview__WEBPACK_IMPORTED_MODULE_48__ = __webpack_require__(896);
/* harmony import */ var _page_overview__WEBPACK_IMPORTED_MODULE_48___default = /*#__PURE__*/__webpack_require__.n(_page_overview__WEBPACK_IMPORTED_MODULE_48__);
/* harmony import */ var _page_playercard__WEBPACK_IMPORTED_MODULE_49__ = __webpack_require__(524);
/* harmony import */ var _page_playercard__WEBPACK_IMPORTED_MODULE_49___default = /*#__PURE__*/__webpack_require__.n(_page_playercard__WEBPACK_IMPORTED_MODULE_49__);
/* harmony import */ var _page_research__WEBPACK_IMPORTED_MODULE_50__ = __webpack_require__(6789);
/* harmony import */ var _page_research__WEBPACK_IMPORTED_MODULE_50___default = /*#__PURE__*/__webpack_require__.n(_page_research__WEBPACK_IMPORTED_MODULE_50__);
/* harmony import */ var _page_resources__WEBPACK_IMPORTED_MODULE_51__ = __webpack_require__(2658);
/* harmony import */ var _page_resources__WEBPACK_IMPORTED_MODULE_51___default = /*#__PURE__*/__webpack_require__.n(_page_resources__WEBPACK_IMPORTED_MODULE_51__);
/* harmony import */ var _page_stats__WEBPACK_IMPORTED_MODULE_52__ = __webpack_require__(7577);
/* harmony import */ var _page_stats__WEBPACK_IMPORTED_MODULE_52___default = /*#__PURE__*/__webpack_require__.n(_page_stats__WEBPACK_IMPORTED_MODULE_52__);
/* harmony import */ var _queue_process__WEBPACK_IMPORTED_MODULE_53__ = __webpack_require__(1034);
/* harmony import */ var _queue_process__WEBPACK_IMPORTED_MODULE_53___default = /*#__PURE__*/__webpack_require__.n(_queue_process__WEBPACK_IMPORTED_MODULE_53__);
/* harmony import */ var _queue_progressbar__WEBPACK_IMPORTED_MODULE_54__ = __webpack_require__(9683);
/* harmony import */ var _queue_progressbar__WEBPACK_IMPORTED_MODULE_54___default = /*#__PURE__*/__webpack_require__.n(_queue_progressbar__WEBPACK_IMPORTED_MODULE_54__);
























































window.updateConfigVars = function () {
    cfgHighlight = {
        score: {
            enabled: (getValue('highlight_score_enable') || '0') === '1',
            threshold: getInt(getValue('highlight_score_value') || '')
        },
        score_building: {
            enabled: (getValue('highlight_score_building_enable') || '0') === '1',
            threshold: getInt(getValue('highlight_score_building_value') || '')
        },
        score_science: {
            enabled: (getValue('highlight_score_science_enable') || '0') === '1',
            threshold: getInt(getValue('highlight_score_science_value') || '')
        },
        score_military: {
            enabled: (getValue('highlight_score_military_enable') || '0') === '1',
            threshold: getInt(getValue('highlight_score_military_value') || '')
        },
        score_defense: {
            enabled: (getValue('highlight_score_defense_enable') || '0') === '1',
            threshold: getInt(getValue('highlight_score_defense_value') || '')
        }
    };

    filterInactive = getValue('filter_inactive') || 'ALL';
    filterNoobs = getValue('filter_noobs') || 'ALL';
    filterVacation = getValue('filter_vacation') || 'ALL';
    filterAlliance = getValue('filter_alliance') || 'ALL';
    filterSpyReport = getValue('filter_spy_report') || 'ALL';
    filterBattleReport = getValue('filter_last_battle_report') || 'ALL';
    filterScoreEnabled = getValue('filter_score_enable') || '0';
    filterScoreMin = getValue('filter_score_min') || '';
    filterScoreMax = getValue('filter_score_max') || '';
    filterScoreBuildingEnabled = getValue('filter_score_building_enable') || '0';
    filterScoreBuildingMin = getValue('filter_score_building_min') || '';
    filterScoreBuildingMax = getValue('filter_score_building_max') || '';
    filterScoreScienceEnabled = getValue('filter_score_science_enable') || '0';
    filterScoreScienceMin = getValue('filter_score_science_min') || '';
    filterScoreScienceMax = getValue('filter_score_science_max') || '';
    filterScoreFleetEnabled = getValue('filter_score_fleet_enable') || '0';
    filterScoreFleetMin = getValue('filter_score_fleet_min') || '';
    filterScoreFleetMax = getValue('filter_score_fleet_max') || '';
    filterScoreDefenseEnabled = getValue('filter_score_defense_enable') || '0';
    filterScoreDefenseMin = getValue('filter_score_defense_min') || '';
    filterScoreDefenseMax = getValue('filter_score_defense_max') || '';
    filterInactiveSinceEnabled = getValue('filter_inactive_since_enable') || '0';
    filterInactiveSinceMin = getValue('filter_inactive_since_min') || '';
    filterInactiveSinceMax = getValue('filter_inactive_since_max') || '';
    filterLastBattleReportEnabled = getValue('filter_last_battle_report_enable') || '0';
    filterLastBattleReportMin = getValue('filter_last_battle_report_min') || '';
    filterLastBattleReportMax = getValue('filter_last_battle_report_max') || '';
    filterLastSpyReportEnabled = getValue('filter_last_spy_report_enable') || '0';
    filterLastSpyReportMin = getValue('filter_last_spy_report_min') || '';
    filterLastSpyReportMax = getValue('filter_last_spy_report_max') || '';
    filterMetalEnabled = getValue('filter_metal_enable') || '0';
    filterMetalMin = getValue('filter_metal_min') || '';
    filterMetalMax = getValue('filter_metal_max') || '';
    filterCrystalEnabled = getValue('filter_crystal_enable') || '0';
    filterCrystalMin = getValue('filter_crystal_min') || '';
    filterCrystalMax = getValue('filter_crystal_max') || '';
    filterDeuteriumEnabled = getValue('filter_deuterium_enable') || '0';
    filterDeuteriumMin = getValue('filter_deuterium_min') || '';
    filterDeuteriumMax = getValue('filter_deuterium_max') || '';
}

window.GetRestTimeFormat = function (seconds) {
    return formatTimeDiff(new Date().getTime() / 1000 + seconds);
};

window.getOverviewHeader = function () {
    let header = '<table cellspacing="0"><tr><td width="50%%" style="text-align: left; padding: 5px 10px">';
    header += '<a href="https://pr0game-hub.eskju.net/download/legend.png" target="_blank"><i class="fa fa-info-circle"></i> Legende</a>';
    header += ' // ';
    header += '<a href="https://pr0game-hub.eskju.net/download/faq.txt" target="_blank"><i class="fa fa-question-circle"></i> FAQ</a>';
    header += '</td>';

    if (getValue('hideSettings') === '1') {
        header += '<td id="showSettings" style="text-align: right; padding: 5px 10px; cursor: pointer;"><i class="fa fa-cogs fa"></i> Einstellungen anzeigen</td>';
    } else {
        header += '<td id="hideSettings" style="text-align: right; padding: 5px 10px; cursor: pointer;"><span style="color: lightgreen"><i class="fa fa-cogs"></i> Einstellungen ausblenden</span></td>';
    }

    header += '</tr></table>';

    header += displayOverviewSettings();

    return header;
}

window.filterTableRow = function (obj, player) {
    // selects
    if (filterInactive === 'HIDE' && obj.player.is_inactive === 1) return false;
    if (filterInactive === 'ONLY' && obj.player.is_inactive === 0) return false;

    if (player !== null) {
        if (filterNoobs === 'HIDE' && obj.player.is_inactive === 0 && getInt(obj.player.score) < 5000 && getInt(obj.player.score) < getInt(player.score) / 5) return false;
        if (filterNoobs === 'ONLY' && obj.player.is_inactive === 0 && (getInt(obj.player.score) >= 5000 || getInt(obj.player.score) >= getInt(player.score) / 5)) return false;
    }
    if (filterVacation === 'HIDE' && obj.player.on_vacation === 1) return false;
    if (filterVacation === 'ONLY' && obj.player.on_vacation === 0) return false;

    if (player) {
        if (filterAlliance === 'HIDE' && obj.player.alliance_id !== null && (obj.alliance_id === 12 || obj.alliance_id === 95)) return false;
        if (filterAlliance === 'ONLY' && (obj.player.alliance_id === null || (obj.alliance_id !== 12 && obj.alliance_id !== 95))) return false;
    }
    if (filterSpyReport === 'HIDE' && obj.last_spy_report !== '') return false;
    if (filterSpyReport === 'ONLY' && obj.last_spy_report === '') return false;
    if (filterBattleReport === 'HIDE' && obj.last_battle_report !== '') return false;
    if (filterBattleReport === 'ONLY' && obj.last_battle_report === '') return false;
    if (filterScoreEnabled === '1' && getInt(filterScoreMin) > 0 && getInt(filterScoreMin) > getInt(obj.player.score)) return false;
    if (filterScoreEnabled === '1' && getInt(filterScoreMax) > 0 && getInt(filterScoreMax) < getInt(obj.player.score)) return false;
    if (filterScoreBuildingEnabled === '1' && getInt(filterScoreBuildingMin) > 0 && getInt(filterScoreBuildingMin) > getInt(obj.player.score_building)) return false;
    if (filterScoreBuildingEnabled === '1' && getInt(filterScoreBuildingMax) > 0 && getInt(filterScoreBuildingMax) < getInt(obj.player.score_building)) return false;
    if (filterScoreScienceEnabled === '1' && getInt(filterScoreScienceMin) > 0 && getInt(filterScoreScienceMin) > getInt(obj.player.score_science)) return false;
    if (filterScoreScienceEnabled === '1' && getInt(filterScoreScienceMax) > 0 && getInt(filterScoreScienceMax) < getInt(obj.player.score_science)) return false;
    if (filterScoreFleetEnabled === '1' && getInt(filterScoreFleetMin) > 0 && getInt(filterScoreFleetMin) > getInt(obj.player.score_military)) return false;
    if (filterScoreFleetEnabled === '1' && getInt(filterScoreFleetMax) > 0 && getInt(filterScoreFleetMax) < getInt(obj.player.score_military)) return false;
    if (filterScoreDefenseEnabled === '1' && getInt(filterScoreDefenseMin) > 0 && getInt(filterScoreDefenseMin) > getInt(obj.player.score_defense)) return false;
    if (filterScoreDefenseEnabled === '1' && getInt(filterScoreDefenseMax) > 0 && getInt(filterScoreDefenseMax) < getInt(obj.player.score_defense)) return false;
    if (filterInactiveSinceEnabled === '1' && getInt(filterInactiveSinceMin) > 0 && getInt(filterInactiveSinceMin) > getInt(obj.inactive_since)) return false;
    if (filterInactiveSinceEnabled === '1' && getInt(filterInactiveSinceMax) > 0 && getInt(filterInactiveSinceMax) < getInt(obj.inactive_since)) return false;
    if (filterLastBattleReportEnabled === '1' && getInt(filterLastBattleReportMin) > 0 && getInt(filterLastBattleReportMin) > getInt(obj.last_battle_report_hours)) return false;
    if (filterLastBattleReportEnabled === '1' && getInt(filterLastBattleReportMax) > 0 && getInt(filterLastBattleReportMax) < getInt(obj.last_battle_report_hours)) return false;
    if (filterLastSpyReportEnabled === '1' && getInt(filterLastSpyReportMin) > 0 && getInt(filterLastSpyReportMin) > getInt(obj.last_spy_report_hours)) return false;
    if (filterLastSpyReportEnabled === '1' && getInt(filterLastSpyReportMax) > 0 && getInt(filterLastSpyReportMax) < getInt(obj.last_spy_report_hours)) return false;
    if (filterMetalEnabled === '1' && getInt(filterMetalMin) > 0 && getInt(filterMetalMin) > getInt(obj.last_spy_metal)) return false;
    if (filterMetalEnabled === '1' && getInt(filterMetalMax) > 0 && getInt(filterMetalMax) < getInt(obj.last_spy_metal)) return false;
    if (filterCrystalEnabled === '1' && getInt(filterCrystalMin) > 0 && getInt(filterCrystalMin) > getInt(obj.last_spy_crystal)) return false;
    if (filterCrystalEnabled === '1' && getInt(filterCrystalMax) > 0 && getInt(filterCrystalMax) < getInt(obj.last_spy_crystal)) return false;
    if (filterDeuteriumEnabled === '1' && getInt(filterDeuteriumMin) > 0 && getInt(filterDeuteriumMin) > getInt(obj.last_spy_deuterium)) return false;
    if (filterDeuteriumEnabled === '1' && getInt(filterDeuteriumMax) > 0 && getInt(filterDeuteriumMax) < getInt(obj.last_spy_deuterium)) return false;

    return true;
}

window.parseUrl = function () {
    const url = window.location.href.replace('www.', '').replace('http:', 'https:').replace('.local', '.com').replace('37.221.67.168', 'pr0game.com');

    // custom pages
    if (location.hash && location.hash.length > 0) {
        const hash = location.hash.split('.');

        switch (hash[0]) {
            case '#hub':
                pageHub = new PageHub();
                pageHub.loadPage(hash[1]);
                return;
        }
    }

    // overview page
    else if (url.search(/https\:\/\/pr0game\.com\/game\.php\?page\=raport/) === 0) {
        $('body').prepend('<button id="anonymize">Anonymisieren</button>');
        $('#anonymize').click(function () {
            window.anonymizeBattleReport();
        });
    }

    // overview page
    else if (url === 'https://pr0game.com/game.php' || url.search(/https\:\/\/pr0game\.com\/game\.php\?page\=overview/) === 0) {
        window.pageOverview = new PageOverview();
        pageOverview.init();
    }

    // stats page
    else if (url.search(/https\:\/\/pr0game\.com\/game\.php\?page\=statistics/) === 0) {
        parsePageStatistics();
    }

    // message page
    else if (url.search(/https\:\/\/pr0game\.com\/game\.php\?page\=imperium/) === 0) {
        window.pageImperium = new PageImperium();
        pageImperium.init();
    }

    // message page
    else if (url.search(/https\:\/\/pr0game\.com\/game\.php\?page\=messages/) === 0) {
        window.pageMessages = new PageMessages();
        pageMessages.init();
    }

    // battle simulator
    else if (url.search(/https\:\/\/pr0game\.com\/game\.php\?page\=battleSimulator/) === 0) {
        $($('table')[3]).find('tr').each(function (key, obj) {
            $($(obj).find('td,th')[0]).addClass('text-left');
            if ($(obj).find('input').length > 0) {
                $($(obj).find('td')[0]).after('<td class="text-right">' + $(obj).find('input').val() + '</td>');
            } else {
                $($(obj).find('td,th')[0]).after('<td>&nbsp;</td>');
            }
        });
    }

    // phalanx
    else if (url.search(/https\:\/\/pr0game\.com\/game\.php\?page\=phalanx/) === 0) {
        $('td.fleets').each(function (key, obj) {
            var end = new Date($(obj).attr('data-fleet-end-time') * 1000);

            $(obj).parent().append(' <span>' + end.toLocaleTimeString("de-DE") + '</span>');
        });
    }

    // galaxy page
    else if (url.search(/https\:\/\/pr0game\.com\/game\.php\?page\=galaxy/) === 0) {
        window.pageGalaxy = new PageGalaxy();
        pageGalaxy.init();
    }

    // player page
    else if (url.search(/https\:\/\/pr0game\.com\/game\.php\?page\=playerCard/) === 0) {
        parsePagePlayerCard();
    }

    // player page
    else if (url.search(/https\:\/\/pr0game\.com\/game\.php\?page\=alliance/) === 0) {
        parsePageAlliance();
    }

    // buildings page
    else if (url.search(/https\:\/\/pr0game\.com\/game\.php\?page\=buildings/) === 0) {
        window.pageBuildings = new PageBuildings();
        pageBuildings.init();
    }

    // defense page
    else if (url.search(/https\:\/\/pr0game\.com\/game\.php\?page\=shipyard\&mode\=defense/) === 0) {
        window.pageDefense = new PageDefense();
        pageDefense.init();
    }

    // buildings page
    else if (url.search(/https\:\/\/pr0game\.com\/game\.php\?page\=shipyard/) === 0) {
        window.pageHangar = new PageHangar();
        pageHangar.init();
    }

    // research page
    else if (url.search(/https\:\/\/pr0game\.com\/game\.php\?page\=research/) === 0) {
        window.pageResearch = new PageResearch();
        pageResearch.init();
    }

    // fleet page
    else if (url.search(/https\:\/\/pr0game\.com\/game\.php\?page\=fleetTable/) === 0) {
        window.pageFleet = new PageFleet();
        pageFleet.init();
    }

    // fleet steps
    else if (url.search(/https\:\/\/pr0game\.com\/game\.php\?page\=fleetStep/) === 0) {
        $(window).keyup(function (e) {
            if ($('content form').length === 1 && $('*:focus').length === 0) {
                if (e.key === 'Enter') {
                    $('content .table519 form').submit();
                }
            }
        });

        if (url.search(/https\:\/\/pr0game\.com\/game\.php\?page\=fleetStep1/) === 0) {
            let destination = getValue(ownCoords[0] + '_fleet_destination');

            if (destination) {
                destination = getCoordinates(destination);
                $('content').prepend('<a id="setDestination" href="#" style="padding: 10px; color: ' + getRgb(cYellow) + ';">Preset-Destination ' + destination[0] + ' auswählen</a>');

                $('#setDestination').click(function () {
                    $('#galaxy').val(destination[1]);
                    $('#system').val(destination[2]);
                    $('#planet').val(destination[3]);
                    updateVars();
                });
            }
        }

        if (url.search(/https\:\/\/pr0game\.com\/game\.php\?page\=fleetStep2/) === 0) {
            let metal = getValue(ownCoords[0] + '_fleet_metal');
            let crystal = getValue(ownCoords[0] + '_fleet_crystal');
            let deuterium = getValue(ownCoords[0] + '_fleet_deuterium');

            if (metal || crystal || deuterium) {
                $('content').prepend('<a id="setResources" href="#" style="padding: 10px; color: ' + getRgb(cYellow) + ';">Preset-Ressourcen setzen</a>');

                $('#setResources').click(function () {
                    $('input[name=metal]').val(metal);
                    $('input[name=crystal]').val(crystal);
                    $('input[name=deuterium]').val(deuterium);

                    if ($('input[name=mission]:checked').length === 0) {
                        $('#radio_4').attr('checked', 'checked');
                    }

                    calculateTransportCapacity();
                });
            }
        }
    }

    // fleet page
    else if (url.search(/https\:\/\/pr0game\.com\/game\.php\?page\=resources/) === 0) {
        window.pageResources = new PageResources();
        pageResources.init();
    }
};

// colors
window.cBlack = [22, 22, 24];
window.cWhite = [242, 245, 244];
window.cRed = [238, 77, 46];
window.cGray = [136, 136, 136];
window.cPink = [255, 0, 130];
window.cGreen = [92, 184, 92];
window.cBlue = [0, 143, 255];
window.cYellow = [247, 197, 22];
window.cCyan = [0, 255, 255];

window.ownCoords = getCoordinates($('#planetSelector option:selected').html());
window.ownId = ownCoords[0];
window.ownGalaxy = ownCoords[1];
window.ownSystem = ownCoords[2];
window.ownPlanet = ownCoords[3];
window.showGalaxy = ownGalaxy;
window.ownPlayer = null;
window.menu = null;
window.pageHub = null;
window.pageOverview = null;
window.pageBuildings = null;
window.pageHangar = null;
window.pageImperium = null;
window.pageDefense = null;
window.pageResearch = null;
window.pageGalaxy = null;
window.pageFleet = null;
window.pageMessages = null;
window.pageTechnologies = null;
window.pageResources = null;
window.rxNumber = '([.0-9]+)';
window.cfgHighlight = {};

let filterInactive = getValue('filter_inactive') || 'ALL';
let filterNoobs = getValue('filter_noobs') || 'ALL';
let filterVacation = getValue('filter_vacation') || 'ALL';
let filterAlliance = getValue('filter_alliance') || 'ALL';
let filterSpyReport = getValue('filter_spy_report') || 'ALL';
let filterBattleReport = getValue('filter_last_battle_report') || 'ALL';
let filterScoreEnabled = getValue('filter_score_enable') || '0';
let filterScoreMin = getValue('filter_score_min') || '';
let filterScoreMax = getValue('filter_score_max') || '';
let filterScoreBuildingEnabled = getValue('filter_score_building_enable') || '0';
let filterScoreBuildingMin = getValue('filter_score_building_min') || '';
let filterScoreBuildingMax = getValue('filter_score_building_max') || '';
let filterScoreScienceEnabled = getValue('filter_score_science_enable') || '0';
let filterScoreScienceMin = getValue('filter_score_science_min') || '';
let filterScoreScienceMax = getValue('filter_score_science_max') || '';
let filterScoreFleetEnabled = getValue('filter_score_fleet_enable') || '0';
let filterScoreFleetMin = getValue('filter_score_fleet_min') || '';
let filterScoreFleetMax = getValue('filter_score_fleet_max') || '';
let filterScoreDefenseEnabled = getValue('filter_score_defense_enable') || '0';
let filterScoreDefenseMin = getValue('filter_score_defense_min') || '';
let filterScoreDefenseMax = getValue('filter_score_defense_max') || '';
let filterInactiveSinceEnabled = getValue('filter_inactive_since_enable') || '0';
let filterInactiveSinceMin = getValue('filter_inactive_since_min') || '';
let filterInactiveSinceMax = getValue('filter_inactive_since_max') || '';
let filterLastBattleReportEnabled = getValue('filter_last_battle_report_enable') || '0';
let filterLastBattleReportMin = getValue('filter_last_battle_report_min') || '';
let filterLastBattleReportMax = getValue('filter_last_battle_report_max') || '';
let filterLastSpyReportEnabled = getValue('filter_last_spy_report_enable') || '0';
let filterLastSpyReportMin = getValue('filter_last_spy_report_min') || '';
let filterLastSpyReportMax = getValue('filter_last_spy_report_max') || '';
let filterMetalEnabled = getValue('filter_metal_enable') || '0';
let filterMetalMin = getValue('filter_metal_min') || '';
let filterMetalMax = getValue('filter_metal_max') || '';
let filterCrystalEnabled = getValue('filter_crystal_enable') || '0';
let filterCrystalMin = getValue('filter_crystal_min') || '';
let filterCrystalMax = getValue('filter_crystal_max') || '';
let filterDeuteriumEnabled = getValue('filter_deuterium_enable') || '0';
let filterDeuteriumMin = getValue('filter_deuterium_min') || '';
let filterDeuteriumMax = getValue('filter_deuterium_max') || '';

$(window).on('hashchange', function () {
    parseUrl();
});

window.pageHub = new PageHub();
pageHub.init();

window.menu = new Menu();
menu.init();

hotkeys();

replaceFixColors();

let resources = new Resources();
resources.init();

$('head').append('<link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css" integrity="sha384-AYmEC3Yw5cVb3ZcuHtOA93w35dYTsvhLPVnYs9eStHfGJvOvKxVfELGroGkvsg+p" crossorigin="anonymous"/>');

parseUrl();

})();

/******/ })()
;